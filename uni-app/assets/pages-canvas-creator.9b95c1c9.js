import{a4 as t,H as e,a5 as o,a6 as a,a7 as i,d as r,C as s,o as n,c as l,w as c,a as d,e as h,b as g,n as u,a8 as b,a9 as f,i as p,g as m}from"./index-b795adff.js";import{T as x}from"./TheButton.ede9d954.js";import{a as w,b as v}from"./control.a6596622.js";import{_ as y}from"./_plugin-vue_export-helper.1b428a4d.js";function k(t,o){let a=e(t.left,"number")?t.left:0,i=e(t.top,"number")?t.top:0;return e(t.right,"number")&&(a=o.width-t.width-t.right),e(t.bottom,"number")&&(i=o.height-t.height-t.bottom),{left:a,top:i}}function C(t,o,a,i,r,s){const n=function(t,o,a){a=e(a,"number")?a:0;const i=Math.min(t,o)/2;return i<a?i:a}(i,r,s);t.beginPath(),t.moveTo(o+n,a),t.arcTo(o+i,a,o+i,a+r,n),t.arcTo(o+i,a+r,o,a+r,n),t.arcTo(o,a+r,o,a,n),t.arcTo(o,a,o+i,a,n),t.closePath()}function T(t,e,i){if(t.includes(";base64,"))return e(t);o({url:t,method:"GET",responseType:"arraybuffer",success(o){const i=a(o.data);var r;e((r=i,`data:image/${t.includes(".png")?"png":"jpeg"};base64,${r}`))},fail:i})}function z(e){const o=t(e.canvasId),a=e.list.sort(((t,e)=>(t.zIndex||0)-(e.zIndex||0)));let r=0;a.length>0?(o.draw(!1),r=0,function t(){const s=a[r];function n(){r===a.length-1?i({fileType:e.fileType||"png",canvasId:e.canvasId,quality:1,success:e.success,fail(t){e.fail&&e.fail({...t,type:"export"})}}):(r++,t())}switch(s.type){case"box":!function(t,a){const{left:i,top:r}=k(t,e);o.save(),C(o,i,r,t.width,t.height,t.borderRadius),o.setFillStyle(t.backgroundColor),o.setLineWidth(t.borderWidth||0),o.setStrokeStyle(t.borderColor||"rgba(0,0,0,0)"),o.stroke(),o.fill(),o.restore(),o.draw(!0,a)}(s,n);break;case"img":!function(t,a,i){T(t.src,(i=>{const{left:r,top:s}=k(t,e);o.save(),t.borderRadius&&(o.fill(),C(o,r,s,t.width,t.height,t.borderRadius),o.clip()),o.drawImage(i,r,s,t.width,t.height),o.restore(),o.draw(!0,a)}),i)}(s,n,(function(t){e.fail&&e.fail({...t,info:s,type:"load"})}));break;case"text":!function(t,a){const i=t.fontSize,r=t.fontSize*t.text.length,{left:s,top:n}=k({...t,width:r,height:i},e),l="right"===t.textAlign?s+r:s;o.save(),o.setFontSize(t.fontSize),o.setTextAlign(t.textAlign||"left"),o.setTextBaseline(t.textBaseline||"normal"),o.setFillStyle(t.color),o.fillText(t.text,l,n),o.fill(),o.restore(),o.draw(!0,a)}(s,n)}}()):console.warn("canvasCreater >> 没有可生成的列表数据")}const I=y(r({__name:"canvas-creator",setup(t){const e={width:300,height:500},o=s("");function a(){w("生成中..."),z({canvasId:"the-canvas",...e,list:[{type:"box",width:40,height:40,backgroundColor:"#07c160",borderRadius:1e3,borderColor:"orange",borderWidth:10,left:20,top:20,zIndex:10},{type:"box",width:40,height:40,backgroundColor:"#07c160",borderRadius:1e3,borderColor:"orange",borderWidth:10,right:20,top:20,zIndex:10},{type:"box",width:40,height:40,backgroundColor:"orange",borderRadius:1e3,borderColor:"#07c160",borderWidth:10,left:20,bottom:20,zIndex:10},{type:"box",width:40,height:40,backgroundColor:"orange",borderRadius:1e3,borderColor:"#07c160",borderWidth:10,right:20,bottom:20,zIndex:10},{type:"box",width:300,height:500,backgroundColor:"#eee",borderRadius:60},{type:"img",src:"https://game.gtimg.cn/images/lol/act/img/skinloading/106000.jpg",width:300,height:217},{type:"img",src:"https://game.gtimg.cn/images/lol/act/img/champion/Talon.png",width:60,height:60,borderRadius:10,bottom:50,left:50},{type:"img",src:"https://game.gtimg.cn/images/lol/act/img/champion/Zed.png",width:60,height:60,borderRadius:50,bottom:50,right:50},{type:"text",text:"向右对齐的文字",color:"green",textAlign:"right",fontSize:16,top:e.height/2,right:10,zIndex:20},{type:"text",text:"底部居中文字",fontSize:16,color:"orange",textAlign:"center",textBaseline:"middle",bottom:20,left:e.width/2}],success(t){b(),console.log("生成的图片信息 >>",t),o.value=t.tempFilePath,i.value=!0},fail(t){console.log("错误信息 >>",t),b(),v("load"===t.type?"图片加载失败":"canvas导出图片失败")}})}const i=s(!1);return(t,r)=>{const s=f,b=p,w=m;return n(),l(b,{class:"canvas-creater"},{default:c((()=>[d(s,{class:"banner-box",id:"the-canvas","canvas-id":"the-canvas",width:e.width,height:e.height},null,8,["width","height"]),d(b,{class:"line"}),d(x,{color:"#07c160",onClick:r[0]||(r[0]=t=>a())},{default:c((()=>[h("生成 canvas 海报图")])),_:1}),d(b,{class:u(["img-mask flex",{"img-mask-hide":!i.value}])},{default:c((()=>[d(b,{class:"img-content"},{default:c((()=>[d(w,{class:"img",src:o.value,style:g({width:e.width+"px",height:e.height+"px"})},null,8,["src","style"]),d(x,{round:!0,onClick:r[1]||(r[1]=t=>{i.value=!1})},{default:c((()=>[h("关闭（长摁图片保存）")])),_:1})])),_:1})])),_:1},8,["class"])])),_:1})}}}),[["__scopeId","data-v-a02b2a7c"]]);export{I as default};
