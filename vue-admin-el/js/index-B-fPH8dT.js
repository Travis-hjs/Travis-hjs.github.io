import{aa as ae,_ as J,g as Z,ab as A,p as N,ac as P,q as R,v as le,ad as ne}from"./index-C0DSbLpf.js";import{d as q,h as y,i,c as a,m as l,G as K,H as O,p as f,D as W,z as L,j as _,q as M,t as E,b as d,u as g,V as se,W as ie,r as j,x as Q,w as re,k as V,e as v,F as Y,aD as de,aE as pe,n as X}from"./element-plus-Cfes4v7f.js";const ue=p=>(se("data-v-c3bd346e"),p=p(),ie(),p),me={class:"drawer"},ce={class:"drawer-header f-vertical"},fe={key:0,class:"f1"},ye={key:1,class:"f1"},he=ue(()=>f("i",{class:"el-icon-close"},null,-1)),_e=[he],be={class:"content"},ve={key:0,class:"drawer-footer"},we={name:"Drawer"},ke=q({...we,props:{zIndex:{type:[Number,String],default:0},size:{type:String,default:"30%"},show:{type:Boolean,default:!1},title:{type:String,default:""},backgroundColor:{type:String,default:""}},emits:["update:show","close"],setup(p,{emit:w}){const m=w,$=ae();function k(){m("close"),m("update:show",!1)}return(h,c)=>{const C=d("el-scrollbar");return i(),y("section",me,[a(W,{name:"fade"},{default:l(()=>[K(f("div",{class:"wrap",style:L({zIndex:Number(p.zIndex)||g($)})},[f("div",{class:"f1",onClick:c[0]||(c[0]=I=>k())}),a(W,{name:"drawer-slide"},{default:l(()=>[K(f("div",{class:"drawer-slide-box",style:L({width:p.size})},[f("div",ce,[h.$slots.header?(i(),y("div",fe,[M(h.$slots,"header",{},void 0,!0)])):(i(),y("div",ye,E(p.title),1)),f("button",{class:"close-btn",onClick:c[1]||(c[1]=I=>k())},_e)]),a(C,{class:"drawer-body f1",style:L({"background-color":p.backgroundColor})},{default:l(()=>[f("div",be,[M(h.$slots,"default",{},void 0,!0)])]),_:3},8,["style"]),h.$slots.footer?(i(),y("div",ve,[M(h.$slots,"footer",{},void 0,!0)])):_("",!0)],4),[[O,p.show]])]),_:3})],4),[[O,p.show]])]),_:3})])}}}),ge=J(ke,[["__scopeId","data-v-c3bd346e"]]),$e={key:0,class:"fvc mr-[10px]"},xe={name:"Form"},Ce=q({...xe,props:{show:{type:Boolean,default:!1},type:{type:String},form:{type:Object,default:()=>({})}},emits:["update:show","submit"],setup(p,{emit:w}){const m=p,$=w;function k(){return{code:"",redirect:"",path:"",component:"",name:"",sort:1,meta:{title:"",link:"",icon:"",hidden:!1,keepAlive:!1,type:"menu",status:1,lang:""}}}const h={component:`<p>路径规则为："src/views/${A("${component}")}.vue"</p><p>${A("component")}就是要填写的路径</p>`,lang:`
  <p>参考 src/language/zh.ts 中的语言对象结构</p>
  <p>比如 ${A("login.account")}、${A("languageSetting")} 等</p>
  `},c={"meta.icon":{trigger:"blur",validator(o,e,n){!t.formData.parentId&&!e?n(new Error("首级菜单必需设置图标")):n()}},"meta.title":Z("请输入名称"),code:Z("请输入权限标识"),name:{trigger:"blur",validator(o,e,n){t.formData.meta.keepAlive&&!e?n(new Error("当设置路由缓存时，必需设置路由名称！")):n()}}},C=[{label:"菜单名称",prop:"meta.title",type:"input",placeholder:c["meta.title"].message},{label:"菜单权限标识",prop:"code",type:"input",placeholder:c.code.message},{label:"路由路径",prop:"path",type:"input",placeholder:"请确保路径唯一性，如不填，则在提交时自动设置"},{label:"视图组件路径",prop:"component",type:"input",placeholder:"当为目录时可以不用填",tooltip:h.component},{label:"重定向路径",prop:"redirect",type:"input",placeholder:"当为目录且不填时，则默认拿下级第一项作为该值"}],I=[{label:"菜单排序",prop:"sort",type:"number",placeholder:"请输入排序值",min:1},{label:"菜单隐藏",prop:"meta.hidden",type:"switch"},{label:"是否需要路由缓存",prop:"meta.keepAlive",type:"switch"},{label:"路由名称",prop:"name",type:"input",placeholder:"请确保名称唯一性，否则路由缓存匹配会异常"},{label:"设置为外链",prop:"meta.link",type:"input",placeholder:"设置外链时则覆盖路由路径"},{label:"多语言设置",prop:"meta.lang",type:"input",placeholder:"请输入语言配置表中的键值",tooltip:h.lang}],T=[{label:"权限标识",prop:"code",type:"input",placeholder:"请输入权限标识"},{label:"权限名称",prop:"meta.title",type:"input",placeholder:c["meta.title"].message},{label:"权限状态",prop:"meta.status",type:"select",options:[{label:"正常",value:1},{label:"停用",value:2}]}],t=j({show:!1,loading:!1,formData:k(),showIcon:!1});function s(){$("update:show",!1)}const r=Q();function b(){console.log("formData >>",R(t.formData,!0)),r.value.validate(o=>{if(le(".menu-form",o),!!o){if(t.formData.meta.type==="auth"&&!t.formData.parentId){de.error("功能权限必需选择上级菜单！");return}t.formData.parentId||(t.formData.component="Layout"),t.formData.path||(t.formData.path=`/auto-set-${Date.now()}`),$("submit",R(t.formData,!0)),s()}})}const D=new Array(10).fill(0).map((o,e)=>{const n=e+1;return{value:n,label:`菜单-${n}`,children:new Array(6).fill(0).map((z,B)=>{const U=n*20+B;return{value:U,label:`菜单-${U}`}})}});function S(){t.formData.meta.status=1}function x(){window.open("https://icones.netlify.app/collection/tdesign","_blank")}return re(()=>m.show,function(o){t.show=o,o&&(t.formData=m.type==="edit"?R(m.form,!0):k(),r.value&&setTimeout(()=>r.value.clearValidate()))},{immediate:!0}),(o,e)=>{const n=d("el-tree-select"),z=d("el-form-item"),B=d("el-radio-button"),U=d("el-radio-group"),G=d("el-text"),H=d("el-divider"),ee=d("el-input"),te=d("el-icon"),F=d("el-button"),oe=d("el-form");return i(),V(g(ge),{title:m.type==="edit"?"编辑菜单":"添加菜单",show:t.show,"onUpdate:show":e[7]||(e[7]=u=>t.show=u),size:"620px",onClose:e[8]||(e[8]=u=>s())},{footer:l(()=>[a(F,{onClick:e[5]||(e[5]=u=>s())},{default:l(()=>[v("取 消")]),_:1}),a(F,{onClick:e[6]||(e[6]=u=>b()),type:"primary"},{default:l(()=>[v("确 认")]),_:1})]),default:l(()=>[a(oe,{"label-position":"left","label-width":"128px",class:"menu-form",ref_key:"formRef",ref:r,model:t.formData,rules:c},{default:l(()=>[a(z,{label:"上级菜单",prop:"parentId"},{default:l(()=>[a(n,{modelValue:t.formData.parentId,"onUpdate:modelValue":e[0]||(e[0]=u=>t.formData.parentId=u),placeholder:"请选择上级菜单",data:g(D),"check-strictly":"","render-after-expand":!1,clearable:"",filterable:""},null,8,["modelValue","data"])]),_:1}),a(z,{label:"类型",prop:"meta.type"},{default:l(()=>[a(U,{modelValue:t.formData.meta.type,"onUpdate:modelValue":e[1]||(e[1]=u=>t.formData.meta.type=u),onChange:e[2]||(e[2]=u=>S())},{default:l(()=>[a(B,{label:"菜单",value:"menu"}),a(B,{label:"权限功能",value:"auth"})]),_:1},8,["modelValue"])]),_:1}),t.formData.meta.type==="menu"?(i(),y(Y,{key:0},[a(H,{"content-position":"left","border-style":"dashed"},{default:l(()=>[a(G,{type:"info"},{default:l(()=>[v("基础配置")]),_:1})]),_:1}),a(g(N),{data:t.formData,list:C},null,8,["data"]),a(z,{label:"菜单图标",prop:"meta.icon"},{default:l(()=>[a(ee,{class:"f1 mr-[10px]",modelValue:t.formData.meta.icon,"onUpdate:modelValue":e[3]||(e[3]=u=>t.formData.meta.icon=u),clearable:"",placeholder:"请选择或者输入图标"},null,8,["modelValue"]),t.formData.meta.icon?(i(),y("div",$e,[a(te,{size:20,style:{color:"var(--el-color-primary)"}},{default:l(()=>[a(g(P),{name:t.formData.meta.icon},null,8,["name"])]),_:1})])):_("",!0),a(F,{type:"primary",plain:"",onClick:e[4]||(e[4]=u=>x())},{default:l(()=>[v("选择图标")]),_:1})]),_:1}),a(H,{"content-position":"left","border-style":"dashed"},{default:l(()=>[a(G,{type:"info"},{default:l(()=>[v("辅助配置")]),_:1})]),_:1}),a(g(N),{data:t.formData,list:I},null,8,["data"])],64)):(i(),V(g(N),{key:1,data:t.formData,list:T},null,8,["data"]))]),_:1},8,["model"])]),_:1},8,["title","show"])}}}),De=J(Ce,[["__scopeId","data-v-7493fec0"]]),Ve={class:"page-menu"},Ie={class:"f-right"},Se=f("i",{class:"el-icon-plus el-icon--left"},null,-1),ze={class:"table-content"},Be={key:5,style:{width:"100%","text-align":"right"}},Ee=q({__name:"index",setup(p){const w=j({show:!1,showType:"add"});function m(s){w.show=!0,w.showType=s}let $=0;function k(s,r=1,b,D){return Array.from({length:s}).map((S,x)=>{$++;const o=Math.random()>.5,e=`row-${$}`,n={id:e,name:"",parentId:D,code:"权限标识",path:`/xxx/${r}/${x}`,component:D?`/xxx/${r}/${x}`:"Layout",sort:1,redirect:"",meta:{title:`${o?"菜单":"权限"}-${r}-${x}`,icon:o?"tdesign:app":"tdesign:combination",hidden:!1,keepAlive:!1,type:o?"menu":"auth",status:1}};return r<b&&(n.children=k(s,r+1,b,e)),n})}const h=Q(k(100,1,3));function c(s){console.log(s)}const C=[{title:"名称",width:320,key:"meta.title"},{title:"类型",width:100,key:"meta.type"},{title:"标识",width:140,key:"code"},{title:"菜单路径",width:140,key:"path"},{title:"排序",width:180,key:"sort"},{title:"启用",width:100,key:"meta.status"},{title:"隐藏",width:100,key:"meta.hidden"},{title:"操作",width:160,key:"option",fixed:pe.RIGHT,headerClass:"justify-center"}];C.forEach(s=>{s.dataKey=s.key});function I(s){m("add")}function T(s){m("edit")}const t=j({width:0,height:0});return ne({el:".table-content",callback(s){t.width=s.width,t.height=s.height}}),(s,r)=>{const b=d("el-button"),D=d("el-input-number"),S=d("el-switch"),x=d("el-table-v2");return i(),y("div",Ve,[f("div",Ie,[a(b,{type:"primary",onClick:r[0]||(r[0]=o=>m("add"))},{default:l(()=>[Se,v(" 新增菜单 ")]),_:1})]),f("section",ze,[a(x,{columns:C,data:h.value,width:t.width,height:t.height,"expand-column-key":"meta.title",fixed:"",border:""},{cell:l(({rowData:o,column:e})=>[e.key==="meta.title"?(i(),y(Y,{key:0},[o.meta.icon?(i(),V(g(P),{key:0,class:"el-icon--left",name:o.meta.icon},null,8,["name"])):_("",!0),f("span",null,E(o.meta.title),1)],64)):_("",!0),e.key==="meta.type"?(i(),y("span",{key:1,class:X(["the-tag",o.meta.type==="menu"?"blue":"green"])},E(o.meta.type==="menu"?"菜单":"权限"),3)):_("",!0),e.key==="sort"?(i(),V(D,{key:2,modelValue:o.sort,"onUpdate:modelValue":n=>o.sort=n,min:1,onBlur:n=>c(o)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):_("",!0),e.key==="meta.status"?(i(),V(S,{key:3,modelValue:o.meta.status,"onUpdate:modelValue":n=>o.meta.status=n,"active-value":1,"inactive-value":2,"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue","onUpdate:modelValue"])):_("",!0),e.key==="meta.hidden"?(i(),y("span",{key:4,class:X(["the-tag",o.meta.hidden?"red":"purple"])},E(o.meta.hidden?"是":"否"),3)):_("",!0),e.key==="option"?(i(),y("div",Be,[o.meta.type==="menu"?(i(),V(b,{key:0,link:"",type:"primary",onClick:n=>I(o)},{default:l(()=>[v("新增")]),_:2},1032,["onClick"])):_("",!0),a(b,{link:"",type:"success",onClick:n=>T(o)},{default:l(()=>[v("编辑")]),_:2},1032,["onClick"]),a(b,{link:"",type:"danger"},{default:l(()=>[v("删除")]),_:1})])):_("",!0)]),_:1},8,["data","width","height"])]),a(De,{show:w.show,"onUpdate:show":r[1]||(r[1]=o=>w.show=o)},null,8,["show"])])}}});export{Ee as default};
