import{k as S,n as U,l as z,f as V}from"./index-DaG8q1li.js";import{H as K,a as R,I as G,c as d,b as y,F as L,d as j,h as C,B as Y,aA as Q,e as h,f as F,z as X,k as f,ax as Z,g as $,u as T,p as g,n as ee,C as N,t as P,q as te,A as ae,i as A,P as ne,a1 as oe}from"./element-plus-CDxRwxN6.js";import{F as le}from"./index-CXQMX0x5.js";const se="the-curd-state",xe=()=>G(se),re="action-right",De="action-edit",fe={input:"输入框",textarea:"文本域","input-between":"输入框-串联",select:"下拉框-单选","select-multiple":"下拉框-多选",checkbox:"多选复选框",radio:"单选选择框",switch:"开关切换",date:"日期选择器",cascader:"级联选择器"};let O=0;function B(){return O++,O}function Ye(e){if(e.type=="date"){const t=e.shortcutIndex,o="the-date-shortcut-selected",r=document.querySelector(`.${o}`);if(r&&r.classList.remove(o),S(t,"number"))if(t===-1)e.value=e.shortcutDate;else{const v=ue[e.dateType][t].value();e.value=v;const s=`.${e.id} .el-picker-panel__sidebar`,l=document.querySelector(s);l&&K(()=>l.children[t].classList.add(o))}else e.value=["daterange","datetimerange"].includes(e.dateType)?[]:""}else["object","array"].includes(U(e.defaultValue))?e.value=z(e.defaultValue):e.value=e.defaultValue}function ke(e,t="",o){const r=B(),v=Date.now(),s="请输入",l="请选择",i=`field-${e}-${r}-${v}`,b={input:{key:t,id:i,type:"input",value:"",defaultValue:"",placeholder:s,valueType:"string"},textarea:{id:i,value:"",defaultValue:"",type:"textarea",placeholder:s,key:t,valueType:"string"},"input-between":{key:t,id:i,value:["",""],defaultValue:["",""],type:"input-between",placeholder:["请输入范围一","请输入范围二"],separator:"-",valueType:"array"},select:{key:t,id:i,value:"",defaultValue:"",type:"select",placeholder:l,options:[],optionSetting:{label:"",value:""},valueType:"string",joinShow:!1},"select-multiple":{key:t,id:i,value:[],defaultValue:[],type:"select-multiple",placeholder:l,options:[],optionSetting:{label:"",value:""},valueType:"array",joinShow:!1},checkbox:{key:t,id:i,value:[],defaultValue:[],type:"checkbox",placeholder:l,options:[],optionSetting:{label:"",value:""},valueType:"array"},radio:{key:t,id:i,value:"",defaultValue:"",type:"radio",placeholder:l,options:[],optionSetting:{label:"",value:""},valueType:"string"},switch:{key:t,id:i,value:!1,defaultValue:!1,type:"switch",placeholder:"",valueType:"boolean"},date:{key:t,id:i,value:"",type:"date",placeholder:l,dateType:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D",valueType:"string",shortcutIndex:""},cascader:{key:t,id:i,value:[],defaultValue:[],type:"cascader",placeholder:l,options:[],optionSetting:{label:"",value:"",children:""},multiple:!1,checkStrictly:!1,valueType:"array"}}[e];return b.label="",b.required=!1,b}function Se(e,t){return{title:t,prop:e,width:void 0,minWidth:void 0,tooltip:e!==re,cellType:"text",sort:!1,fixed:!1,iconTips:"",imageWidth:void 0,imageHeight:void 0,jsCode:"",visible:!0}}function Te(){return{width:500,labelWidth:120,labelPosition:"left",fields:[]}}function _e(){return{key:`action-${B()}-${Date.now()}`,text:"",icon:"",click:"",type:"primary"}}function Ve(e){const t={value:e.value,result:!0};if(e.type==="date"){if(!t.value)return t.result=e.placeholder,t;if(["datetimerange","daterange"].includes(e.dateType)){const s=e.value;return s.length<2?(t.result=e.placeholder,t):(t.value=s.map(l=>V(l,e.format)),t)}return t.value=V(e.value,e.format),t}const o=[null,void 0,""];if(e.type==="input-between"){const s=e.value;if(o.includes(s[0]))return t.result=e.placeholder[0],t;if(o.includes(s[1]))return t.result=e.placeholder[1],t;t.value=JSON.parse(JSON.stringify(s))}if(["input","textarea","radio","select"].includes(e.type)&&o.includes(e.value))return t.result=e.placeholder,t;if(["checkbox","select-multiple"].includes(e.type)){const s=e.value;if(!s.length)return t.result=e.placeholder,t;t.value=JSON.parse(JSON.stringify(s))}return t}function Ce(e){if(e)return e=parseInt(e.toString()),e=Math.abs(e),`${e}px`}const Me=[{label:"选择年份",value:"year",formatShow:"YYYY",format:"Y"},{label:"选择年份-月份",value:"month",formatShow:"YYYY-MM",format:"Y-M"},{label:"选择年份-周",value:"week",formatShow:"YYYY年 第ww周",format:"Y-M-D"},{label:"选择年份-月份-日",value:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择年份-月份-日 时:分:秒",value:"datetime",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"},{label:"选择日期范围",value:"daterange",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择日期-时间范围",value:"datetimerange",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"}],E=3600*1e3*24;function D(e=0){const t=new Date;return t.setMonth(new Date().getMonth()-e),t}function _(e=0){const t=new Date,o=E*7*e;return t.setTime(t.getTime()-o),t}const I=[{text:"今天",value:()=>new Date},{text:"昨天",value(){const e=new Date;return e.setTime(e.getTime()-E),e}},{text:"一周前",value:()=>_(1)},{text:"一个月前",value:()=>D(1)},{text:"三个月前",value:()=>D(3)},{text:"半年前",value:()=>D(6)},{text:"一年前",value:()=>D(12)}],q=I.map((e,t)=>{const o=t===0,r=new Date().toLocaleDateString(),v=[new Date(`${r} 00:00:00`),new Date(`${r} 23:59:59`)];return{text:o?"今天内":`${e.text}至今`,value:()=>o?v:[e.value(),new Date]}}),ue={year:[{text:"今年",value:()=>new Date},{text:"去年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-1))},{text:"前年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-2))}],month:[{text:"当月",value:()=>new Date},{text:"上月",value:()=>D(1)},{text:"前3个月",value:()=>D(3)},{text:"前6个月",value:()=>D(6)},{text:"前12个月",value:()=>D(12)}],week:[{text:"本周",value:()=>new Date},{text:"上周",value:()=>_(1)},{text:"上2周",value:()=>_(2)},{text:"上3周",value:()=>_(3)},{text:"上4周",value:()=>_(4)}],date:I,datetime:I,daterange:q,datetimerange:q};function Fe(e){const t=window;for(const o in e){const r=`_${o}`;t[r]=e[o]}R(function(){for(const o in e){const r=`_${o}`;t[r]=null}})}function $e(e){return`<b style="color: var(--yellow)"> ${e} </b>`}function ce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Q(e)}function ie(e){return d(L,null,[e.label,d(y("el-tooltip"),{effect:"dark",content:e.tips,"raw-content":!0,placement:"top-start"},{default:()=>[d(y("el-button"),{type:"info",link:!0,style:"height: 32px;"},{default:()=>[d("i",{class:"el-icon-question"},null)]})]})])}const pe=j({props:{attrs:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const o=C({get(){const r=e.attrs.modelValue;return S(r,"array")?r.map(v=>new Date(v)):r&&new Date(r)},set(r){t("change",r)}});return()=>d(y("el-date-picker"),Y({"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},e.attrs,{modelValue:o.value,"onUpdate:modelValue":r=>o.value=r}),null)}}),me=j({props:{attrs:{type:Object,required:!0},field:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const o=C({get(){return e.attrs.modelValue},set(s){t("change",s)}}),r=C(()=>{const s=e.field.optionSetting||{};return{value:s.value||"value",label:s.label||"label"}});function v(s){const l=r.value;return`${s[l.label]||s[l.value]}`}return()=>{let s;return e.field.options.length>36?d(y("el-select-v2"),Y(e.attrs,{options:e.field.options,props:r.value,modelValue:o.value,"onUpdate:modelValue":l=>o.value=l}),{default:({item:l})=>d("span",{title:v(l)},[v(l)])}):d(y("el-select"),Y(e.attrs,{modelValue:o.value,"onUpdate:modelValue":l=>o.value=l}),ce(s=e.field.options.map(l=>d(y("el-option"),{key:l[r.value.value],label:v(l),value:l[r.value.value]},null)))?s:{default:()=>[s]})}}}),ve={key:8,class:"tips-box"},de={class:"the-tag blue"},he=A("i",{class:"el-icon--left el-icon-info"},null,-1),ye={name:"TheFields"},Ie=j({...ye,props:{type:{type:String,default:"form"},data:{type:Object,required:!0},list:{type:Array,required:!0}},emits:["change"],setup(e,{emit:t}){const o=e,r=t,v=C(()=>o.list.filter(n=>S(n.show,"boolean")?n.show:S(n.show,"function")?n.show():!0));function s(n,u){const c=n.prop,p=o.data;if(c.includes(".")){const k=[null,void 0],w=c.split(".");let a=p;for(const x of w){if(k.includes(a[x]))return;a=a[x]}return a}return p[n.prop]}function l(n,u,c){const p=c||n.prop,k=o.data;if(p.includes(".")){const w=p.split(".");let a=k;for(let x=0;x<w.length-1;x++){const m=w[x];a[m]||(a[m]={}),a=a[m]}a[w[w.length-1]]=u}else k[p]=u}function i(n,u){const c=n.prop,p=u;n.type!=="date"&&l(n,p),n.onChange&&n.onChange(p),r("change",c,p)}function M(n){return n.class||(o.type==="form"?"w-full":"short-value")}function b(n){const u=S(n.disabled,"function")?n.disabled():n.disabled;return{placeholder:n.placeholder,disabled:u,class:M(n),clearable:n.type==="textarea"?void 0:!n.noClear,modelValue:s(n)}}function H(n){const u=n.type==="select-multiple",c=S(n.disabled,"function")?n.disabled():n.disabled,p=n.type==="select-multiple"?n.showAll:!1;return{placeholder:n.placeholder,disabled:c,multiple:u,clearable:!n.noClear,filterable:!0,collapseTags:!p,class:M(n),modelValue:s(n)}}function W(n){const u=["",null,void 0],c=o.data[n.prop];return(u.includes(c)?n.placeholder:c)||"-"}function J(n,u){const c=n.bind;l(n,u),["daterange","datetimerange"].includes(n.dateType)?u?(l(n,V(u[0],n.format),c[0]),l(n,V(u[1],n.format),c[1])):(l(n,void 0,c[0]),l(n,void 0,c[1])):l(n,u?V(u,n.format):void 0,c[0]),i(n,u)}return(n,u)=>{const c=y("el-input"),p=y("el-input-number"),k=y("el-switch"),w=y("el-text");return h(!0),F(L,null,X(v.value,(a,x)=>(h(),f(ne(o.type==="form"?T(oe):T(le)),{key:a.key||`${a.prop}-${x}`,label:a.label,prop:a.prop,class:"the-fields-item"},Z({default:$(()=>[a.type==="input"?(h(),f(c,Y({key:0},b(a),{onInput:m=>i(a,m)}),null,16,["onInput"])):g("",!0),a.type==="textarea"?(h(),f(c,Y({key:1},b(a),{rows:a.rows,"show-word-limit":"",type:"textarea",onInput:m=>i(a,m)}),null,16,["rows","onInput"])):g("",!0),a.type==="number"?(h(),f(p,Y({key:2},b(a),{min:a.min,max:a.max,"controls-position":"right",onInput:m=>i(a,m)}),null,16,["min","max","onInput"])):g("",!0),a.type==="select"||a.type==="select-multiple"?(h(),f(T(me),{key:3,attrs:H(a),field:a,onChange:m=>i(a,m)},null,8,["attrs","field","onChange"])):g("",!0),a.type==="date"?(h(),f(T(pe),{key:4,attrs:{type:a.dateType,format:a.formatShow,...b(a)},onChange:m=>J(a,m)},null,8,["attrs","onChange"])):g("",!0),a.type==="switch"?(h(),f(k,{key:5,"model-value":s(a),"inline-prompt":"","active-text":a.activeText||"是","inactive-text":a.inactiveText||"否","active-value":a.activeValue,"inactive-value":a.inactiveValue,onChange:m=>i(a,m)},null,8,["model-value","active-text","inactive-text","active-value","inactive-value","onChange"])):g("",!0),a.type==="text"?(h(),F("div",{key:6,class:ee(["text-box",a.class||"w-full"])},[d(w,null,{default:$(()=>[N(P(W(a)),1)]),_:2},1024)],2)):g("",!0),a.type==="slot"&&a.slotName?te(n.$slots,a.slotName,ae(Y({key:7},a))):g("",!0),a.tips?(h(),F("div",ve,[A("span",de,[he,N(" "+P(a.tips),1)])])):g("",!0)]),_:2},[a.tooltip?{name:"label",fn:$(()=>[d(T(ie),{label:a.label,tips:a.tooltip},null,8,["label","tips"])]),key:"0"}:void 0]),1032,["label","prop"]))),128)}}});export{Ie as _,Se as a,De as b,re as c,Ce as d,Te as e,fe as f,ke as g,Ve as h,Ye as i,$e as j,_e as k,Me as l,Fe as m,se as p,ue as s,xe as u};
