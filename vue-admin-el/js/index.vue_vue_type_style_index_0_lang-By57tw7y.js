import{H as ot,I as at,a as nt,d as ne,h as X,o as Re,b as h,e as u,f as T,k as C,B as we,m as O,F as J,c as e,g as o,C as L,t as le,z as te,u as g,q as Se,aw as Te,n as de,i as V,N as Ve,j as ge,r as oe,w as he,T as it,K as rt}from"./element-plus-CrjfmyRg.js";import{b as st,F as Ae,a as ut}from"./index-Swj4FZD7.js";import{g as Q,h as Ee,k as ce,f as Ue,i as Ye,b as ye,l as De,n as dt,a as pe,u as ct,c as Je,p as pt}from"./index-D3nNLFcE.js";import{v as ft,s as mt}from"./dom-vtHEqTVj.js";import{r as yt}from"./common-CNe_2omy.js";const ze="the-curd-state",Ne=()=>ot(ze),be="action-right",fe="action-edit",ue={input:"输入框",textarea:"文本域","input-between":"输入框-串联",select:"下拉框-单选","select-multiple":"下拉框-多选",checkbox:"多选复选框",radio:"单选选择框",switch:"开关切换",date:"日期选择器",cascader:"级联选择器"};let je=0;function Ke(){return je++,je}function Be(r){if(r.type=="date"){const n=r.shortcutIndex,t="the-date-shortcut-selected",k=document.querySelector(`.${t}`);if(k&&k.classList.remove(t),Q(n,"number")&&n>=0){const p=Fe[r.dateType][n].value();r.value=p;const v=`.${r.id} .el-picker-panel__sidebar`,f=document.querySelector(v);f&&at(()=>f.children[n].classList.add(t))}!Q(r.value,"array")&&r.valueType==="array"&&(r.value=[])}else["object","array"].includes(Ee(r.defaultValue))?r.value=ce(r.defaultValue):r.value=r.defaultValue}function re(r,n="",t){const k=Ke(),p=Date.now(),v="请输入",f="请选择",m=`field-${r}-${k}-${p}`,q={input:{key:n,id:m,type:"input",value:"",defaultValue:"",placeholder:v,valueType:"string"},textarea:{id:m,value:"",defaultValue:"",type:"textarea",placeholder:v,key:n,valueType:"string"},"input-between":{key:n,id:m,value:["",""],defaultValue:["",""],type:"input-between",placeholder:["请输入范围一","请输入范围二"],separator:"-",valueType:"array"},select:{key:n,id:m,value:"",defaultValue:"",type:"select",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"string"},"select-multiple":{key:n,id:m,value:[],defaultValue:[],type:"select-multiple",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"array"},checkbox:{key:n,id:m,value:[],defaultValue:[],type:"checkbox",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"array"},radio:{key:n,id:m,value:"",defaultValue:"",type:"radio",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"string"},switch:{key:n,id:m,value:!1,defaultValue:!1,type:"switch",placeholder:"",valueType:"boolean"},date:{key:n,id:m,value:"",type:"date",placeholder:f,dateType:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D",valueType:"string",shortcutIndex:""},cascader:{key:n,id:m,value:[],defaultValue:[],type:"cascader",placeholder:f,options:[],optionSetting:{label:"",value:"",children:""},multiple:!1,checkStrictly:!1,valueType:"array"}}[r];return q.label="",q.required=!1,q}function Me(r,n){return{label:n,prop:r,width:void 0,minWidth:void 0,tooltip:!1,cellType:"text",sort:!1,fixed:!1,iconTips:"",imageWidth:void 0,imageHeight:void 0,jsCode:"",visible:!0}}function Ie(){return{width:500,labelWidth:120,labelPosition:"left",fields:[]}}function Ce(){return{key:`action-${Ke()}-${Date.now()}`,text:"",icon:"",click:"",type:"primary"}}function Ge(r){const n={value:r.value,result:!0};if(r.type==="date"){if(!n.value)return n.result=r.placeholder,n;if(["datetimerange","daterange"].includes(r.dateType)){const v=r.value;return v.length<2?(n.result=r.placeholder,n):(n.value=v.map(f=>Ue(f,r.format)),n)}return n.value=Ue(r.value,r.format),n}const t=[null,void 0,""];if(r.type==="input-between"){const v=r.value;if(t.includes(v[0]))return n.result=r.placeholder[0],n;if(t.includes(v[1]))return n.result=r.placeholder[1],n;n.value=JSON.parse(JSON.stringify(v))}if(["input","textarea","radio","select"].includes(r.type)&&t.includes(r.value))return n.result=r.placeholder,n;if(["checkbox","select-multiple"].includes(r.type)){const v=r.value;if(!v.length)return n.result=r.placeholder,n;n.value=JSON.parse(JSON.stringify(v))}return n}function _e(r){if(r)return r=parseInt(r.toString()),r=Math.abs(r),`${r}px`}const Pe=[{label:"选择年份",value:"year",formatShow:"YYYY",format:"Y"},{label:"选择年份-月份",value:"month",formatShow:"YYYY-MM",format:"Y-M"},{label:"选择年份-周",value:"week",formatShow:"YYYY年 第ww周",format:"Y-M-D"},{label:"选择年份-月份-日",value:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择年份-月份-日 时:分:秒",value:"datetime",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"},{label:"选择日期范围",value:"daterange",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择日期-时间范围",value:"datetimerange",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"}],Ze=3600*1e3*24;function me(r=0){const n=new Date;return n.setMonth(new Date().getMonth()-r),n}function ke(r=0){const n=new Date,t=Ze*7*r;return n.setTime(n.getTime()-t),n}const Oe=[{text:"今天",value:()=>new Date},{text:"昨天",value(){const r=new Date;return r.setTime(r.getTime()-Ze),r}},{text:"一周前",value:()=>ke(1)},{text:"一个月前",value:()=>me(1)},{text:"三个月前",value:()=>me(3)},{text:"半年前",value:()=>me(6)},{text:"一年前",value:()=>me(12)}],He=Oe.map((r,n)=>{const t=n===0,k=new Date().toLocaleDateString(),p=[new Date(`${k} 00:00:00`),new Date(`${k} 23:59:59`)];return{text:t?"今天内":`${r.text}至今`,value:()=>t?p:[r.value(),new Date]}}),Fe={year:[{text:"今年",value:()=>new Date},{text:"去年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-1))},{text:"前年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-2))}],month:[{text:"当月",value:()=>new Date},{text:"上月",value:()=>me(1)},{text:"前3个月",value:()=>me(3)},{text:"前6个月",value:()=>me(6)},{text:"前12个月",value:()=>me(12)}],week:[{text:"本周",value:()=>new Date},{text:"上周",value:()=>ke(1)},{text:"上2周",value:()=>ke(2)},{text:"上3周",value:()=>ke(3)},{text:"上4周",value:()=>ke(4)}],date:Oe,datetime:Oe,daterange:He,datetimerange:He};function vt(r){const n=window;for(const t in r){const k=`_${t}`;n[k]=r[t]}nt(function(){for(const t in r){const k=`_${t}`;n[k]=null}})}function ee(r){return`<b style="color: var(--yellow)"> ${r} </b>`}const ht={name:"Field"},xe=ne({...ht,props:{fieldData:{type:Object,required:!0},editMode:Boolean,readonly:Boolean,disabled:Boolean},setup(r){const n=r;Be(n.fieldData);const t=X(()=>n.fieldData),k=X(()=>{const b=n.fieldData.optionSetting||{};return{value:b.value||"value",label:b.label||"label"}}),p=X(()=>{const b=n.fieldData;return{multiple:b.multiple,checkStrictly:b.checkStrictly,value:b.optionSetting.value||"value",label:b.optionSetting.label||"label",children:b.optionSetting.children||"children"}});function v(b){const l=t.value.placeholder;return{disabled:n.disabled,readonly:n.readonly,clearable:!0,placeholder:Q(b,"number")?l[b]:l}}function f(b){const l=n.fieldData;l.valueType==="number"?l.value=Ye(b,!0,!0):l.value=b}function m(b,l){const P=n.fieldData;P.valueType==="array<number>"?P.value[l]=Ye(b,!0,!0):P.value[l]=b}const W=["-",".","",null,void 0];function q(){const b=n.fieldData;b.valueType==="number"&&(W.includes(b.value)?b.value="":b.value=Number(b.value))}function S(b){const l=n.fieldData;if(l.valueType==="array<number>"){const P=l.value[b];W.includes(P)?l.value[b]="":l.value[b]=Number(P)}}function I(b){return{placeholder:b.placeholder,disabled:n.disabled,multiple:b.type==="select-multiple",clearable:!0,filterable:!0,collapseTags:!0,class:"field-item"}}let K=[];const A="the-date-shortcut-selected";function y(){const b=document.querySelector(`.${A}`);b&&b.classList.remove(A)}function F(b){b.classList.add(A)}return Re(function(){const b=n.fieldData;if(b.type==="date"){const l=`.${b.id} .el-picker-panel__sidebar`,P=document.querySelector(l);if(!P)return console.warn("找不到日期快捷面板节点！");K=Array.from(P.children),K.forEach(G=>{G.addEventListener("click",()=>F(G))});const H=b.shortcutIndex;Q(H,"number")&&H>=0&&F(K[H])}}),(b,l)=>{const P=h("el-input"),H=h("el-text"),G=h("el-select-v2"),R=h("el-option"),ae=h("el-select"),E=h("el-checkbox"),Z=h("el-checkbox-group"),j=h("el-radio"),$=h("el-radio-group"),i=h("el-switch"),_=h("el-cascader"),M=h("el-date-picker");return u(),T("div",{class:"the-curd-form-field f-vertical short-value",style:Se({width:g(_e)(t.value.valueWidth)})},[t.value.type==="input"?(u(),C(P,we({key:0,"model-value":t.value.value},v(),{class:"the-curd-field",onInput:f,onBlur:q}),null,16,["model-value"])):O("",!0),t.value.type==="textarea"?(u(),C(P,{key:1,modelValue:t.value.value,"onUpdate:modelValue":l[0]||(l[0]=s=>t.value.value=s),readonly:n.readonly,disabled:n.disabled,autosize:{minRows:2,maxRows:10},placeholder:t.value.placeholder,type:"textarea",class:"the-curd-field"},null,8,["modelValue","readonly","disabled","placeholder"])):O("",!0),t.value.type==="input-between"?(u(),T(J,{key:2},[e(P,we({"model-value":t.value.value[0]},v(0),{class:"f1",onInput:l[1]||(l[1]=s=>m(s,0)),onBlur:l[2]||(l[2]=s=>S(0))}),null,16,["model-value"]),e(H,{style:{padding:"0 6px"}},{default:o(()=>[L(le(t.value.separator),1)]),_:1}),e(P,we({"model-value":t.value.value[1]},v(1),{class:"f1",onInput:l[3]||(l[3]=s=>m(s,1)),onBlur:l[4]||(l[4]=s=>S(1))}),null,16,["model-value"])],64)):O("",!0),t.value.type==="select"||t.value.type==="select-multiple"?(u(),T(J,{key:3},[t.value.options.length>50?(u(),C(G,we({key:0,modelValue:t.value.value,"onUpdate:modelValue":l[5]||(l[5]=s=>t.value.value=s),options:t.value.options,props:t.value.optionSetting},I(t.value)),null,16,["modelValue","options","props"])):(u(),C(ae,we({key:1,modelValue:t.value.value,"onUpdate:modelValue":l[6]||(l[6]=s=>t.value.value=s)},I(t.value)),{default:o(()=>[(u(!0),T(J,null,te(t.value.options,s=>(u(),C(R,{key:s[k.value.value],value:s[k.value.value],label:s[k.value.label]},null,8,["value","label"]))),128))]),_:1},16,["modelValue"]))],64)):O("",!0),t.value.type==="checkbox"?(u(),T(J,{key:4},[e(Z,{modelValue:t.value.value,"onUpdate:modelValue":l[7]||(l[7]=s=>t.value.value=s),disabled:n.disabled},{default:o(()=>[(u(!0),T(J,null,te(t.value.options,s=>(u(),C(E,{key:s[k.value.value],value:s[k.value.value]},{default:o(()=>[L(le(s[k.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),n.editMode&&!t.value.options.length?(u(),C(H,{key:0,type:"primary"},{default:o(()=>[L(le(g(ue).checkbox)+"（空数据） ",1)]),_:1})):O("",!0)],64)):O("",!0),t.value.type==="radio"?(u(),T(J,{key:5},[e($,{modelValue:t.value.value,"onUpdate:modelValue":l[8]||(l[8]=s=>t.value.value=s),disabled:n.disabled},{default:o(()=>[(u(!0),T(J,null,te(t.value.options,s=>(u(),C(j,{key:s[k.value.value],value:s[k.value.value]},{default:o(()=>[L(le(s[k.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),n.editMode&&!t.value.options.length?(u(),C(H,{key:0,type:"primary"},{default:o(()=>[L(le(g(ue).radio)+"（空数据） ",1)]),_:1})):O("",!0)],64)):O("",!0),t.value.type==="switch"?(u(),C(i,{key:6,modelValue:t.value.value,"onUpdate:modelValue":l[9]||(l[9]=s=>t.value.value=s),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])):O("",!0),t.value.type==="cascader"?(u(),C(_,{key:7,modelValue:t.value.value,"onUpdate:modelValue":l[10]||(l[10]=s=>t.value.value=s),options:t.value.options,props:p.value,placeholder:t.value.placeholder,disabled:n.disabled,clearable:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",class:"the-curd-field"},null,8,["modelValue","options","props","placeholder","disabled"])):O("",!0),t.value.type==="date"?(u(),C(M,{key:8,modelValue:t.value.value,"onUpdate:modelValue":l[11]||(l[11]=s=>t.value.value=s),placeholder:t.value.placeholder,type:t.value.dateType,format:t.value.formatShow,shortcuts:g(Fe)[t.value.dateType],disabled:n.disabled,"popper-class":t.value.id.toString(),"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"the-curd-field",onChange:y},null,8,["modelValue","placeholder","type","format","shortcuts","disabled","popper-class"])):O("",!0)],4)}}}),bt={key:0,class:"el-icon-rank el-icon--left"},gt={style:{"line-height":"1"}},_t={key:0,class:"the-curd-edit-mask f-vertical f-right"},wt=V("i",{class:"el-icon-delete el-icon--left"},null,-1),kt=V("i",{class:"el-icon-edit el-icon--left"},null,-1),xt=V("i",{class:"el-icon-plus"},null,-1),Vt={name:"Search"},Dt=ne({...Vt,props:{data:{type:Object,required:!0}},emits:["search"],setup(r,{emit:n}){const t=r,k=n,p=Ne(),v=X(()=>p.editor.type==="search"&&!p.editor.show);function f(A){const y=t.data.list[A].label||t.data.list[A].key;ye({title:"操作提示",content:`是否删除【${y}】？`,cancelText:"取消",confirm(){t.data.list.splice(A,1)}})}function m(A){p.editor.index=A,p.editor.action="edit",p.editor.show=!0}function W(A){return p.editor.index===A&&p.editor.type==="search"&&p.editor.show}function q(){p.editor.index=-1,p.editor.action="add",p.editor.show=!0}const{onDragStart:S,onDragMove:I,onDropEnd:K}=De({list:()=>t.data.list,key:"id",findLevel:5});return(A,y)=>{const F=h("el-button"),b=h("el-text");return u(),C(g(ut),{class:"the-curd-search","label-right":t.data.labelRight,"label-width":g(_e)(t.data.labelWidth)||"auto"},Te({content:o(()=>[e(Ve,{name:"the-group",tag:"div",class:"the-filter-content f1"},{default:o(()=>[(u(!0),T(J,null,te(t.data.list,(l,P)=>(u(),C(g(Ae),{key:l.id,"data-key":l.id,class:de([{"the-curd-selected":W(P)},l.id]),label:l.label,"label-width":g(_e)(l.labelWidth),required:l.required,draggable:v.value,onDragstart:H=>g(S)(P),onDragover:H=>g(I)(H,P),onDrop:y[0]||(y[0]=H=>g(K)())},Te({default:o(()=>[e(xe,{"field-data":l,disabled:g(p).loading},null,8,["field-data","disabled"]),v.value?(u(),T("div",_t,[e(F,{link:"",type:"danger",onClick:H=>f(P)},{default:o(()=>[wt,L(" 删除 ")]),_:2},1032,["onClick"]),e(F,{link:"",type:"success",onClick:H=>m(P)},{default:o(()=>[kt,L(" 编辑 ")]),_:2},1032,["onClick"])])):O("",!0)]),_:2},[g(p).editor.type==="search"?{name:"label",fn:o(()=>[v.value?(u(),T("i",bt)):O("",!0),V("span",gt,le(l.label),1)]),key:"0"}:void 0]),1032,["data-key","class","label","label-width","required","draggable","onDragstart","onDragover"]))),128)),v.value?(u(),C(g(Ae),{key:0},{default:o(()=>[t.data.list.length?O("",!0):(u(),C(b,{key:0,type:"info",style:{"margin-right":"12px"}},{default:o(()=>[L(" 请添加筛选条件~ ")]),_:1})),e(F,{type:"primary",circle:"",onClick:y[1]||(y[1]=l=>q())},{default:o(()=>[xt]),_:1})]),_:1})):O("",!0)]),_:1})]),_:2},[g(p).editor.type?void 0:{name:"right",fn:o(()=>[e(g(st),{loading:g(p).loading,onSearch:y[2]||(y[2]=l=>k("search",l))},null,8,["loading"])]),key:"0"}]),1032,["label-right","label-width"])}}});function Xe(r){const n=r.onAction||(()=>{});return e(J,null,[e(h("el-button"),{link:!0,onClick:()=>n("exit")},{default:()=>[L("退出编辑")]}),e(h("el-button"),{type:"success",plain:!0,onClick:()=>n("copy")},{default:()=>[e("i",{class:"el-icon-document-copy el-icon--left"},null),L("复制JSON")]}),e(h("el-button"),{type:"primary",onClick:()=>n("complete")},{default:()=>[L("完成编辑")]})])}function $e(r){const n=r.onClose||(()=>{}),t=r.onSubmit||(()=>{});return e(J,null,[e(h("el-button"),{onClick:n},{default:()=>[L("取 消")]}),e(h("el-button"),{type:"primary",loading:r.loading,disabled:r.disabledSubmit,onClick:t},{default:()=>[L("确 认")]})])}function $t(r){const n={};return r.imageWidth&&(n.width=`${r.imageWidth}px`),r.imageHeight&&(n.height=`${r.imageHeight}px`),n}function Qe(r){function n(){dt({urls:r.previewList?r.previewList:[r.src]})}return r.column.cellType==="image"?e(h("el-image"),{class:"the-table-image",style:$t(r.column),src:r.src,onClick:n,fit:"cover"},null):null}function ve(r){return e(J,null,[r.label,e(h("el-tooltip"),{effect:"dark",content:r.tips,"raw-content":!0,placement:"top-start"},{default:()=>[e(h("el-button"),{type:"info",link:!0,style:"height: 32px;"},{default:()=>[e("i",{class:"el-icon-question"},null)]})]})])}function et(r){const n=r.onAction||(()=>{}),t=r.config,k=!!t.selectKey,p=t.formAdd&&t.formAdd.fields.length>0,v=t.formEdit&&t.formEdit.fields.length>0,f={on:"el-icon-success",off:"el-icon-remove-outline"},m=[{type:"delete",text:k?"修改删除":"配置删除",icon:k?f.on:f.off,style:k?"primary":"info"},{type:"add",text:p?"修改新增表单":"配置新增表单",icon:p?f.on:f.off,style:p?"primary":"info"},{type:"edit",text:v?"修改编辑表单":"配置编辑表单",icon:v?f.on:f.off,style:v?"primary":"info"}];return e("div",null,[r.editMode?e(J,null,[m.map(W=>e(h("el-button"),{type:W.style,link:!0,onClick:()=>n(W.type)},{default:()=>[e("i",{class:`el-icon--left ${W.icon}`},null),W.text]}))]):e(J,null,[k?e(h("el-button"),{type:"danger",link:!0,disabled:r.disabled,onClick:()=>n("delete")},{default:()=>[e("i",{class:"el-icon--left el-icon-delete"},null),L("删除")]}):null,p?e(h("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>n("add")},{default:()=>[e("i",{class:"el-icon--left el-icon-plus"},null),L("新增")]}):null,e(h("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>n("export")},{default:()=>[e("i",{class:"el-icon--left el-icon-download"},null),L("导出")]}),e(h("el-tooltip"),{effect:"dark",content:"配置表格展示、排序等操作",placement:"top-end"},{default:()=>[e(h("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>n("setting")},{default:()=>[e("i",{class:"el-icon--left el-icon-setting"},null),L("设置")]})]})])])}function St(){const r=Array.from({length:6}).map((n,t)=>({id:t}));return e("div",{class:"the-thumbnail-search flex"},[e("div",{class:"the-thumbnail-search-content f1"},[r.map(n=>e("div",{key:n.id,class:"the-thumbnail-search-item"},null))]),e("div",{class:"the-thumbnail-search-btn f-vertical"},[e("i",{class:"el-icon-search"},null)])])}function Ct(){return e("section",{class:"the-thumbnail-table"},[e("svg",{width:280,height:180,viewBox:`0 0 ${280*1} ${180*1}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","data-v-d2b0a988":"",class:"the-thumbnail-table-svg"},[e("rect",{width:280,height:180,fill:""},null),e("g",{filter:"url(#filter0_d_13550_224439)"},[e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V132C215 133.105 214.105 134 213 134H67C65.8954 134 65 133.105 65 132V60Z",fill:"var(--el-fill-color-blank)"},null),e("path",{d:"M67 57.7C65.7297 57.7 64.7 58.7297 64.7 60V132C64.7 133.27 65.7297 134.3 67 134.3H213C214.27 134.3 215.3 133.27 215.3 132V60C215.3 58.7297 214.27 57.7 213 57.7H67Z",stroke:"var(--el-border-color-dark)","stroke-width":.6*1},null)]),[76,92,108,124].map((k,p)=>e("rect",{key:p,x:71*1,y:k*1,width:16*1,height:4*1,rx:2*1,fill:"var(--el-color-primary)"},null)),[107,143,197].map((k,p)=>[76,92,108,124].map((v,f)=>e("rect",{key:`${p}-${f}`,x:k*1,y:v*1,width:p===2?12*1:20*1,height:4*1,rx:2*1,fill:"var(--el-border-color-dark)"},null))),e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V70H65V60Z",fill:"var(--el-border-color-light)"},null),[71,107,143,199].map(k=>e("rect",{key:k,x:k*1,y:63*1,width:10*1,height:2*1,rx:1*1,fill:"var(--el-border-color-dark)"},null)),[85.75,101.75,117.75].map((k,p)=>e("line",{key:p,x1:65*1,y1:k*1,x2:215*1,y2:k*1,stroke:"var(--el-border-color-light)","stroke-width":.5*1},null)),e("defs",null,[e("filter",{id:"filter0_d_13550_224439",x:"51.0666",y:"44.0671",width:177.867*1,height:103.866*1,filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},[e("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"},null),e("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"},null),e("feOffset",null,null),e("feGaussianBlur",{stdDeviation:6.66667*1},null),e("feComposite",{in2:"hardAlpha",operator:"out"},null),e("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"},null),e("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_13550_224439"},null),e("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_13550_224439",result:"shape"},null)])])])])}const Tt={key:0,class:"el-icon-rank el-icon--left",style:{"line-height":"32px"}},Et={class:"f-vertical w-full"},Ut=V("i",{class:"el-icon-edit"},null,-1),Mt=V("i",{class:"el-icon-delete"},null,-1),Ot={key:1},Nt=V("i",{class:"el-icon--left el-icon-delete"},null,-1),Bt=V("i",{class:"el-icon--left el-icon-finished"},null,-1),Ft=V("i",{class:"el-icon--left el-icon-plus"},null,-1),Lt={name:"TableForm"},tt=ne({...Lt,props:{config:{type:Object,default:()=>Ie()},type:{type:String},editMode:{type:Boolean},disabled:{type:Boolean}},emits:["change"],setup(r,{expose:n,emit:t}){const k=r,p=t,v=ge(),f=Ie(),m=oe({config:f,form:{},rules:{}}),W=Ne(),q=X(()=>k.type==="add"?"新增":"编辑"),S=X(()=>W.editor.show);function I(j){l(),W.editor.action=j>=0?"edit":"add",W.editor.form=m.config,W.editor.index=j,W.editor.show=!0}function K(j){const $=m.config.fields;l(),ye({title:"操作提示",content:`是否删除【${$[j].label}】？`,cancelText:"取消",confirm(){$.splice(j,1)}})}function A(){ye({title:"操作提示",content:`是否移除【${q.value}】表单？移除后将不会出现对应功能按钮。`,cancelText:"取消",confirm(){m.config.fields=[]}})}function y(){p("change")}function F(){const j=k.type==="add"?"编辑":"新增";ye({title:"操作提示",content:`是否将表单数据同步到【${j}】表单？`,cancelText:"不同步",confirmText:"同步",cancel(){p("change",m.config)},confirm(){p("change",m.config,!0)}})}function b(j){var $;($=v.value)==null||$.validate(i=>{if(i&&j){const _=E.value,M={};Z.value.forEach(s=>{M[s.key]=_[s.key]}),j(_,M)}})}function l(){var j;(j=v.value)==null||j.clearValidate()}function P(){m.config.fields.forEach(Be)}function H(j){m.config.fields.forEach($=>{if(Object.prototype.hasOwnProperty.call(j,$.key)){const i=j[$.key];if(!i)return;switch($.type){case"date":Q(i,"array")?$.value=i.map(_=>new Date(_)):$.value=new Date(i);break;default:$.value=i;break}}})}const{onDragStart:G,onDragMove:R,onDropEnd:ae}=De({list:()=>m.config.fields,key:"id",findLevel:10});he(()=>k.config,function(j){j&&(m.config=ce(j))},{immediate:!0}),he(()=>m.config.fields,function(j){const $={},i={},_=["input","input-between","textarea"];j&&j.forEach(M=>{$[M.key]=M.value,M.required&&(i[M.key]=[{required:!0,validator(s,c,B){const D=[void 0,null,""];if(M.type==="input-between"&&!M.value[0]&&!M.value[1]){B(new Error("请输入两个范围字段"));return}if(M.valueType==="array"&&!M.value.length){B(new Error(M.placeholder||"请选择"));return}if(M.valueType!=="boolean"&&D.includes(M.value)){const a=_.includes(M.type)?"请输入内容":"请选择";B(new Error(M.placeholder||a));return}B()},trigger:_.includes(M.type)?"blur":"change"}])}),m.form=$,m.rules=i,setTimeout(l)},{immediate:!0});const E=X(()=>{const j={};return m.config.fields.forEach($=>{j[$.key]=Ge($).value}),j}),Z=X(()=>m.config.fields.filter(j=>{const $=j.show;if(!$)return!0;if(Q($,"function"))return $(E.value);if($.includes("return"))try{return new Function("formData",$)(E.value)}catch(i){console.warn("解析表单展示逻辑代码错误 >>",i)}return!0}));return n({clear:l,validate:b,reset:P,setFormData:H}),(j,$)=>{const i=h("el-button"),_=h("el-form-item"),M=h("el-empty"),s=h("el-form");return u(),C(s,{ref_key:"formRef",ref:v,model:m.form,rules:m.rules,labelWidth:g(_e)(m.config.labelWidth),labelPosition:m.config.labelPosition,disabled:k.disabled,style:Se(k.editMode?{width:g(_e)(m.config.width)}:null),class:de([{"is-edit-form":k.editMode}])},{default:o(()=>[k.editMode?(u(),T(J,{key:0},[e(Ve,{name:"the-group",tag:"div"},{default:o(()=>[(u(!0),T(J,null,te(m.config.fields,(c,B)=>(u(),C(_,{class:de([{"the-curd-selected":g(W).editor.index===B&&S.value}]),prop:c.key,key:c.id,"data-key":c.id,draggable:m.config.fields.length>1&&!g(W).editor.show?!0:null,onDragstart:D=>g(G)(B),onDragover:D=>g(R)(D,B),onDrop:g(ae)},{label:o(()=>[m.config.fields.length>1&&!g(W).editor.show?(u(),T("i",Tt)):O("",!0),V("span",null,le(c.label),1)]),default:o(()=>[V("div",Et,[e(xe,{class:"mgr-10",fieldData:c,editMode:""},null,8,["fieldData"]),e(i,{link:"",type:"success",disabled:S.value,onClick:D=>I(B)},{default:o(()=>[Ut]),_:2},1032,["disabled","onClick"]),e(i,{link:"",type:"danger",disabled:S.value,onClick:D=>K(B)},{default:o(()=>[Mt]),_:2},1032,["disabled","onClick"])])]),_:2},1032,["class","prop","data-key","draggable","onDragstart","onDragover","onDrop"]))),128))]),_:1}),m.config.fields.length?O("",!0):(u(),C(M,{key:0,description:`当前没有表单项，当没有表单项时【${q.value}】功能按钮不会出现~`},null,8,["description"])),S.value?O("",!0):(u(),T("div",Ot,[e(i,{link:"",onClick:$[0]||($[0]=c=>y())},{default:o(()=>[L(" 退出编辑 ")]),_:1}),e(i,{type:"danger",link:"",disabled:!m.config.fields.length,onClick:$[1]||($[1]=c=>A())},{default:o(()=>[Nt,L(" 删除表单 ")]),_:1},8,["disabled"]),e(i,{type:"success",link:"",onClick:$[2]||($[2]=c=>F())},{default:o(()=>[Bt,L(" 完成表单 ")]),_:1}),e(i,{type:"primary",link:"",onClick:$[3]||($[3]=c=>I(-1))},{default:o(()=>[Ft,L(" 添加一项 ")]),_:1})]))],64)):O("",!0),!k.editMode&&m.config&&m.config.fields?(u(!0),T(J,{key:1},te(Z.value,c=>(u(),C(_,{label:c.label,prop:c.key,key:c.id},{default:o(()=>[e(xe,{fieldData:c},null,8,["fieldData"])]),_:2},1032,["label","prop"]))),128)):O("",!0)]),_:1},8,["model","rules","labelWidth","labelPosition","disabled","style","class"])}}}),Wt={key:1,class:"f-vertical w-full"},qt=V("i",{class:"el-icon--right el-icon-question the-tips-icon"},null,-1),At={key:1,class:"f1 f-right"},Yt={name:"TableHeader"},lt=ne({...Yt,props:{column:{type:Object,required:!0}},emits:["sort"],setup(r,{emit:n}){const t=r,k=n,p=X(()=>!t.column.sort&&!t.column.iconTips),v={true:{index:0,icon:"el-icon-sort"},asc:{index:1,icon:"el-icon-sort-up"},desc:{index:2,icon:"el-icon-sort-down"}},f=[!0,"asc","desc"];function m(){const W=t.column.sort.toString();let q=v[W].index;q++,q>=f.length&&(q=0);const S=f[q];k("sort",t.column.prop,S)}return(W,q)=>{const S=h("el-tooltip"),I=h("el-button");return p.value?(u(),T(J,{key:0},[L(le(t.column.label),1)],64)):(u(),T("div",Wt,[V("span",null,le(t.column.label),1),t.column.iconTips?(u(),C(S,{key:0,effect:"dark",content:t.column.iconTips,placement:"top"},{default:o(()=>[qt]),_:1},8,["content"])):O("",!0),t.column.sort?(u(),T("div",At,[e(I,{link:"",onClick:m},{default:o(()=>[V("i",{class:de(["el-icon--right",v[t.column.sort.toString()].icon])},null,2)]),_:1})])):O("",!0)]))}}}),Jt={name:"TableColumnConfig"},jt=ne({...Jt,props:{show:{type:Boolean,required:!0},type:{type:String,required:!0},keys:{type:Array,required:!0},form:Object},emits:["update:show","submit"],setup(r,{emit:n}){const t=r,k=n,p=oe({show:!1,form:Me("","")}),v=X(()=>`${t.type==="add"?"新增":"编辑"}表格列`),f=ge(),m={label:{required:!0,message:"请输入表格列标题",trigger:"blur"},prop:{required:!0,validator(A,y,F){y?t.keys.includes(p.form.prop)?F(new Error("已经存在相同的值！")):F():F(new Error("输入字段不能为空！"))},trigger:"blur"},jsCode:{required:!0,validator(A,y,F){y?y.includes("return")?F():F(new Error('代码片段必须带有返回字段 "return"')):F(new Error("代码片段不能为空！"))},trigger:"blur"}},W=[{label:"默认普通文本",value:"text"},{label:"图片预览组件",value:"image"},{label:"自定义 js 代码",value:"js"}],q=[{label:"不可排序",value:!1},{label:"可排序",value:!0},{label:"默认升序",value:"asc"},{label:"默认降序",value:"desc"}],S=`
<p>函数代码片段：</p>
<p>第一个参数${ee("cellValue")}是表格值;</p>
<p>第二个参数${ee("row")}是完整对象;</p>
<p>例如：${ee("return cellValue + row.id;")};</p>
<p>也可以是HTML：${ee("return `html 标签`")};</p>
`;function I(){k("update:show",!1)}function K(){var A;(A=f.value)==null||A.validate(y=>{if(!y)return;const F=ce(p.form);["width","minWidth","imageWidth","imageHeight"].forEach(l=>{F[l]&&(F[l]=Number(F[l]))}),F.cellType==="image"&&(F.slot=F.prop),(F.sort||F.iconTips)&&(F.slotHead=`header-${F.prop}`),k("submit",F),I()})}return he(()=>t.show,function(A){p.show=A,A&&(t.type==="add"?p.form=Me("",""):p.form=ce(t.form),setTimeout(()=>{var y;return(y=f.value)==null?void 0:y.clearValidate()}))},{immediate:!0}),(A,y)=>{const F=h("el-input"),b=h("el-form-item"),l=h("el-input-number"),P=h("el-option"),H=h("el-select"),G=h("el-switch"),R=h("el-form"),ae=h("base-dialog");return u(),C(ae,{modelValue:p.show,"onUpdate:modelValue":y[11]||(y[11]=E=>p.show=E),title:v.value,width:"580px",onClose:I},{footer:o(()=>[e(g($e),{onClose:I,onSubmit:K})]),default:o(()=>[e(R,{ref_key:"formRef",ref:f,model:p.form,rules:m,"label-position":"right","label-width":"130px"},{default:o(()=>[e(b,{label:"表格列标题",prop:"label"},{default:o(()=>[e(F,{modelValue:p.form.label,"onUpdate:modelValue":y[0]||(y[0]=E=>p.form.label=E),clearable:"",placeholder:m.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(b,{label:"表格列键值",prop:"prop"},{default:o(()=>[e(F,{modelValue:p.form.prop,"onUpdate:modelValue":y[1]||(y[1]=E=>p.form.prop=E),clearable:"",placeholder:"请输入表格列键值"},null,8,["modelValue"])]),_:1}),e(b,{label:"表格列宽度",prop:"width"},{default:o(()=>[e(l,{modelValue:p.form.width,"onUpdate:modelValue":y[2]||(y[2]=E=>p.form.width=E),class:"w-full","controls-position":"right",placeholder:"请输入表格列宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(b,{label:"表格列最小宽度",prop:"minWidth"},{default:o(()=>[e(l,{modelValue:p.form.minWidth,"onUpdate:modelValue":y[3]||(y[3]=E=>p.form.minWidth=E),class:"w-full","controls-position":"right",placeholder:"请输入表格列最小宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(b,{label:"表格列展示类型",prop:"cellType"},{default:o(()=>[e(H,{modelValue:p.form.cellType,"onUpdate:modelValue":y[4]||(y[4]=E=>p.form.cellType=E)},{default:o(()=>[(u(),T(J,null,te(W,E=>e(P,{key:E.value,value:E.value,label:E.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),p.form.cellType==="image"?(u(),T(J,{key:0},[e(b,{label:"图片宽度(像素)",prop:"imageWidth"},{default:o(()=>[e(l,{modelValue:p.form.imageWidth,"onUpdate:modelValue":y[5]||(y[5]=E=>p.form.imageWidth=E),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1}),e(b,{label:"图片高度(像素)",prop:"imageHeight"},{default:o(()=>[e(l,{modelValue:p.form.imageHeight,"onUpdate:modelValue":y[6]||(y[6]=E=>p.form.imageHeight=E),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1})],64)):O("",!0),p.form.cellType==="js"?(u(),C(b,{key:1,prop:"jsCode"},{label:o(()=>[e(g(ve),{label:"js代码",tips:S})]),default:o(()=>[e(F,{modelValue:p.form.jsCode,"onUpdate:modelValue":y[7]||(y[7]=E=>p.form.jsCode=E),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1})):O("",!0),e(b,{label:"表格列排序操作",prop:"sort"},{default:o(()=>[e(H,{modelValue:p.form.sort,"onUpdate:modelValue":y[8]||(y[8]=E=>p.form.sort=E)},{default:o(()=>[(u(),T(J,null,te(q,E=>e(P,{key:E.value.toString(),value:E.value,label:E.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(b,{label:"内容溢出截断",prop:"tooltip"},{default:o(()=>[e(G,{modelValue:p.form.tooltip,"onUpdate:modelValue":y[9]||(y[9]=E=>p.form.tooltip=E),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(b,{label:"表头图标提示文字",prop:"iconTips"},{default:o(()=>[e(F,{modelValue:p.form.iconTips,"onUpdate:modelValue":y[10]||(y[10]=E=>p.form.iconTips=E),clearable:"",placeholder:"请输入表头图标提示文字"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),It=V("p",{class:"mgb-10"},"表格数据中的字段，例如表格数：",-1),Pt=V("p",{class:"mgb-10"},"则键值可以为 id",-1),Ht=V("p",null,[V("i",{class:"el-icon-info el-icon--left"}),L(" 不填则没有删除功能 ")],-1),Rt={name:"TableDeleteConfig"},zt=ne({...Rt,props:{show:{type:Boolean,default:!1},selectKey:{type:String,default:""}},emits:["update:show","submit"],setup(r,{emit:n}){const t=r,k=n,p='[{ id: 1, name: "名称", status: 2 }]',v=oe({show:!1,keyword:""});function f(){k("update:show",!1)}function m(){f(),k("submit",v.keyword)}return he(()=>t.show,function(W){v.show=W,W&&(v.keyword=t.selectKey||"")},{immediate:!0}),(W,q)=>{const S=h("el-input"),I=h("el-form-item"),K=h("el-form"),A=h("base-dialog");return u(),C(A,{modelValue:v.show,"onUpdate:modelValue":q[1]||(q[1]=y=>v.show=y),title:"配置表格删除功能",width:"400px",onClose:f},{footer:o(()=>[e(g($e),{onClose:f,onSubmit:m})]),default:o(()=>[e(K,{labelPosition:"right",labelWidth:"120px"},{default:o(()=>[e(I,{label:"数据键值"},{default:o(()=>[e(S,{class:"mgb-10",modelValue:v.keyword,"onUpdate:modelValue":q[0]||(q[0]=y=>v.keyword=y),placeholder:"请输入数据键值",clearable:""},null,8,["modelValue"]),V("div",{class:"the-tag blue"},[It,V("p",{class:"mgb-10"},le(p)),Pt,Ht])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Kt={class:"flex"},Gt={class:"f1"},Zt={class:"f-vertical w-full"},Xt={class:"f-right w-full"},Qt=V("i",{class:"el-icon--left el-icon-finished"},null,-1),el=V("i",{class:"el-icon--left el-icon-plus"},null,-1),tl=["data-key","draggable","onDragstart","onDragover"],ll={key:0,class:"el-icon--left el-icon-rank"},ol=V("div",{class:"f1"},null,-1),al=V("i",{class:"el-icon-delete"},null,-1),nl=V("i",{class:"el-icon-edit"},null,-1),il={key:1,class:"w-full f-right"},rl=V("i",{class:"el-icon--left el-icon-plus"},null,-1),sl={name:"TableActionConfig"},ul=ne({...sl,props:{show:{type:Boolean,default:!1},list:{type:Array,required:!0},columnWidth:{type:Number},actionMax:{type:Number}},emits:["update:show","submit"],setup(r,{emit:n}){const t=r,k=n,p=ge(),v=ge(),f=oe({show:!1,list:[],index:-1,hasEdit:!1,formEdit:!1}),m=oe({btn:Ce(),column:{width:160,max:3}}),W={width:{required:!0,message:"请输入表格列宽度，例如：160",trigger:"blur"},max:{required:!1,message:"请输入数量，超出用“更多”下拉展示",trigger:"blur"}},q={text:{required:!0,message:"请输入按钮文字",trigger:"blur"},click:{required:!0,message:"请输入按钮操作代码",trigger:"blur"},icon:{required:!1,message:"请输入图标 class",trigger:"blur"},type:{required:!1,message:"请选择按钮类型",trigger:"change"}};function S(){k("update:show",!1)}function I(){v.value.validate($=>{if(!$)return;S();const{width:i,max:_}=m.column;k("submit",ce(f.list),i,_)})}function K($){p.value.validate(i=>{if(!i)return;const _=ce(m.btn);$==="add"?f.list.push(_):f.list[f.index]=m.btn,A()})}function A(){f.index=-1,m.btn=Ce(),f.formEdit=!1,setTimeout(()=>{var $;return($=p.value)==null?void 0:$.clearValidate()})}function y($){const i=f.list[$];m.btn=JSON.parse(JSON.stringify(i)),f.index=$,f.formEdit=!0}function F($){f.list.splice($,1)}he(()=>t.show,function($){f.show=$,$&&(f.list=ce(t.list),f.hasEdit=f.list.some(i=>i.key===fe),f.index=-1,m.btn=Ce(),m.column={width:t.columnWidth,max:t.actionMax},setTimeout(()=>{var i,_;(i=p.value)==null||i.clearValidate(),(_=v.value)==null||_.clearValidate()}))},{immediate:!0});const b=[{label:"默认（蓝色）",value:"primary"},{label:"成功（绿色）",value:"success"},{label:"警告（橙色）",value:"warning"},{label:"危险（红色）",value:"danger"},{label:"文本（灰色）",value:"info"}],l="https://element.eleme.cn/#/zh-CN/component/icon",{onDragStart:P,onDragMove:H,onDropEnd:G}=De({list:()=>f.list,key:"key"});function R($){if($.key!=fe&&f.list.length>1&&f.index===-1)return!0}function ae($){const i=$.text;if(Q(i,"string")){if(!i.includes("return"))return i;let _="文字配置有误";try{_=new Function("row",i)({})}catch(M){console.warn("解析按钮文字代码错误 >>",M)}return _}return Q(i,"function")?i({}):"未设置按钮"}const E=`
<p>可以输入代码片段，</p>
<p>以${ee("return")}关键字为函数标记，</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>例如：${ee('return row.status === 1 ? "下架" : "上架";')}</p>
`,Z=`
<p>函数代码片段，点击的时候运行</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>第二个参数${ee("index")}是当前索引</p>
<p>例如：${ee("console.log(row, index);")}</p>
`,j=`
<p>可以输入代码片段，</p>
<p>以${ee("return")}关键字为函数标记，</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>例如：${ee("return row.status === 1;")}返回布尔值进行判断</p>
`;return($,i)=>{const _=h("el-text"),M=h("el-divider"),s=h("el-input-number"),c=h("el-form-item"),B=h("el-form"),D=h("el-input"),a=h("el-option"),w=h("el-select"),d=h("el-button"),N=h("el-popconfirm"),Y=h("el-empty"),z=h("base-dialog");return u(),C(z,{modelValue:f.show,"onUpdate:modelValue":i[13]||(i[13]=U=>f.show=U),title:"配置操作列按钮功能",width:"880px",onClose:S},{footer:o(()=>[e(g($e),{disabledSubmit:f.formEdit,onClose:S,onSubmit:I},null,8,["disabledSubmit"])]),default:o(()=>[V("div",Kt,[V("section",Gt,[e(M,{"content-position":"left","border-style":"dashed"},{default:o(()=>[e(_,{type:"info"},{default:o(()=>[L("操作列配置")]),_:1})]),_:1}),e(B,{ref_key:"formColumn",ref:v,model:m.column,rules:W,labelPosition:"right",labelWidth:"128px"},{default:o(()=>[e(c,{label:"操作列宽度",prop:"width"},{default:o(()=>[e(s,{modelValue:m.column.width,"onUpdate:modelValue":i[0]||(i[0]=U=>m.column.width=U),class:"w-full","controls-position":"right",placeholder:W.width.message},null,8,["modelValue","placeholder"])]),_:1}),e(c,{label:"操作按钮限制",prop:"max"},{default:o(()=>[e(s,{modelValue:m.column.max,"onUpdate:modelValue":i[1]||(i[1]=U=>m.column.max=U),class:"w-full","controls-position":"right",min:2,placeholder:W.max.message},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),e(M,{"content-position":"left","border-style":"dashed"},{default:o(()=>[e(_,{type:"info"},{default:o(()=>[L("操作按钮配置")]),_:1})]),_:1}),e(B,{ref_key:"formBtn",ref:p,model:m.btn,rules:q,labelPosition:"right",labelWidth:"128px",class:de({"the-filter-mask":!f.formEdit}),"data-tips":"待新增或编辑操作"},{default:o(()=>[e(c,{prop:"text"},{label:o(()=>[e(g(ve),{label:"按钮文字",tips:E})]),default:o(()=>[e(D,{modelValue:m.btn.text,"onUpdate:modelValue":i[2]||(i[2]=U=>m.btn.text=U),type:"textarea",placeholder:q.text.message},null,8,["modelValue","placeholder"])]),_:1}),e(c,{prop:"click"},{label:o(()=>[e(g(ve),{label:"按钮功能代码",tips:Z})]),default:o(()=>[e(D,{modelValue:m.btn.click,"onUpdate:modelValue":i[3]||(i[3]=U=>m.btn.click=U),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1}),e(c,{prop:"show"},{label:o(()=>[e(g(ve),{label:"按钮显示条件",tips:j})]),default:o(()=>[e(D,{modelValue:m.btn.show,"onUpdate:modelValue":i[4]||(i[4]=U=>m.btn.show=U),type:"textarea",placeholder:"请输入条件代码，为空则默认显示"},null,8,["modelValue"])]),_:1}),e(c,{prop:"disabled"},{label:o(()=>[e(g(ve),{label:"按钮禁用条件",tips:j})]),default:o(()=>[e(D,{modelValue:m.btn.disabled,"onUpdate:modelValue":i[5]||(i[5]=U=>m.btn.disabled=U),type:"textarea",placeholder:"请输入条件代码，为空则默认不禁用"},null,8,["modelValue"])]),_:1}),e(c,{label:"按钮图标",prop:"icon"},{default:o(()=>[V("div",Zt,[e(D,{modelValue:m.btn.icon,"onUpdate:modelValue":i[6]||(i[6]=U=>m.btn.icon=U),placeholder:q.icon.message,clearable:""},null,8,["modelValue","placeholder"]),e(_,{type:"primary",style:{width:"110px","text-align":"right"}},{default:o(()=>[V("a",{href:l,target:"_blank"},"去官网复制")]),_:1})])]),_:1}),e(c,{label:"按钮类型",prop:"type"},{default:o(()=>[e(w,{modelValue:m.btn.type,"onUpdate:modelValue":i[7]||(i[7]=U=>m.btn.type=U),placeholder:q.type.message},{default:o(()=>[(u(),T(J,null,te(b,U=>e(a,{key:U.value,value:U.value,label:U.label},null,8,["value","label"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1}),e(c,null,{default:o(()=>[V("div",Xt,[e(d,{onClick:i[8]||(i[8]=U=>A())},{default:o(()=>[L("取 消")]),_:1}),f.index>-1?(u(),C(d,{key:0,type:"primary",plain:"",onClick:i[9]||(i[9]=U=>K("edit"))},{default:o(()=>[Qt,L(" 确认修改 ")]),_:1})):(u(),C(d,{key:1,type:"primary",plain:"",onClick:i[10]||(i[10]=U=>K("add"))},{default:o(()=>[el,L(" 确认新增 ")]),_:1}))])]),_:1})]),_:1},8,["model","class"])]),e(Ve,{name:"the-group",tag:"div",class:"the-curd-option-list f1"},{default:o(()=>[(u(!0),T(J,null,te(f.list,(U,ie)=>(u(),T("div",{class:de(["the-curd-option-item f-vertical",{"the-curd-selected":ie===f.index}]),key:U.key,"data-key":U.key!==g(fe)?U.key:null,draggable:R(U),onDragstart:se=>g(P)(ie),onDragover:se=>g(H)(se,ie),onDrop:i[11]||(i[11]=(...se)=>g(G)&&g(G)(...se))},[f.index===-1&&U.key!==g(fe)?(u(),T("i",ll)):O("",!0),e(d,{type:U.type,link:""},{default:o(()=>[U.icon?(u(),T("i",{key:0,class:de(["el-icon--left",U.icon])},null,2)):O("",!0),L(" "+le(ae(U)),1)]),_:2},1032,["type"]),ol,U.key===g(fe)?(u(),C(_,{key:1,type:"info",size:"small"},{default:o(()=>[L("编辑按钮不可删除、拖拽等操作，且处于首位")]),_:1})):(u(),T(J,{key:2},[e(N,{width:"186px",title:"是否删除该按钮功能？",onConfirm:se=>F(ie)},{reference:o(()=>[e(d,{link:"",type:"danger",disabled:f.index>-1},{default:o(()=>[al]),_:1},8,["disabled"])]),_:2},1032,["onConfirm"]),e(d,{link:"",type:"success",onClick:se=>y(ie)},{default:o(()=>[nl]),_:2},1032,["onClick"])],64))],42,tl))),128)),f.list.length?O("",!0):(u(),C(Y,{key:"empty","image-size":120,description:"请添加操作列功能按钮"})),f.formEdit?O("",!0):(u(),T("div",il,[f.formEdit?O("",!0):(u(),C(d,{key:0,type:"primary",plain:"",onClick:i[12]||(i[12]=U=>f.formEdit=!0)},{default:o(()=>[rl,L(" 新增功能按钮 ")]),_:1}))]))]),_:1})])]),_:1},8,["modelValue"])}}}),dl={class:"the-curd-table-model the-curd-scrollbar"},cl=["data-key","draggable","onDragstart","onDragover"],pl={class:"fake-table-head f-vertical"},fl=V("i",{class:"el-icon-rank el-icon--left"},null,-1),ml={class:"fake-table-cell"},yl=V("i",{class:"el-icon-edit"},null,-1),vl=V("i",{class:"el-icon-delete"},null,-1),hl={class:"fake-table-cell f-vertical"},bl={key:1,class:"the-tag blue"},gl=V("div",{class:"fake-table-head fvc"},"操作",-1),_l={class:"fake-table-cell",style:{"text-align":"center"}},wl=V("i",{class:"el-icon-setting"},null,-1),kl=V("i",{class:"el-icon-delete"},null,-1),xl={class:"fake-table-cell"},Vl={class:"f-vertical",key:"fixed"},Dl=V("i",{class:"el-icon-plus el-icon--left"},null,-1),$l={key:0},Sl=V("i",{class:"el-icon-plus el-icon--left"},null,-1),Cl={name:"TableModel"},Tl=ne({...Cl,props:{config:{type:Object,required:!0}},emits:["action"],setup(r,{emit:n}){const t=r,k=n,p="https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",v=oe({show:!1,type:"add",index:-1,form:void 0,keys:[]}),f=X(()=>{const i=t.config.columns,_=[],M=[];for(let s=0;s<i.length;s++){const c=i[s];c.prop===be?M.push(c):_.push(c)}return{drag:_,action:M}});function m(i,_){if(v.keys=t.config.columns.map(M=>M.prop),i==="edit"){const M=t.config.columns[_];v.keys=v.keys.filter(s=>s!==M.prop),v.index=_,v.form=M}else v.form=void 0;v.type=i,v.show=!0}function W(i){const _=t.config;if(v.type==="add"){const M=JSON.parse(JSON.stringify(f.value.drag));M.push(i),_.columns=M.concat(f.value.action)}else _.columns[v.index]=i}function q(i){const _=f.value.drag[i];ye({title:"操作提示",content:`是否删除【${_.label}】列？`,cancelText:"取消",confirm(){const M=t.config.columns.findIndex(s=>s.prop===_.prop);t.config.columns.splice(M,1)}})}const{onDragStart:S,onDragMove:I,onDropEnd:K}=De({list:()=>t.config.columns,key:"prop",findLevel:5});function A(i){const _={};return i&&i.width&&(_.width=`${i.width}px`),i&&i.minWidth&&(_.minWidth=`${i.minWidth}px`),_}const y=X(()=>{const i=t.config.columns;if(i.length>0&&i[i.length-1].prop===be)return i[i.length-1]});function F(){const i=Me(be,"操作");i.minWidth=120,i.width=160,t.config.columns.push(i)}function b(){const i=t.config.columns;ye({title:"操作提示",content:"是否删除操作列？删除之后需要重新配置。",cancelText:"取消",confirm(){i.splice(i.length-1,1),t.config.actions=[],t.config.formEdit&&(t.config.formEdit=void 0)}})}const l=oe({show:!1,keyword:""});function P(){const i=t.config.selectKey;l.keyword=i?i.toString():"",l.show=!0}function H(i){t.config.selectKey=i}const G=oe({show:!1,columnWidth:0,actionMax:0});function R(){G.show=!0,G.columnWidth=y.value.width,G.actionMax=t.config.actionMax}function ae(i,_){t.config.actions=i;const M=t.config.columns.find(s=>s.prop===be);M.width=_}const E=oe({show:!1,form:null,type:"add"});function Z(i){E.type=i,i==="add"&&t.config.formAdd&&(E.form=t.config.formAdd),i==="edit"&&t.config.formEdit&&(E.form=t.config.formEdit),E.show=!0}function j(i,_){const M=t.config,s=M.actions;function c(){const B=s.length>0&&s[0].key===fe;i&&i.fields.length>0?(y.value||F(),B||s.unshift({key:fe,text:"编辑",type:"success",icon:"el-icon-edit"})):B&&s.splice(0,1)}i&&(E.type==="add"?(M.formAdd=i,_&&(M.formEdit=JSON.parse(JSON.stringify(i)),c())):(M.formEdit=i,_&&(M.formAdd=JSON.parse(JSON.stringify(i))),c())),E.show=!1,E.form=null}function $(i){switch(i){case"delete":P();break;case"add":Z("add");break;case"edit":Z("edit");break}}return(i,_)=>{const M=h("el-empty"),s=h("el-button"),c=h("el-tooltip"),B=h("base-table-actions"),D=h("el-text");return u(),T(J,null,[E.show?O("",!0):(u(),C(g(et),{key:0,class:"mgb-10 w-full",editMode:!0,config:t.config,onAction:$},null,8,["config"])),V("div",dl,[E.show?(u(),C(tt,{key:0,config:E.form,type:E.type,editMode:!0,onChange:j},null,8,["config","type"])):(u(),C(Ve,{key:1,name:"the-group",tag:"div",class:"fake-table"},{default:o(()=>[t.config.columns.length?O("",!0):(u(),C(M,{key:"empty",style:{padding:"10px 40px"},"image-size":120,description:"请添加表格列"})),(u(!0),T(J,null,te(f.value.drag,(a,w)=>(u(),T("div",{key:a.prop,"data-key":a.prop,class:"fake-table-item",draggable:f.value.drag.length>1,style:Se(A(a)),onDragstart:d=>g(S)(w),onDragover:d=>g(I)(d,w),onDrop:_[0]||(_[0]=d=>g(K)())},[V("div",pl,[fl,e(lt,{column:a},null,8,["column"])]),V("div",ml,[e(s,{circle:"",plain:"",type:"success",size:"small",onClick:d=>m("edit",w)},{default:o(()=>[yl]),_:2},1032,["onClick"]),e(s,{circle:"",plain:"",type:"danger",size:"small",onClick:d=>q(w)},{default:o(()=>[vl]),_:2},1032,["onClick"])]),V("div",hl,[a.cellType==="text"?(u(),T(J,{key:0},[L("文本内容")],64)):a.cellType==="js"?(u(),T("span",bl,"自定义代码")):O("",!0),e(g(Qe),{column:a,src:p},null,8,["column"])])],44,cl))),128)),y.value?(u(),T("div",{style:Se(A(y.value)),key:g(be),class:"fake-table-item"},[gl,V("div",_l,[e(c,{effect:"dark",content:"配置【操作按钮】和【操作列】的宽度",placement:"top"},{default:o(()=>[e(s,{circle:"",plain:"",type:"primary",size:"small",onClick:_[1]||(_[1]=a=>R())},{default:o(()=>[wl]),_:1})]),_:1}),e(s,{circle:"",plain:"",type:"danger",size:"small",onClick:_[2]||(_[2]=a=>b())},{default:o(()=>[kl]),_:1})]),V("div",xl,[t.config.actions.length?(u(),C(B,{key:0,row:{},index:1,actions:t.config.actions},null,8,["actions"])):(u(),C(D,{key:1,type:"info"},{default:o(()=>[L("待添加操作~")]),_:1}))])],4)):O("",!0),V("div",Vl,[V("div",null,[V("p",null,[e(s,{type:"primary",text:"",onClick:_[3]||(_[3]=a=>m("add"))},{default:o(()=>[Dl,L(" 添加内容列 ")]),_:1})]),y.value?O("",!0):(u(),T("p",$l,[e(s,{type:"primary",text:"",onClick:_[4]||(_[4]=a=>F())},{default:o(()=>[Sl,L(" 添加操作列 ")]),_:1})]))])])]),_:1}))]),E.show?O("",!0):(u(),C(g(Xe),{key:1,type:E.type,onAction:_[5]||(_[5]=a=>k("action",a))},null,8,["type"])),e(jt,{show:v.show,"onUpdate:show":_[6]||(_[6]=a=>v.show=a),type:v.type,keys:v.keys,form:v.form,onSubmit:W},null,8,["show","type","keys","form"]),e(zt,{show:l.show,"onUpdate:show":_[7]||(_[7]=a=>l.show=a),"select-key":l.keyword,onSubmit:H},null,8,["show","select-key"]),e(ul,{show:G.show,"onUpdate:show":_[8]||(_[8]=a=>G.show=a),columnWidth:G.columnWidth,actionMax:G.actionMax,list:t.config.actions,onSubmit:ae},null,8,["show","columnWidth","actionMax","list"])],64)}}}),El={class:"the-curd-example"},Ul={name:"Example"},Ml=ne({...Ul,props:{selected:{type:String},type:{type:String}},emits:["choose"],setup(r,{emit:n}){const t=r,k=n,p=[{...re("input"),placeholder:ue.input},{...re("select"),placeholder:ue.select},{...re("select-multiple"),placeholder:ue["select-multiple"]},{...re("cascader"),placeholder:ue.cascader},{...re("date"),placeholder:ue.date},{...re("checkbox"),options:[{label:"多选-A",value:1},{label:"多选-B",value:2}],defaultValue:[1]},{...re("radio"),options:[{label:"单选-A",value:"radio-1"},{label:"单选-B",value:"radio-2"}],defaultValue:"radio-1"},{...re("switch"),defaultValue:!0},{...re("textarea"),placeholder:ue.textarea},{...re("input-between"),placeholder:["范围区间操作","范围区间操作"]}],v=["radio","checkbox","textarea","switch"],f=X(()=>t.type==="search"?p.filter(m=>!v.includes(m.type)):p);return(m,W)=>(u(),T("div",El,[(u(!0),T(J,null,te(f.value,q=>(u(),C(xe,{key:q.type,"field-data":q,class:de(["the-curd-example-item fvc",{"the-curd-selected":t.selected===q.type}]),readonly:"",onClick:S=>k("choose",q.type)},null,8,["field-data","class","onClick"]))),128))]))}}),Ol={key:0,class:"the-curd-editor-content"},Nl=V("h2",{class:"the-title mgb-20"},"基础设置",-1),Bl={class:"f-vertical f-between mgb-20"},Fl=V("h2",{class:"the-title"},"第1步：点击选取组件",-1),Ll={class:"f-vertical mgb-20"},Wl={class:"the-title"},ql=V("div",{class:"f1"},null,-1),Al={key:0,class:"the-curd-target-box"},Yl=V("i",{class:"el-icon-question the-tips-icon mgl-10"},null,-1),Jl=V("a",{href:"https://www.json.cn/",target:"_blank"}," JSON编辑工具 ",-1),jl={class:"f-right"},Il=V("i",{class:"el-icon--left el-icon-plus"},null,-1),Pl=V("i",{class:"el-icon--left el-icon-edit"},null,-1),Hl={name:"Editor"},Rl=ne({...Hl,props:{show:{type:Boolean,default:!1},config:{type:Object,required:!0}},emits:["update:show"],setup(r,{emit:n}){const t=r,k=n;function p(){k("update:show",!1)}const v=["checkbox","radio","switch"],f=["select","select-multiple","radio","checkbox","cascader"],m=["input","textarea","select","radio"],W=["input-between","select-multiple","checkbox","cascader"],q=["input","select","radio"],S=["daterange","datetimerange"],I=q.concat(W),K=`<p>参考 src/utils/index.ts 中的${ee("formatDate")}函数</p>`,A=`
<p>动态表单项的条件显示逻辑函数；</p>
<p>返回${ee("false")}则不展示对应项；</p>
<p>函数有一个参数：${ee("formData")}为当前表单的数据值；</p>
<p>以${ee("return")}为函数代码片段标记；</p>
<p>例如：${ee("return formData.type !== 2")}</p>
`,y=Ne(),F=X(()=>y.editor.action==="add"),b=X(()=>{let D=[];return l.formData&&l.formData.type==="date"&&(D=Fe[l.formData.dateType].map((w,d)=>({label:w.text,value:d}))),D.unshift({label:"将预览组件中的值设为默认",value:-1}),D}),l=oe({step:0,formData:void 0});function P(D){l.step=D}const H={label:{required:!0,message:"请输入功能标题",trigger:"blur"},key:{required:!0,trigger:"blur",validator(D,a,w){a?c.includes(a)?w(new Error("当前键值已经被占用！")):w():w(new Error("绑定的键值不能为空"))}},format:{required:!0,message:"格式化规则不能为空",trigger:"blur"},separator:{required:!0,message:"请输入串联符号",trigger:"blur"},defaultValue:{required:!0,trigger:"blur",validator(D,a,w){const d=Z();d===!0?w():w(new Error(d)),w()}},options:{required:!0,trigger:"blur",validator(D,a,w){const d=j();d===!0?w():w(new Error(d))}}},G=ge(),R=oe({options:"",defaultValue:""});function ae(D){D.type!=="date"&&(R.defaultValue=JSON.stringify({value:D.defaultValue})),f.includes(D.type)&&(R.options=JSON.stringify(D.options))}function E(D){var d;const a=y.editor,w=re(D,"",a.type==="search");l.formData=w,ae(w),(d=G.value)==null||d.clearValidate(),P(1)}function Z(){const D='输入的格式必须为 { "value": "input value" }',a=R.defaultValue;if(!a)return D;const w=l.formData.type,d=l.formData.valueType,N=ue[w];try{const Y=JSON.parse(a);if(!Q(Y,"object"))return D;if(w==="switch"&&!Q(Y.value,"boolean"))return`${N}的绑定值应该为 boolean 类型`;if(W.includes(w)){if(!Q(Y.value,"array"))return`${N}的绑定值应该为 array 类型`;if(d==="array<number>"&&Y.value.some(z=>z!==""&&!Q(z,"number")))return"数组中只能出现数字"}if(m.includes(w)&&!["string","number"].includes(Ee(Y.value)))return`${N}的绑定值应该为 string/number 类型`;if(w==="date"){const z=l.formData;if(S.includes(z.dateType)){if(!Q(Y.value,"array"))return"范围日期绑定值应该为 array 类型"}else if(!Q(Y.value,"string"))return"日期类型绑定值应该为 string 类型"}if(q.includes(w)&&d==="number"&&Y.value!==""&&!Q(Y.value,"number"))return`${N}的绑定值应该为 number 类型`}catch(Y){return console.warn("checkDefaultValue >>",Y),D}return!0}function j(){const D=R.options;if(!D)return"选项数据不能为空！";try{const a=JSON.parse(D);if(!Q(a,"array"))return"选项数据格式不正确，需要为数组类型！";const w=l.formData,d=w.optionSetting.value||"value",N=[void 0,null];for(let Y=0;Y<a.length;Y++){const z=a[Y];if(!Q(z,"object"))return"数组项必须为对象！";if(N.includes(z[d]))return`数组项的值不能为${N.join("/")}`;if(["array<number>","number"].includes(w.valueType)&&!Q(z[d],"number")&&z[d]!=="")return"数组项的值必须为 number 类型"}return!0}catch(a){return console.warn("checkOptions >>",a),"不合法的JSON,注意使用双引号,结尾不能为逗号等"}}function $(){j()===!0&&(l.formData.options=JSON.parse(R.options))}function i(){if(Z()===!0){const a=l.formData,w=JSON.parse(R.defaultValue).value;a.type!=="date"&&(a.defaultValue=w)}}function _(D){const a=Pe.find(d=>d.value===D),w=l.formData;w.shortcutIndex="",S.includes(a.value)?(w.value=[],w.valueType="array"):(w.value="",w.valueType="string"),w.formatShow=a.formatShow,w.format=a.format}function M(D){return/^[+-]?(\d|([1-9]\d+))(\.\d+)?$/.test(D)}function s(){var D;(D=G.value)==null||D.validate(a=>{if(ft("#the-editor-form",a),!a)return;i(),f.includes(l.formData.type)&&$();const w=y.editor,d=JSON.parse(JSON.stringify(l.formData));if(f.includes(d.type)&&$(),d.valueType||(d.valueType=Ee(d.defaultValue)),f.includes(d.type)&&["number","array<number>"].includes(d.valueType)){let Y=d.optionSetting.value;Y||(Y="value",d.optionSetting.value=Y);for(let z=0;z<d.options.length;z++){const U=d.options[z],ie=U[Y];if([null,void 0].includes(ie))return pe.error("数据值字段与选项数据不匹配，请检查！");if(M(ie.toString()))U[Y]=Number(ie);else{const se=U[d.optionSetting.label];return pe.error(`选项数据中【${se}】的值应该为数字！`)}}}d.type==="date"&&!Q(d.shortcutIndex,"number")&&(d.value=d.valueType==="array"?[]:""),{search(Y){Y?t.config.search.list.push(d):t.config.search.list[w.index]=d},table(Y){if(Y){const z=JSON.parse(JSON.stringify(w.form.fields));z.push(d),w.form.fields=z}else{const z=JSON.parse(JSON.stringify(w.form.fields));z[w.index]=d,w.form.fields=z}}}[w.type](F.value),p()})}let c=[];function B(D){const a=y.editor;c=[],{search(){c=t.config.search.list.map(d=>d.key)},table(){c=a.form.fields.map(d=>d.key)}}[a.type](),D&&(c=c.filter(d=>d!==D))}return he(()=>t.show,function(D){if(!D){l.formData=void 0;return}const a=y.editor;if(a.action==="add")l.step=0,l.formData=void 0,B();else{const w=a.index;({search(){l.formData=JSON.parse(JSON.stringify(t.config.search.list[w]))},table(){var N;l.formData=JSON.parse(JSON.stringify((N=a.form)==null?void 0:N.fields[w]))}})[a.type](),ae(l.formData),B(l.formData.key),l.step=1}}),(D,a)=>{const w=h("el-input-number"),d=h("el-form-item"),N=h("el-switch"),Y=h("el-form"),z=h("el-button"),U=h("el-input"),ie=h("el-text"),se=h("el-tooltip"),Le=h("el-option"),We=h("el-select");return u(),T("section",{class:de(["the-curd-editor the-curd-scrollbar",{"is-show":t.show}])},[e(it,{name:"the-curd-editor-move"},{default:o(()=>{var qe;return[t.show?(u(),T("div",Ol,[Nl,e(Y,{"label-position":"right","label-width":"120px"},{default:o(()=>[g(y).editor.type==="search"?(u(),T(J,{key:0},[e(d,{label:"整体标题宽度"},{default:o(()=>[e(w,{modelValue:t.config.search.labelWidth,"onUpdate:modelValue":a[0]||(a[0]=x=>t.config.search.labelWidth=x),class:"w-full","controls-position":"right",placeholder:"例如：120px"},null,8,["modelValue"])]),_:1}),e(d,{label:"标题靠右对齐"},{default:o(()=>[e(N,{modelValue:t.config.search.labelRight,"onUpdate:modelValue":a[1]||(a[1]=x=>t.config.search.labelRight=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):O("",!0),g(y).editor.type==="table"&&g(y).editor.form?(u(),T(J,{key:1},[e(d,{label:"表单宽度"},{default:o(()=>[e(w,{modelValue:g(y).editor.form.width,"onUpdate:modelValue":a[2]||(a[2]=x=>g(y).editor.form.width=x),class:"w-full","controls-position":"right",placeholder:"请输入宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"文字宽度"},{default:o(()=>[e(w,{modelValue:g(y).editor.form.labelWidth,"onUpdate:modelValue":a[3]||(a[3]=x=>g(y).editor.form.labelWidth=x),class:"w-full","controls-position":"right",placeholder:"请输入标题宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"文字靠右排版"},{default:o(()=>[e(N,{modelValue:g(y).editor.form.labelPosition,"onUpdate:modelValue":a[4]||(a[4]=x=>g(y).editor.form.labelPosition=x),"inline-prompt":"","active-value":"right","inactive-value":"left","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):O("",!0)]),_:1}),l.step===0?(u(),T(J,{key:0},[V("div",Bl,[Fl,e(z,{link:"",type:"primary",onClick:a[5]||(a[5]=x=>p())},{default:o(()=>[L("退出编辑")]),_:1})]),e(Ml,{selected:(qe=l.formData)==null?void 0:qe.type,type:g(y).editor.type,onChoose:E},null,8,["selected","type"])],64)):O("",!0),l.step===1?(u(),T(J,{key:1},[V("div",Ll,[V("h2",Wl,"第2步：配置"+le(g(ue)[l.formData.type]),1),ql,e(z,{link:"",type:"success",onClick:a[6]||(a[6]=x=>P(0))},{default:o(()=>[L("上一步")]),_:1}),e(z,{link:"",type:"primary",onClick:a[7]||(a[7]=x=>p())},{default:o(()=>[L("退出编辑")]),_:1})]),l.formData?(u(),T("div",Al,[e(xe,{"field-data":l.formData,"edit-mode":""},null,8,["field-data"])])):O("",!0),l.formData?(u(),C(Y,{key:1,id:"the-editor-form",ref_key:"formRef",ref:G,model:l.formData,rules:H,"label-position":"right","label-width":"128px"},{default:o(()=>[e(d,{label:"组件标题",prop:"label"},{default:o(()=>[e(U,{modelValue:l.formData.label,"onUpdate:modelValue":a[8]||(a[8]=x=>l.formData.label=x),clearable:"",placeholder:H.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(d,{label:"绑定的键值",prop:"key"},{default:o(()=>[e(U,{modelValue:l.formData.key,"onUpdate:modelValue":a[9]||(a[9]=x=>l.formData.key=x),clearable:"",placeholder:"请输入绑定的键值"},null,8,["modelValue"])]),_:1}),e(d,{label:"标题宽度",prop:"labelWidth"},{default:o(()=>[e(w,{modelValue:l.formData.labelWidth,"onUpdate:modelValue":a[10]||(a[10]=x=>l.formData.labelWidth=x),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：120"},null,8,["modelValue"])]),_:1}),v.includes(l.formData.type)?O("",!0):(u(),C(d,{key:0,label:"组件宽度",prop:"valueWidth"},{default:o(()=>[e(w,{modelValue:l.formData.valueWidth,"onUpdate:modelValue":a[11]||(a[11]=x=>l.formData.valueWidth=x),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：140"},null,8,["modelValue"])]),_:1})),e(d,{label:"提示/规则文字",prop:"placeholder"},{default:o(()=>[l.formData.type==="input-between"?(u(),T(J,{key:0},[e(U,{modelValue:l.formData.placeholder[0],"onUpdate:modelValue":a[12]||(a[12]=x=>l.formData.placeholder[0]=x),class:"f1",clearable:"",placeholder:"请输入提示-1"},null,8,["modelValue"]),e(ie,{style:{padding:"0 6px"}},{default:o(()=>[L("-")]),_:1}),e(U,{modelValue:l.formData.placeholder[1],"onUpdate:modelValue":a[13]||(a[13]=x=>l.formData.placeholder[1]=x),class:"f1",clearable:"",placeholder:"请输入提示-2"},null,8,["modelValue"])],64)):(u(),C(U,{key:1,modelValue:l.formData.placeholder,"onUpdate:modelValue":a[14]||(a[14]=x=>l.formData.placeholder=x),clearable:"",placeholder:"请输入规则提示/输入框提示文字"},null,8,["modelValue"]))]),_:1}),e(d,{label:"是否必填",prop:"required"},{default:o(()=>[e(N,{modelValue:l.formData.required,"onUpdate:modelValue":a[15]||(a[15]=x=>l.formData.required=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),g(I).includes(l.formData.type)?(u(),C(d,{label:"绑定值为数字类型",key:"is-number"},{default:o(()=>[W.includes(l.formData.type)?(u(),C(N,{key:0,modelValue:l.formData.valueType,"onUpdate:modelValue":a[16]||(a[16]=x=>l.formData.valueType=x),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"array<number>","inactive-value":"array"},null,8,["modelValue"])):(u(),C(N,{key:1,modelValue:l.formData.valueType,"onUpdate:modelValue":a[17]||(a[17]=x=>l.formData.valueType=x),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"number","inactive-value":"string"},null,8,["modelValue"])),f.includes(l.formData.type)?(u(),C(se,{key:2,effect:"dark",content:"设为数字类型之后，将会在保存时校验选项数据",placement:"top"},{default:o(()=>[Yl]),_:1})):O("",!0)]),_:1})):O("",!0),l.formData.type!=="date"?(u(),C(d,{key:2,label:"组件默认值",prop:"defaultValue"},{default:o(()=>[e(U,{modelValue:R.defaultValue,"onUpdate:modelValue":a[18]||(a[18]=x=>R.defaultValue=x),type:"textarea",clearable:"",placeholder:"请输入JSON，值为 value",onBlur:a[19]||(a[19]=x=>i())},null,8,["modelValue"])]),_:1})):O("",!0),l.formData.type==="input-between"?(u(),C(d,{key:3,label:"串联符号",prop:"separator"},{default:o(()=>[e(U,{modelValue:l.formData.separator,"onUpdate:modelValue":a[20]||(a[20]=x=>l.formData.separator=x),clearable:"",placeholder:H.separator.message},null,8,["modelValue","placeholder"])]),_:1})):O("",!0),f.includes(l.formData.type)?(u(),T(J,{key:4},[e(d,{label:"选项数据",prop:"options"},{default:o(()=>[e(U,{modelValue:R.options,"onUpdate:modelValue":a[21]||(a[21]=x=>R.options=x),type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"请输入数组JSON",style:{"margin-bottom":"4px"},onBlur:a[22]||(a[22]=x=>$())},null,8,["modelValue"]),e(z,{link:"",type:"primary"},{default:o(()=>[Jl]),_:1})]),_:1}),e(d,{label:"数据展示字段",prop:"optionSetting.label"},{default:o(()=>[e(U,{modelValue:l.formData.optionSetting.label,"onUpdate:modelValue":a[23]||(a[23]=x=>l.formData.optionSetting.label=x),clearable:"",placeholder:"不填则使用 label"},null,8,["modelValue"])]),_:1}),e(d,{label:"数据值字段",prop:"optionSetting.value"},{default:o(()=>[e(U,{modelValue:l.formData.optionSetting.value,"onUpdate:modelValue":a[24]||(a[24]=x=>l.formData.optionSetting.value=x),clearable:"",placeholder:"不填则使用 value"},null,8,["modelValue"])]),_:1}),l.formData.type==="cascader"?(u(),T(J,{key:0},[e(d,{label:"下级字段",prop:"optionSetting.children"},{default:o(()=>[e(U,{modelValue:l.formData.optionSetting.children,"onUpdate:modelValue":a[25]||(a[25]=x=>l.formData.optionSetting.children=x),clearable:"",placeholder:"不填则使用 children"},null,8,["modelValue"])]),_:1}),e(d,{label:"是否多选",prop:"multiple"},{default:o(()=>[e(N,{modelValue:l.formData.multiple,"onUpdate:modelValue":a[26]||(a[26]=x=>l.formData.multiple=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(d,{label:"允许只选中某一项",prop:"checkStrictly"},{default:o(()=>[e(N,{modelValue:l.formData.checkStrictly,"onUpdate:modelValue":a[27]||(a[27]=x=>l.formData.checkStrictly=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):O("",!0)],64)):O("",!0),l.formData.type==="date"?(u(),T(J,{key:5},[e(d,{label:"日期类型",prop:"dateType"},{default:o(()=>[e(We,{modelValue:l.formData.dateType,"onUpdate:modelValue":a[28]||(a[28]=x=>l.formData.dateType=x),class:"w-full",onChange:_},{default:o(()=>[(u(!0),T(J,null,te(g(Pe),x=>(u(),C(Le,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"日期默认值",prop:"shortcutIndex"},{default:o(()=>[e(We,{modelValue:l.formData.shortcutIndex,"onUpdate:modelValue":a[29]||(a[29]=x=>l.formData.shortcutIndex=x),class:"w-full",placeholder:"请选择",clearable:""},{default:o(()=>[(u(!0),T(J,null,te(b.value,x=>(u(),C(Le,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{prop:"format"},{label:o(()=>[e(g(ve),{label:"格式化规则",tips:K})]),default:o(()=>[e(U,{modelValue:l.formData.format,"onUpdate:modelValue":a[30]||(a[30]=x=>l.formData.format=x),clearable:"",placeholder:H.format.message},null,8,["modelValue","placeholder"])]),_:1})],64)):O("",!0),g(y).editor.type==="table"?(u(),C(d,{key:6,prop:"show"},{label:o(()=>[e(g(ve),{label:"表单显示逻辑",tips:A})]),default:o(()=>[e(U,{modelValue:l.formData.show,"onUpdate:modelValue":a[31]||(a[31]=x=>l.formData.show=x),type:"textarea",placeholder:"请输入条件代码，为空则默认展示"},null,8,["modelValue"])]),_:1})):O("",!0),V("div",jl,[e(z,{onClick:a[32]||(a[32]=x=>p())},{default:o(()=>[L("关闭")]),_:1}),F.value?(u(),C(z,{key:0,type:"primary",onClick:a[33]||(a[33]=x=>s())},{default:o(()=>[Il,L(" 新增 ")]),_:1})):(u(),C(z,{key:1,type:"success",onClick:a[34]||(a[34]=x=>s())},{default:o(()=>[Pl,L(" 确认 ")]),_:1}))])]),_:1},8,["model"])):O("",!0)],64)):O("",!0)])):O("",!0)]}),_:1})],2)}}}),zl=["data-key","onDragstart","onDragover"],Kl=V("i",{class:"el-icon--left el-icon-rank"},null,-1),Gl={class:"f1"},Zl={name:"TableSetting"},Xl=ne({...Zl,props:{show:{type:Boolean,default:!1},columns:{type:Array,required:!0}},emits:["update:show","submit"],setup(r,{emit:n}){const t=r,k=n,p=[{label:"固定左边",value:"left"},{label:"默认",value:!1},{label:"固定右边",value:"right"}],v=oe({show:!1,list:[]}),{onDragStart:f,onDragMove:m,onDropEnd:W}=De({list:()=>v.list,key:"prop"});let q;function S(){k("update:show",!1)}function I(){S();const K=ce(v.list);q&&K.push(q),k("submit",K)}return he(()=>t.show,function(K){if(v.show=K,!K)return;const A=ce(t.columns),y=[];for(let F=0;F<A.length;F++){const b=A[F];b.prop===be?q=b:y.push(b)}v.list=y},{immediate:!0}),(K,A)=>{const y=h("el-radio-button"),F=h("el-radio-group"),b=h("el-switch"),l=h("el-empty"),P=h("base-dialog");return u(),C(P,{modelValue:v.show,"onUpdate:modelValue":A[1]||(A[1]=H=>v.show=H),title:"表格设置",width:"840px",onClose:S},{footer:o(()=>[e(g($e),{onClose:S,onSubmit:I})]),default:o(()=>[e(Ve,{name:"the-group",tag:"div"},{default:o(()=>[(u(!0),T(J,null,te(v.list,(H,G)=>(u(),T("div",{class:"the-curd-option-item f-vertical",key:H.prop,"data-key":H.prop,draggable:!0,onDragstart:R=>g(f)(G),onDragover:R=>g(m)(R,G),onDrop:A[0]||(A[0]=(...R)=>g(W)&&g(W)(...R))},[Kl,V("span",Gl,le(H.label),1),e(F,{modelValue:H.fixed,"onUpdate:modelValue":R=>H.fixed=R,size:"small",class:"mgr-10"},{default:o(()=>[(u(),T(J,null,te(p,R=>e(y,{key:R.value.toString(),value:R.value},{default:o(()=>[L(le(R.label),1)]),_:2},1032,["value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(b,{modelValue:H.visible,"onUpdate:modelValue":R=>H.visible=R,"inline-prompt":"","active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue","onUpdate:modelValue"])],40,zl))),128)),v.list.length?O("",!0):(u(),C(l,{key:"empty","image-size":120,description:"暂无可以设置的表格列"}))]),_:1})]),_:1},8,["modelValue"])}}}),Ql={class:"the-curd-main-page"},eo={class:"f-vertical mgb-10"},to={key:0,class:"the-tag blue"},lo=V("div",{class:"f1"},null,-1),oo=V("i",{class:"el-icon-arrow-left"},null,-1),ao=V("p",{class:"mgb-10"},"配置筛选相关功能",-1),no=V("p",null,"配置表格相关功能",-1),io={name:"Curd"},fo=ne({...io,props:{data:{type:Object,required:!0},action:{type:Object,required:!0}},setup(r){const n=r,t=oe({loading:!1,editor:{show:!1,type:void 0,form:void 0,action:"add",index:-1},showEntrance:!1}),k=X(()=>{const s=t.editor.type;return s==="search"||!s&&n.data.search.list.length>0});rt(ze,t);let p;function v(s){t.editor.type=s,t.editor.show=!1,t.editor.index=-1,t.showEntrance=!1,p={[s]:ce(n.data[s])}}function f(s){const c=t.editor.type;s&&p&&(n.data[c]=p[c]),t.editor.index=-1,t.editor.show=!1,t.editor.type=void 0,t.editor.form=void 0,p=void 0}function m(){f()}function W(){Je(JSON.stringify(n.data),()=>pe.success("复制成功！"))}function q(s){s==="reset"&&n.data.search.list.forEach(Be),S.pageInfo.currentPage=1,S.selectList=[],Z()}const S=oe({selectList:[],data:[],pageInfo:ct(),formShow:!1,formType:"add",formLoading:!1}),I=X(()=>n.data.table),K=X(()=>I.value.columns.filter(c=>c.visible).map(c=>{const B={...c};return B.cellType==="js"&&B.jsCode&&(B.rawContent=function(D,a){let w="";try{w=new Function("cellValue","row",B.jsCode)(D,a)}catch(d){console.warn("解析 rawContent 代码错误 >>",d),w="-"}return w}),B})),A=X(()=>I.value.actions.map(c=>{const B={...c};return B.key===fe&&(B.click=G),B})),y=X(()=>{const s=[],c=[];return K.value.forEach(B=>{B.slotHead&&s.push(B.slotHead),B.slot&&c.push(B.slot)}),{head:s,cell:c}});function F(s){return I.value.columns.find(B=>B.prop===s)||{}}const b=ge(),l=X(()=>{const s=I.value,c={title:"编辑表单",config:s.formEdit||{}};return S.formType==="add"&&(c.title="新增表单",c.config=s.formAdd||{}),c});let P=null;function H(){var s;P&&((s=b.value)==null||s.setFormData(P))}function G(s){s?(S.formType="edit",P=s):S.formType="add",S.formShow=!0,setTimeout(()=>{var c;return(c=b.value)==null?void 0:c.clear()})}function R(){var s;S.formShow=!1,(s=b.value)==null||s.reset(),P=null}function ae(){var s;(s=b.value)==null||s.validate(async(c,B)=>{if(S.formType==="add"&&n.action.onAdd){S.formLoading=!0;const D=await n.action.onAdd(c,B);if(S.formLoading=!1,D.code!==1)return;R(),Z()}if(S.formType==="edit"&&n.action.onEdit){S.formLoading=!0;const D=await n.action.onEdit(c,B);if(S.formLoading=!1,D.code!==1)return;R(),Z()}})}function E(s){const c=n.data.search.list,B={};for(let d=0;d<c.length;d++){const N=c[d],Y=Ge(N);if(N.required&&Q(Y.result,"string"))return mt(document.querySelector(`.${N.id}`)),pe.error(Y.result),s&&s.key==="page"&&(S.pageInfo=s.before),null;Y.result===!0&&(B[N.key]=Y.value)}const D=I.value.columns,a=[],w=[];return s&&s.key==="sort"?D.forEach(d=>{d.sort&&(d.prop===s.prop?d.sort=s.action:d.sort=!0),d.sort==="asc"&&a.push(d.prop),d.sort==="desc"&&w.push(d.prop)}):D.forEach(d=>{d.sort==="asc"&&a.push(d.prop),d.sort==="desc"&&w.push(d.prop)}),a.length&&(B.asc=a.toString()),w.length&&(B.desc=w.toString()),B}async function Z(s){const c=E(s);if(!c)return;const B=JSON.parse(JSON.stringify(S.pageInfo));t.loading=!0;const D=await n.action.getTableData(c,B);t.loading=!1,D.code===1&&(S.pageInfo.total=D.data.total,S.data=D.data.list||[])}function j(s){const c=S.selectList;switch(s){case"add":G();break;case"delete":if(!c.length)return pe.error("请选择要删除的列表再进行操作~");ye({title:"操作提示",content:`是否删除选中的 ${c.length} 条数据？`,cancelText:"取消",async confirm(){n.action.onDelete?(t.loading=!0,(await n.action.onDelete(JSON.parse(JSON.stringify(S.selectList)))).code===1?(pe.success("删除成功！"),S.selectList=[],Z()):t.loading=!1):pe.info("请设置 action.onDelete 删除逻辑")}});break;case"setting":_();break;case"export":n.action.onExport?n.action.onExport():pe.info("请设置 action.onExport 导出逻辑");break}}function $(s){({exit:()=>f(!0),copy:W,complete:m})[s]()}const i=oe({show:!1});function _(){i.show=!0}function M(s){I.value.columns=s}return vt({formatDate:Ue,copyText:Je,messageBox:ye,message:pe,jsonToPath:pt,request:yt,getData:Z,state:t}),Re(function(){n.action.created&&I.value.columns.length&&n.action.created(Z)}),(s,c)=>{const B=h("base-table"),D=h("base-pagination"),a=h("el-button"),w=h("el-empty"),d=h("base-dialog");return u(),T("div",Ql,[V("section",{class:de([t.editor.show?"f1":"w-full"])},[k.value?(u(),C(Dt,{key:0,data:n.data.search,onSearch:q},null,8,["data"])):O("",!0),t.editor.type==="table"?(u(),C(Tl,{key:1,config:I.value,onAction:$},null,8,["config"])):t.editor.type==="search"?(u(),C(g(Xe),{key:2,onAction:$})):(u(),T(J,{key:3},[I.value.columns.length>0?(u(),T(J,{key:0},[V("div",eo,[I.value.selectKey?(u(),T("span",to," 已选择 "+le(S.selectList.length)+" 条数据 ",1)):O("",!0),lo,e(g(et),{config:I.value,disabled:t.loading,onAction:j},null,8,["config","disabled"])]),e(B,{"select-list":S.selectList,"onUpdate:selectList":c[1]||(c[1]=N=>S.selectList=N),data:S.data,columns:K.value,actions:A.value,actionMax:I.value.actionMax,loading:t.loading,"select-key":I.value.selectKey},Te({_:2},[te(y.value.head,N=>({name:N,fn:o(({$index:Y})=>[e(lt,{column:K.value[I.value.selectKey?Y-1:Y],onSort:c[0]||(c[0]=(z,U)=>Z({key:"sort",prop:z,action:U}))},null,8,["column"])])})),te(y.value.cell,N=>({name:N,fn:o(({row:Y})=>[e(g(Qe),{column:F(N),src:Y[N],previewList:y.value.cell.map(z=>Y[z])},null,8,["column","src","previewList"])])}))]),1032,["select-list","data","columns","actions","actionMax","loading","select-key"]),e(D,{disabled:t.loading,pageInfo:S.pageInfo,onChange:c[2]||(c[2]=N=>Z({key:"page",...N}))},null,8,["disabled","pageInfo"])],64)):(u(),C(w,{key:1,description:"当前页面没有表格配置数据，请配置后再操作~"},{default:o(()=>[e(a,{type:"primary",onClick:c[3]||(c[3]=N=>v("table"))},{default:o(()=>[L("去配置")]),_:1})]),_:1}))],64))],2),e(Rl,{show:t.editor.show,"onUpdate:show":c[4]||(c[4]=N=>t.editor.show=N),config:n.data},null,8,["show","config"]),e(d,{modelValue:S.formShow,"onUpdate:modelValue":c[7]||(c[7]=N=>S.formShow=N),title:l.value.title,width:g(_e)(l.value.config.width),onClose:c[8]||(c[8]=N=>R()),onAfterEnd:c[9]||(c[9]=N=>H())},{footer:o(()=>[e(g($e),{loading:S.formLoading,onClose:c[5]||(c[5]=N=>R()),onSubmit:c[6]||(c[6]=N=>ae())},null,8,["loading"])]),default:o(()=>[e(tt,{ref_key:"formRef",ref:b,config:l.value.config,type:S.formType,disabled:S.formLoading},null,8,["config","type","disabled"])]),_:1},8,["modelValue","title","width"]),e(Xl,{show:i.show,"onUpdate:show":c[10]||(c[10]=N=>i.show=N),columns:I.value.columns,onSubmit:M},null,8,["show","columns"]),!t.showEntrance&&!t.editor.type?(u(),C(a,{key:0,class:"the-curd-entrance",type:"primary",size:"small",onClick:c[11]||(c[11]=N=>t.showEntrance=!0)},{default:o(()=>[oo]),_:1})):O("",!0),e(d,{modelValue:t.showEntrance,"onUpdate:modelValue":c[15]||(c[15]=N=>t.showEntrance=N),title:"请选择配置操作",width:"600px"},{footer:o(()=>[e(a,{onClick:c[14]||(c[14]=N=>t.showEntrance=!1)},{default:o(()=>[L("关 闭")]),_:1})]),default:o(()=>[V("div",{class:"the-curd-entrance-item",onClick:c[12]||(c[12]=N=>v("search"))},[ao,e(g(St))]),V("div",{class:"the-curd-entrance-item",onClick:c[13]||(c[13]=N=>v("table"))},[no,e(g(Ct))])]),_:1},8,["modelValue"])])}}});export{fo as _,Me as a,fe as b,be as c,re as g};
