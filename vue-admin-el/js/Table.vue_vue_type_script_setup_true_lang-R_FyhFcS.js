import{e as X,a6 as Y,E as y,a7 as Z,a8 as ee,N as $,a9 as te}from"./index-C24nMwOO.js";import{d as E,b as P,h as u,i as r,p as B,k as b,j as _,q as L,n as D,x as ae,aC as se,g as m,aA as ne,F as C,G as le,u as p,c as T,ah as ie,m as h,l as oe,C as F,s as V,e as re,t as j,A as de}from"./element-plus-CwxVOKr1.js";const fe={class:"the-pagination f-vertical"},ce={name:"Pagination"},pe=E({...ce,props:{pageInfo:{type:Object,default:()=>X()},pageSizes:{type:Array,default:()=>[10,30,100,200,300]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},position:{type:String,default:"right"},disabled:{type:Boolean,default:!1}},emits:["change"],setup(k,{emit:x}){const t=k,f=x;function S(d){const g=JSON.parse(JSON.stringify(t.pageInfo));t.pageInfo.currentPage=1,t.pageInfo.pageSize=d,f("change",{type:"pageSize",value:d,before:g})}function w(d){const g=JSON.parse(JSON.stringify(t.pageInfo));t.pageInfo.currentPage=d,f("change",{type:"currentPage",value:d,before:g})}return(d,g)=>{const I=P("el-pagination");return r(),u("div",fe,[B("div",{class:D([{f1:["center","right"].includes(t.position)}])},[L(d.$slots,"left")],2),t.pageInfo.total?(r(),b(I,{key:0,background:"",disabled:t.disabled,layout:t.layout,total:t.pageInfo.total,"current-page":t.pageInfo.currentPage,"page-sizes":t.pageSizes,onSizeChange:S,onCurrentChange:w},null,8,["disabled","layout","total","current-page","page-sizes"])):_("",!0),B("div",{class:D([{f1:["center","left"].includes(t.position)}])},[L(d.$slots,"right")],2)])}}}),ue=["id"],ge=["innerHTML"],ye={class:"the-tag blue"},he={name:"Table"},me=E({...he,props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},isRowClick:{type:Boolean,default:!1},actions:{type:Array,default:()=>[]},actionMax:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},selectKey:{type:String,default:void 0},selectList:{type:Array,default:void 0},selectDisabled:{type:Function,default:void 0},pageInfo:{type:Object,default:void 0},pageSizes:{type:Array,default:void 0},sortMultiple:{type:Boolean,default:!1}},emits:["update:selectList","update:pageInfo","row","page","sort"],setup(k,{emit:x}){const t=k,f=x,S=ae(),{adaptive:w,update:d}=Y();se(function(){var e;(e=S.value)==null||e.doLayout(),d()});function g(e,s,n){f("row",e,s,n)}function I(e){return["",null,void 0,"null","undefined"].includes(e)}function q(e){const s=e.prop!==y;return $(e.tooltip,"boolean")?e.tooltip:s}function G(e,s,n){return $(n.formatter,"function")?n.formatter(e,e[s],n):I(e[n.prop])?"-":e[n.prop]}function O(e,s){return $(t.selectDisabled,"function")?!t.selectDisabled(e,s):!0}const K=m(()=>{const e=t.selectList,s=t.selectKey;return e&&s?e.map(n=>n[s]):[]});function z(e){const s=t.selectKey;return K.value.includes(e[s])}const v=m(()=>t.data.filter((e,s)=>O(e,s))),R=m(()=>v.value.length===0),A=m(()=>R.value?!1:v.value.every(e=>z(e))),U=m(()=>A.value?!1:v.value.some(e=>z(e))),H=()=>JSON.parse(JSON.stringify(t.selectList));function W(){if(!t.selectList)return console.warn("选择功能需要绑定 selectList 属性！");const e=t.selectKey,s=v.value.map(i=>i[e]);let n=H();A.value?n=n.filter(i=>!s.includes(i[e])):n=te(n.concat(v.value),(i,c)=>i[e]===c[e]),f("update:selectList",n)}function J(e){if(!t.selectList)return console.warn("选择功能需要绑定 selectList 属性！");const s=t.selectKey,n=K.value;let i=H();n.includes(e[s])?i=i.filter(c=>c[s]!==e[s]):i.push(e),f("update:selectList",i)}const o={fields:[],rules:[]};function M(e,s,n){const i=t.columns,c=[];for(const l of i){const N=l.prop;N===e?l.sort=s:!t.sortMultiple&&l.sort&&(l.sort=!0,o.fields=o.fields.filter(Q=>Q!==l.prop)),l.sort==="asc"&&c.push(N)}typeof s=="string"?o.fields.push(e):s&&(o.fields=o.fields.filter(l=>l!==e)),o.fields=[...new Set(o.fields)];const a={...t.pageInfo||{}};o.fields.length>0?(o.rules=o.fields.map(l=>c.includes(l)?"asc":"desc"),a.sortFields=o.fields.toString(),a.sortRules=o.rules.toString()):(o.rules=[],delete a.sortFields,delete a.sortRules),f("update:pageInfo",a),!n&&f("sort",a,e)}for(const e of t.columns)if(typeof e.sort=="string"&&(M(e.prop,e.sort,!0),!t.sortMultiple))break;return(e,s)=>{const n=P("el-checkbox"),i=P("el-table-column"),c=ne("loading");return r(),u(C,null,[le((r(),u("div",{class:D(["the-table",e.$attrs.class]),id:p(w).id},[T(p(ie),{ref_key:"theTable",ref:S,stripe:"",border:"","max-height":t.maxHeight||p(w).height,data:t.data,onRowClick:g,onSelectionChange:J},{default:h(()=>[t.selectKey?(r(),b(i,{key:0,resizable:!1,width:"55",align:"center",fixed:"left"},{header:h(()=>[T(n,{indeterminate:U.value,"model-value":A.value,disabled:R.value,onChange:W},null,8,["indeterminate","model-value","disabled"])]),default:h(({row:a,$index:l})=>[T(n,{"model-value":z(a),disabled:!O(a,l),onChange:N=>J(a)},null,8,["model-value","disabled","onChange"])]),_:1})):_("",!0),(r(!0),u(C,null,oe(t.columns,a=>(r(),u(C,{key:a.prop},[typeof a.visible!="boolean"||a.visible?(r(),b(i,{key:a.prop,prop:a.prop,label:a.title,"min-width":a.minWidth,width:a.width,"show-overflow-tooltip":q(a),fixed:a.prop===p(y)?"right":a.fixed,align:a.prop===p(y)?"center":a.align,"class-name":k.isRowClick&&a.prop!==p(y)?"the-table-column-click":""},{header:h(l=>[a.slotHead?L(e.$slots,a.slotHead,F(V({key:0},l))):a.prop!==p(y)?(r(),b(ee,{key:1,column:a,disabled:t.loading,onSort:M},null,8,["column","disabled"])):_("",!0)]),default:h(l=>[a.slot?L(e.$slots,a.slot,F(V({key:0},l))):a.prop===p(y)?(r(),b(Z,{key:1,row:l.row,index:l.$index,actions:t.actions,clickStop:t.isRowClick},null,8,["row","index","actions","clickStop"])):a.rawContent?(r(),u("div",{key:2,innerHTML:a.rawContent(l.row[a.prop],l.row)},null,8,ge)):(r(),u(C,{key:3},[re(j(G(l.row,a.prop,a)),1)],64))]),_:2},1032,["prop","label","min-width","width","show-overflow-tooltip","fixed","align","class-name"])):_("",!0)],64))),128))]),_:3},8,["max-height","data"])],10,ue)),[[c,t.loading]]),t.pageInfo?(r(),b(pe,{key:0,class:"mt-[20px]",disabled:t.loading,"page-info":t.pageInfo,"page-sizes":t.pageSizes,onChange:s[0]||(s[0]=a=>f("page",a))},de({_:2},[t.selectList&&t.selectList.length>0?{name:"left",fn:h(()=>[B("span",ye,"已选择："+j(t.selectList.length)+" 条数据",1)]),key:"0"}:void 0]),1032,["disabled","page-info","page-sizes"])):_("",!0)],64)}}});export{me as _};
