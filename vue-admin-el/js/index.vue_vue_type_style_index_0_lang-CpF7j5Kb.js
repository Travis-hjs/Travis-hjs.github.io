import{k,n as U,l as z,f as V}from"./index-vbEJL41-.js";import{H as K,a as R,K as G,h as I,c as h,b as y,F as q,s as C,A as Y,aB as Q,d as F,e as v,y as X,j as D,R as Z,u as T,a1 as ee,ay as te,f as $,l as g,m as ae,C as ne,B as N,t as O,z as le,g as B}from"./element-plus-tNms4ZKJ.js";import{F as oe}from"./index-9t6I7F-j.js";const se="the-curd-state",xe=()=>K(se),ue="action-right",fe="action-edit",De={input:"输入框",textarea:"文本域","input-between":"输入框-串联",select:"下拉框-单选","select-multiple":"下拉框-多选",checkbox:"多选复选框",radio:"单选选择框",switch:"开关切换",date:"日期选择器",cascader:"级联选择器"};let P=0;function A(){return P++,P}function Ye(e){if(e.type=="date"){const t=e.shortcutIndex,l="the-date-shortcut-selected",u=document.querySelector(`.${l}`);if(u&&u.classList.remove(l),k(t,"number"))if(t===-1)e.value=e.shortcutDate;else{const d=re[e.dateType][t].value();e.value=d;const s=`.${e.id} .el-picker-panel__sidebar`,o=document.querySelector(s);o&&G(()=>o.children[t].classList.add(l))}else e.value=["daterange","datetimerange"].includes(e.dateType)?[]:""}else["object","array"].includes(U(e.defaultValue))?e.value=z(e.defaultValue):e.value=e.defaultValue}function Se(e,t="",l){const u=A(),d=Date.now(),s="请输入",o="请选择",i=`field-${e}-${u}-${d}`,b={input:{key:t,id:i,type:"input",value:"",defaultValue:"",placeholder:s,valueType:"string"},textarea:{id:i,value:"",defaultValue:"",type:"textarea",placeholder:s,key:t,valueType:"string"},"input-between":{key:t,id:i,value:["",""],defaultValue:["",""],type:"input-between",placeholder:["请输入范围一","请输入范围二"],separator:"-",valueType:"array"},select:{key:t,id:i,value:"",defaultValue:"",type:"select",placeholder:o,options:[],optionSetting:{label:"",value:""},valueType:"string",joinShow:!1},"select-multiple":{key:t,id:i,value:[],defaultValue:[],type:"select-multiple",placeholder:o,options:[],optionSetting:{label:"",value:""},valueType:"array",joinShow:!1},checkbox:{key:t,id:i,value:[],defaultValue:[],type:"checkbox",placeholder:o,options:[],optionSetting:{label:"",value:""},valueType:"array"},radio:{key:t,id:i,value:"",defaultValue:"",type:"radio",placeholder:o,options:[],optionSetting:{label:"",value:""},valueType:"string"},switch:{key:t,id:i,value:!1,defaultValue:!1,type:"switch",placeholder:"",valueType:"boolean"},date:{key:t,id:i,value:"",type:"date",placeholder:o,dateType:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D",valueType:"string",shortcutIndex:""},cascader:{key:t,id:i,value:[],defaultValue:[],type:"cascader",placeholder:o,options:[],optionSetting:{label:"",value:"",children:""},multiple:!1,checkStrictly:!1,valueType:"array"}}[e];return b.label="",b.required=!1,b}function ke(e,t){return{title:t,prop:e,width:void 0,minWidth:void 0,tooltip:e!==ue,cellType:"text",sort:!1,fixed:!1,iconTips:"",imageWidth:void 0,imageHeight:void 0,jsCode:"",visible:!0}}function Te(){return{width:500,labelWidth:120,labelPosition:"left",fields:[]}}function _e(){return{key:`action-${A()}-${Date.now()}`,text:"",icon:"",click:"",type:"primary"}}function Ve(e){const t={value:e.value,result:!0};if(e.type==="date"){if(!t.value)return t.result=e.placeholder,t;if(["datetimerange","daterange"].includes(e.dateType)){const s=e.value;return s.length<2?(t.result=e.placeholder,t):(t.value=s.map(o=>V(o,e.format)),t)}return t.value=V(e.value,e.format),t}const l=[null,void 0,""];if(e.type==="input-between"){const s=e.value;if(l.includes(s[0]))return t.result=e.placeholder[0],t;if(l.includes(s[1]))return t.result=e.placeholder[1],t;t.value=JSON.parse(JSON.stringify(s))}if(["input","textarea","radio","select"].includes(e.type)&&l.includes(e.value))return t.result=e.placeholder,t;if(["checkbox","select-multiple"].includes(e.type)){const s=e.value;if(!s.length)return t.result=e.placeholder,t;t.value=JSON.parse(JSON.stringify(s))}return t}function Ce(e){if(e)return e=parseInt(e.toString()),e=Math.abs(e),`${e}px`}const Me=[{label:"选择年份",value:"year",formatShow:"YYYY",format:"Y"},{label:"选择年份-月份",value:"month",formatShow:"YYYY-MM",format:"Y-M"},{label:"选择年份-周",value:"week",formatShow:"YYYY年 第ww周",format:"Y-M-D"},{label:"选择年份-月份-日",value:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择年份-月份-日 时:分:秒",value:"datetime",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"},{label:"选择日期范围",value:"daterange",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择日期-时间范围",value:"datetimerange",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"}],E=3600*1e3*24;function f(e=0){const t=new Date;return t.setMonth(new Date().getMonth()-e),t}function _(e=0){const t=new Date,l=E*7*e;return t.setTime(t.getTime()-l),t}const j=[{text:"今天",value:()=>new Date},{text:"昨天",value(){const e=new Date;return e.setTime(e.getTime()-E),e}},{text:"一周前",value:()=>_(1)},{text:"一个月前",value:()=>f(1)},{text:"三个月前",value:()=>f(3)},{text:"半年前",value:()=>f(6)},{text:"一年前",value:()=>f(12)}],L=j.map((e,t)=>{const l=t===0,u=new Date().toLocaleDateString(),d=[new Date(`${u} 00:00:00`),new Date(`${u} 23:59:59`)];return{text:l?"今天内":`${e.text}至今`,value:()=>l?d:[e.value(),new Date]}}),re={year:[{text:"今年",value:()=>new Date},{text:"去年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-1))},{text:"前年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-2))}],month:[{text:"当月",value:()=>new Date},{text:"上月",value:()=>f(1)},{text:"前3个月",value:()=>f(3)},{text:"前6个月",value:()=>f(6)},{text:"前12个月",value:()=>f(12)}],week:[{text:"本周",value:()=>new Date},{text:"上周",value:()=>_(1)},{text:"上2周",value:()=>_(2)},{text:"上3周",value:()=>_(3)},{text:"上4周",value:()=>_(4)}],date:j,datetime:j,daterange:L,datetimerange:L};function Fe(e){const t=window;for(const l in e){const u=`_${l}`;t[u]=e[l]}R(function(){for(const l in e){const u=`_${l}`;t[u]=null}})}function $e(e){return`<b style="color: var(--yellow)"> ${e} </b>`}function ce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Q(e)}function ie(e){return h(q,null,[e.label,h(y("el-tooltip"),{effect:"dark",content:e.tips,"raw-content":!0,placement:"top-start"},{default:()=>[h(y("el-button"),{type:"info",link:!0,style:"height: 32px;"},{default:()=>[h("i",{class:"el-icon-question"},null)]})]})])}const pe=I({props:{attrs:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const l=C({get(){const u=e.attrs.modelValue;return k(u,"array")?u.map(d=>new Date(d)):u&&new Date(u)},set(u){t("change",u)}});return()=>h(y("el-date-picker"),Y({"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},e.attrs,{modelValue:l.value,"onUpdate:modelValue":u=>l.value=u}),null)}}),me=I({props:{attrs:{type:Object,required:!0},field:{type:Object,required:!0}},emits:["change"],setup(e,{emit:t}){const l=C({get(){return e.attrs.modelValue},set(s){t("change",s)}}),u=C(()=>{const s=e.field.optionSetting||{};return{value:s.value||"value",label:s.label||"label"}});function d(s){const o=u.value;return`${s[o.label]||s[o.value]}`}return()=>{let s;return e.field.options.length>36?h(y("el-select-v2"),Y(e.attrs,{options:e.field.options,props:u.value,modelValue:l.value,"onUpdate:modelValue":o=>l.value=o}),{default:({item:o})=>h("span",{title:d(o)},[d(o)])}):h(y("el-select"),Y(e.attrs,{modelValue:l.value,"onUpdate:modelValue":o=>l.value=o}),ce(s=e.field.options.map(o=>h(y("el-option"),{key:o[u.value.value],label:d(o),value:o[u.value.value]},null)))?s:{default:()=>[s]})}}}),de={key:8,class:"tips-box"},he={class:"the-tag blue"},ve=B("i",{class:"el-icon--left el-icon-info"},null,-1),ye={name:"TheFields"},je=I({...ye,props:{type:{type:String,default:"form"},data:{type:Object,required:!0},list:{type:Array,required:!0}},emits:["change"],setup(e,{emit:t}){const l=e,u=t,d=C(()=>l.list.filter(n=>k(n.show,"boolean")?n.show:k(n.show,"function")?n.show():!0));function s(n,r){const c=n.prop,p=l.data;if(c.includes(".")){const S=[null,void 0],w=c.split(".");let a=p;for(const x of w){if(S.includes(a[x]))return;a=a[x]}return a}return p[n.prop]}function o(n,r,c){const p=c||n.prop,S=l.data;if(p.includes(".")){const w=p.split(".");let a=S;for(let x=0;x<w.length-1;x++){const m=w[x];a[m]||(a[m]={}),a=a[m]}a[w[w.length-1]]=r}else S[p]=r}function i(n,r){const c=n.prop,p=r;n.type!=="date"&&o(n,p),n.onChange&&n.onChange(p),u("change",c,p)}function M(n){return n.class||(l.type==="form"?"w-full":"short-value")}function b(n){const r=k(n.disabled,"function")?n.disabled():n.disabled;return{placeholder:n.placeholder,disabled:r,class:M(n),clearable:n.type==="textarea"?void 0:!n.noClear,modelValue:s(n)}}function H(n){const r=n.type==="select-multiple",c=k(n.disabled,"function")?n.disabled():n.disabled,p=n.type==="select-multiple"?n.showAll:!1;return{placeholder:n.placeholder,disabled:c,multiple:r,clearable:!n.noClear,filterable:!0,collapseTags:!p,class:M(n),modelValue:s(n)}}function W(n){const r=["",null,void 0],c=l.data[n.prop];return(r.includes(c)?n.placeholder:c)||"-"}function J(n,r){const c=n.bind;o(n,r),["daterange","datetimerange"].includes(n.dateType)?r?(o(n,V(r[0],n.format),c[0]),o(n,V(r[1],n.format),c[1])):(o(n,void 0,c[0]),o(n,void 0,c[1])):o(n,r?V(r,n.format):void 0,c[0]),i(n,r)}return(n,r)=>{const c=y("el-input"),p=y("el-input-number"),S=y("el-switch"),w=y("el-text");return v(!0),F(q,null,X(d.value,(a,x)=>(v(),D(Z(l.type==="form"?T(ee):T(oe)),{key:a.key||`${a.prop}-${x}`,label:a.label,prop:a.prop,class:"the-fields-item"},te({default:$(()=>[a.type==="input"?(v(),D(c,Y({key:0},b(a),{onInput:m=>i(a,m)}),null,16,["onInput"])):g("",!0),a.type==="textarea"?(v(),D(c,Y({key:1},b(a),{rows:a.rows,"show-word-limit":"",type:"textarea",onInput:m=>i(a,m)}),null,16,["rows","onInput"])):g("",!0),a.type==="number"?(v(),D(p,Y({key:2},b(a),{min:a.min,max:a.max,"controls-position":"right",onInput:m=>i(a,m)}),null,16,["min","max","onInput"])):g("",!0),a.type==="select"||a.type==="select-multiple"?(v(),D(T(me),{key:3,attrs:H(a),field:a,onChange:m=>i(a,m)},null,8,["attrs","field","onChange"])):g("",!0),a.type==="date"?(v(),D(T(pe),{key:4,attrs:{type:a.dateType,format:a.formatShow,...b(a)},onChange:m=>J(a,m)},null,8,["attrs","onChange"])):g("",!0),a.type==="switch"?(v(),D(S,{key:5,"model-value":s(a),"inline-prompt":"","active-text":a.activeText||"是","inactive-text":a.inactiveText||"否","active-value":a.activeValue,"inactive-value":a.inactiveValue,onChange:m=>i(a,m)},null,8,["model-value","active-text","inactive-text","active-value","inactive-value","onChange"])):g("",!0),a.type==="text"?(v(),F("div",{key:6,class:ne(["text-box",a.class||"w-full"])},[h(w,null,{default:$(()=>[N(O(W(a)),1)]),_:2},1024)],2)):g("",!0),a.type==="slot"&&a.slotName?ae(n.$slots,a.slotName,le(Y({key:7},a))):g("",!0),a.tips?(v(),F("div",de,[B("span",he,[ve,N(" "+O(a.tips),1)])])):g("",!0)]),_:2},[a.tooltip?{name:"label",fn:$(()=>[h(T(ie),{label:a.label,tips:a.tooltip},null,8,["label","tips"])]),key:"0"}:void 0]),1032,["label","prop"]))),128)}}});export{je as _,fe as a,ke as b,ue as c,Ce as d,Te as e,De as f,Se as g,Ve as h,Ye as i,$e as j,_e as k,Me as l,Fe as m,se as p,re as s,xe as u};
