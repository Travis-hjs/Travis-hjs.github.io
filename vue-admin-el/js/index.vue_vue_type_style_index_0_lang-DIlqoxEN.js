import{H as at,I as Re,a as nt,d as ne,h as Q,o as ze,b as _,e as s,f as M,k as U,B as we,m as O,F as J,c as e,g as l,C as W,t as le,z as te,u as k,q as Se,aw as Te,n as ce,i as $,N as Ve,j as he,r as oe,w as ge,T as it,K as rt}from"./element-plus-CrjfmyRg.js";import{b as st,F as Ae,a as ut}from"./index-Cfnpuy8A.js";import{g as X,h as Ee,k as se,f as Ue,i as Ye,b as ve,l as De,n as dt,a as pe,u as ct,c as Je,p as pt}from"./index-CbmuVCBi.js";import{v as ft,s as mt}from"./dom-vtHEqTVj.js";import{r as vt}from"./common-sa7TlQ9J.js";const Ke="the-curd-state",Ne=()=>at(Ke),be="action-right",fe="action-edit",de={input:"输入框",textarea:"文本域","input-between":"输入框-串联",select:"下拉框-单选","select-multiple":"下拉框-多选",checkbox:"多选复选框",radio:"单选选择框",switch:"开关切换",date:"日期选择器",cascader:"级联选择器"};let je=0;function Ge(){return je++,je}function Be(r){if(r.type=="date"){const d=r.shortcutIndex,t="the-date-shortcut-selected",T=document.querySelector(`.${t}`);if(T&&T.classList.remove(t),X(d,"number")&&d>=0){const c=Fe[r.dateType][d].value();r.value=c;const a=`.${r.id} .el-picker-panel__sidebar`,v=document.querySelector(a);v&&Re(()=>v.children[d].classList.add(t))}!X(r.value,"array")&&r.valueType==="array"&&(r.value=[])}else["object","array"].includes(Ee(r.defaultValue))?r.value=se(r.defaultValue):r.value=r.defaultValue}function re(r,d="",t){const T=Ge(),c=Date.now(),a="请输入",v="请选择",g=`field-${r}-${T}-${c}`,q={input:{key:d,id:g,type:"input",value:"",defaultValue:"",placeholder:a,valueType:"string"},textarea:{id:g,value:"",defaultValue:"",type:"textarea",placeholder:a,key:d,valueType:"string"},"input-between":{key:d,id:g,value:["",""],defaultValue:["",""],type:"input-between",placeholder:["请输入范围一","请输入范围二"],separator:"-",valueType:"array"},select:{key:d,id:g,value:"",defaultValue:"",type:"select",placeholder:v,options:[],optionSetting:{label:"",value:""},valueType:"string"},"select-multiple":{key:d,id:g,value:[],defaultValue:[],type:"select-multiple",placeholder:v,options:[],optionSetting:{label:"",value:""},valueType:"array"},checkbox:{key:d,id:g,value:[],defaultValue:[],type:"checkbox",placeholder:v,options:[],optionSetting:{label:"",value:""},valueType:"array"},radio:{key:d,id:g,value:"",defaultValue:"",type:"radio",placeholder:v,options:[],optionSetting:{label:"",value:""},valueType:"string"},switch:{key:d,id:g,value:!1,defaultValue:!1,type:"switch",placeholder:"",valueType:"boolean"},date:{key:d,id:g,value:"",type:"date",placeholder:v,dateType:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D",valueType:"string",shortcutIndex:""},cascader:{key:d,id:g,value:[],defaultValue:[],type:"cascader",placeholder:v,options:[],optionSetting:{label:"",value:"",children:""},multiple:!1,checkStrictly:!1,valueType:"array"}}[r];return q.label="",q.required=!1,q}function Me(r,d){return{label:d,prop:r,width:void 0,minWidth:void 0,tooltip:!1,cellType:"text",sort:!1,fixed:!1,iconTips:"",imageWidth:void 0,imageHeight:void 0,jsCode:"",visible:!0}}function Ie(){return{width:500,labelWidth:120,labelPosition:"left",fields:[]}}function Ce(){return{key:`action-${Ge()}-${Date.now()}`,text:"",icon:"",click:"",type:"primary"}}function Ze(r){const d={value:r.value,result:!0};if(r.type==="date"){if(!d.value)return d.result=r.placeholder,d;if(["datetimerange","daterange"].includes(r.dateType)){const a=r.value;return a.length<2?(d.result=r.placeholder,d):(d.value=a.map(v=>Ue(v,r.format)),d)}return d.value=Ue(r.value,r.format),d}const t=[null,void 0,""];if(r.type==="input-between"){const a=r.value;if(t.includes(a[0]))return d.result=r.placeholder[0],d;if(t.includes(a[1]))return d.result=r.placeholder[1],d;d.value=JSON.parse(JSON.stringify(a))}if(["input","textarea","radio","select"].includes(r.type)&&t.includes(r.value))return d.result=r.placeholder,d;if(["checkbox","select-multiple"].includes(r.type)){const a=r.value;if(!a.length)return d.result=r.placeholder,d;d.value=JSON.parse(JSON.stringify(a))}return d}function _e(r){if(r)return r=parseInt(r.toString()),r=Math.abs(r),`${r}px`}const Pe=[{label:"选择年份",value:"year",formatShow:"YYYY",format:"Y"},{label:"选择年份-月份",value:"month",formatShow:"YYYY-MM",format:"Y-M"},{label:"选择年份-周",value:"week",formatShow:"YYYY年 第ww周",format:"Y-M-D"},{label:"选择年份-月份-日",value:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择年份-月份-日 时:分:秒",value:"datetime",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"},{label:"选择日期范围",value:"daterange",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择日期-时间范围",value:"datetimerange",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"}],Xe=3600*1e3*24;function me(r=0){const d=new Date;return d.setMonth(new Date().getMonth()-r),d}function ke(r=0){const d=new Date,t=Xe*7*r;return d.setTime(d.getTime()-t),d}const Oe=[{text:"今天",value:()=>new Date},{text:"昨天",value(){const r=new Date;return r.setTime(r.getTime()-Xe),r}},{text:"一周前",value:()=>ke(1)},{text:"一个月前",value:()=>me(1)},{text:"三个月前",value:()=>me(3)},{text:"半年前",value:()=>me(6)},{text:"一年前",value:()=>me(12)}],He=Oe.map((r,d)=>{const t=d===0,T=new Date().toLocaleDateString(),c=[new Date(`${T} 00:00:00`),new Date(`${T} 23:59:59`)];return{text:t?"今天内":`${r.text}至今`,value:()=>t?c:[r.value(),new Date]}}),Fe={year:[{text:"今年",value:()=>new Date},{text:"去年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-1))},{text:"前年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-2))}],month:[{text:"当月",value:()=>new Date},{text:"上月",value:()=>me(1)},{text:"前3个月",value:()=>me(3)},{text:"前6个月",value:()=>me(6)},{text:"前12个月",value:()=>me(12)}],week:[{text:"本周",value:()=>new Date},{text:"上周",value:()=>ke(1)},{text:"上2周",value:()=>ke(2)},{text:"上3周",value:()=>ke(3)},{text:"上4周",value:()=>ke(4)}],date:Oe,datetime:Oe,daterange:He,datetimerange:He};function yt(r){const d=window;for(const t in r){const T=`_${t}`;d[T]=r[t]}nt(function(){for(const t in r){const T=`_${t}`;d[T]=null}})}function ee(r){return`<b style="color: var(--yellow)"> ${r} </b>`}const gt={name:"Field"},xe=ne({...gt,props:{fieldData:{type:Object,required:!0},editMode:Boolean,readonly:Boolean,disabled:Boolean},emits:["change"],setup(r,{emit:d}){const t=r,T=d;Be(t.fieldData);function c(w){let y=w||t.fieldData.value;X(y,"array")&&(y=se(y)),T("change",y)}const a=Q(()=>t.fieldData),v=Q(()=>{const w=t.fieldData.optionSetting||{};return{value:w.value||"value",label:w.label||"label"}}),g=Q(()=>{const w=t.fieldData;return{multiple:w.multiple,checkStrictly:w.checkStrictly,value:w.optionSetting.value||"value",label:w.optionSetting.label||"label",children:w.optionSetting.children||"children"}});function L(w){const y=a.value.placeholder;return{disabled:t.disabled,readonly:t.readonly,clearable:!0,placeholder:X(w,"number")?y[w]:y}}function q(w){const y=t.fieldData;y.valueType==="number"?(y.value=Ye(w,!0,!0),c(Number(y.value))):(y.value=w,c())}function E(w,y){const F=t.fieldData;F.valueType==="array<number>"?(F.value[y]=Ye(w,!0,!0),c(F.value.map(Z=>Number(Z)))):(F.value[y]=w,c())}const j=["-",".","",null,void 0];function K(){const w=t.fieldData;w.valueType==="number"&&(j.includes(w.value)?w.value="":w.value=Number(w.value))}function A(w){const y=t.fieldData;if(y.valueType==="array<number>"){const F=y.value[w];j.includes(F)?y.value[w]="":y.value[w]=Number(F)}}function b(w){const y=w.type==="select-multiple";return{placeholder:w.placeholder,disabled:t.disabled,multiple:w.type==="select-multiple",clearable:!0,filterable:!0,collapseTags:!0,class:`field-item${y?" is-multiple-select":""}`}}let B=[];const I="the-date-shortcut-selected";function i(){const w=document.querySelector(`.${I}`);w&&w.classList.remove(I),c()}function G(w){w.classList.add(I)}return ze(function(){const w=t.fieldData;if(w.type==="date"){const y=`.${w.id} .el-picker-panel__sidebar`,F=document.querySelector(y);if(!F)return console.warn("找不到日期快捷面板节点！");B=Array.from(F.children),B.forEach(S=>{S.addEventListener("click",()=>G(S))});const Z=w.shortcutIndex;X(Z,"number")&&Z>=0&&G(B[Z])}}),(w,y)=>{const F=_("el-input"),Z=_("el-text"),S=_("el-select-v2"),ae=_("el-option"),Y=_("el-select"),C=_("el-checkbox"),n=_("el-checkbox-group"),V=_("el-radio"),m=_("el-radio-group"),f=_("el-switch"),x=_("el-cascader"),P=_("el-date-picker");return s(),M("div",{class:"the-curd-form-field f-vertical short-value",style:Se({width:k(_e)(a.value.valueWidth)})},[a.value.type==="input"?(s(),U(F,we({key:0,"model-value":a.value.value},L(),{class:"the-curd-field",onInput:q,onBlur:K}),null,16,["model-value"])):O("",!0),a.value.type==="textarea"?(s(),U(F,{key:1,modelValue:a.value.value,"onUpdate:modelValue":y[0]||(y[0]=p=>a.value.value=p),readonly:t.readonly,disabled:t.disabled,autosize:{minRows:2,maxRows:10},placeholder:a.value.placeholder,type:"textarea",class:"the-curd-field",onInput:y[1]||(y[1]=p=>c())},null,8,["modelValue","readonly","disabled","placeholder"])):O("",!0),a.value.type==="input-between"?(s(),M(J,{key:2},[e(F,we({"model-value":a.value.value[0]},L(0),{class:"f1",onInput:y[2]||(y[2]=p=>E(p,0)),onBlur:y[3]||(y[3]=p=>A(0))}),null,16,["model-value"]),e(Z,{style:{padding:"0 6px"}},{default:l(()=>[W(le(a.value.separator),1)]),_:1}),e(F,we({"model-value":a.value.value[1]},L(1),{class:"f1",onInput:y[4]||(y[4]=p=>E(p,1)),onBlur:y[5]||(y[5]=p=>A(1))}),null,16,["model-value"])],64)):O("",!0),a.value.type==="select"||a.value.type==="select-multiple"?(s(),M(J,{key:3},[a.value.options.length>50?(s(),U(S,we({key:0,modelValue:a.value.value,"onUpdate:modelValue":y[6]||(y[6]=p=>a.value.value=p),options:a.value.options,props:a.value.optionSetting},b(a.value),{onChange:y[7]||(y[7]=p=>c())}),null,16,["modelValue","options","props"])):(s(),U(Y,we({key:1,modelValue:a.value.value,"onUpdate:modelValue":y[8]||(y[8]=p=>a.value.value=p)},b(a.value),{onChange:y[9]||(y[9]=p=>c())}),{default:l(()=>[(s(!0),M(J,null,te(a.value.options,p=>(s(),U(ae,{key:p[v.value.value],value:p[v.value.value],label:p[v.value.label]},null,8,["value","label"]))),128))]),_:1},16,["modelValue"]))],64)):O("",!0),a.value.type==="checkbox"?(s(),M(J,{key:4},[e(n,{modelValue:a.value.value,"onUpdate:modelValue":y[10]||(y[10]=p=>a.value.value=p),disabled:t.disabled,onChange:y[11]||(y[11]=p=>c())},{default:l(()=>[(s(!0),M(J,null,te(a.value.options,p=>(s(),U(C,{key:p[v.value.value],value:p[v.value.value]},{default:l(()=>[W(le(p[v.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),t.editMode&&!a.value.options.length?(s(),U(Z,{key:0,type:"primary"},{default:l(()=>[W(le(k(de).checkbox)+"（空数据） ",1)]),_:1})):O("",!0)],64)):O("",!0),a.value.type==="radio"?(s(),M(J,{key:5},[e(m,{modelValue:a.value.value,"onUpdate:modelValue":y[12]||(y[12]=p=>a.value.value=p),disabled:t.disabled,onChange:y[13]||(y[13]=p=>c())},{default:l(()=>[(s(!0),M(J,null,te(a.value.options,p=>(s(),U(V,{key:p[v.value.value],value:p[v.value.value]},{default:l(()=>[W(le(p[v.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),t.editMode&&!a.value.options.length?(s(),U(Z,{key:0,type:"primary"},{default:l(()=>[W(le(k(de).radio)+"（空数据） ",1)]),_:1})):O("",!0)],64)):O("",!0),a.value.type==="switch"?(s(),U(f,{key:6,modelValue:a.value.value,"onUpdate:modelValue":y[14]||(y[14]=p=>a.value.value=p),"inline-prompt":"","active-text":"是","inactive-text":"否",onChange:y[15]||(y[15]=p=>c())},null,8,["modelValue"])):O("",!0),a.value.type==="cascader"?(s(),U(x,{key:7,modelValue:a.value.value,"onUpdate:modelValue":y[16]||(y[16]=p=>a.value.value=p),options:a.value.options,props:g.value,placeholder:a.value.placeholder,disabled:t.disabled,clearable:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",class:"the-curd-field",onChange:y[17]||(y[17]=p=>c())},null,8,["modelValue","options","props","placeholder","disabled"])):O("",!0),a.value.type==="date"?(s(),U(P,{key:8,modelValue:a.value.value,"onUpdate:modelValue":y[18]||(y[18]=p=>a.value.value=p),placeholder:a.value.placeholder,type:a.value.dateType,format:a.value.formatShow,shortcuts:k(Fe)[a.value.dateType],disabled:t.disabled,"popper-class":a.value.id.toString(),"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"the-curd-field",onChange:i},null,8,["modelValue","placeholder","type","format","shortcuts","disabled","popper-class"])):O("",!0)],4)}}}),bt={key:0,class:"el-icon-rank el-icon--left"},ht={style:{"line-height":"1"}},_t={key:0,class:"the-curd-edit-mask f-vertical f-right"},wt=$("i",{class:"el-icon-delete el-icon--left"},null,-1),kt=$("i",{class:"el-icon-edit el-icon--left"},null,-1),xt=$("i",{class:"el-icon-plus"},null,-1),Vt={name:"Search"},Dt=ne({...Vt,props:{data:{type:Object,required:!0}},emits:["search"],setup(r,{emit:d}){const t=r,T=d,c=Ne(),a=Q(()=>c.editor.type==="search"&&!c.editor.show);function v(A){const b=t.data.list[A].label||t.data.list[A].key;ve({title:"操作提示",content:`是否删除【${b}】？`,cancelText:"取消",confirm(){t.data.list.splice(A,1)}})}function g(A){c.editor.index=A,c.editor.action="edit",c.editor.show=!0}function L(A){return c.editor.index===A&&c.editor.type==="search"&&c.editor.show}function q(){c.editor.index=-1,c.editor.action="add",c.editor.show=!0}const{onDragStart:E,onDragMove:j,onDropEnd:K}=De({list:()=>t.data.list,key:"id",findLevel:5});return(A,b)=>{const B=_("el-button"),I=_("el-text");return s(),U(k(ut),{class:"the-curd-search","label-right":t.data.labelRight,"label-width":k(_e)(t.data.labelWidth)||"auto"},Te({content:l(()=>[e(Ve,{name:"the-group",tag:"div",class:"the-filter-content f1"},{default:l(()=>[(s(!0),M(J,null,te(t.data.list,(i,G)=>(s(),U(k(Ae),{key:i.id,"data-key":i.id,class:ce([{"the-curd-selected":L(G)},i.id]),label:i.label,"label-width":k(_e)(i.labelWidth),required:i.required,draggable:a.value,onDragstart:w=>k(E)(G),onDragover:w=>k(j)(w,G),onDrop:b[0]||(b[0]=w=>k(K)())},Te({default:l(()=>[e(xe,{"field-data":i,disabled:k(c).loading},null,8,["field-data","disabled"]),a.value?(s(),M("div",_t,[e(B,{link:"",type:"danger",onClick:w=>v(G)},{default:l(()=>[wt,W(" 删除 ")]),_:2},1032,["onClick"]),e(B,{link:"",type:"success",onClick:w=>g(G)},{default:l(()=>[kt,W(" 编辑 ")]),_:2},1032,["onClick"])])):O("",!0)]),_:2},[k(c).editor.type==="search"?{name:"label",fn:l(()=>[a.value?(s(),M("i",bt)):O("",!0),$("span",ht,le(i.label),1)]),key:"0"}:void 0]),1032,["data-key","class","label","label-width","required","draggable","onDragstart","onDragover"]))),128)),a.value?(s(),U(k(Ae),{key:0},{default:l(()=>[t.data.list.length?O("",!0):(s(),U(I,{key:0,type:"info",style:{"margin-right":"12px"}},{default:l(()=>[W(" 请添加筛选条件~ ")]),_:1})),e(B,{type:"primary",circle:"",onClick:b[1]||(b[1]=i=>q())},{default:l(()=>[xt]),_:1})]),_:1})):O("",!0)]),_:1})]),_:2},[k(c).editor.type?void 0:{name:"right",fn:l(()=>[e(k(st),{loading:k(c).loading,onSearch:b[2]||(b[2]=i=>T("search",i))},null,8,["loading"])]),key:"0"}]),1032,["label-right","label-width"])}}});function Qe(r){const d=r.onAction||(()=>{});return e(J,null,[e(_("el-button"),{link:!0,onClick:()=>d("exit")},{default:()=>[W("退出编辑")]}),e(_("el-button"),{type:"success",plain:!0,onClick:()=>d("copy")},{default:()=>[e("i",{class:"el-icon-document-copy el-icon--left"},null),W("复制JSON")]}),e(_("el-button"),{type:"primary",onClick:()=>d("complete")},{default:()=>[W("完成编辑")]})])}function $e(r){const d=r.onClose||(()=>{}),t=r.onSubmit||(()=>{});return e(J,null,[e(_("el-button"),{onClick:d},{default:()=>[W("取 消")]}),e(_("el-button"),{type:"primary",loading:r.loading,disabled:r.disabledSubmit,onClick:t},{default:()=>[W("确 认")]})])}function $t(r){const d={};return r.imageWidth&&(d.width=`${r.imageWidth}px`),r.imageHeight&&(d.height=`${r.imageHeight}px`),d}function et(r){function d(){dt({urls:r.previewList?r.previewList:[r.src]})}return r.column.cellType==="image"?e(_("el-image"),{class:"the-table-image",style:$t(r.column),src:r.src,onClick:d,fit:"cover"},null):null}function ye(r){return e(J,null,[r.label,e(_("el-tooltip"),{effect:"dark",content:r.tips,"raw-content":!0,placement:"top-start"},{default:()=>[e(_("el-button"),{type:"info",link:!0,style:"height: 32px;"},{default:()=>[e("i",{class:"el-icon-question"},null)]})]})])}function tt(r){const d=r.onAction||(()=>{}),t=r.config,T=!!t.selectKey,c=t.formAdd&&t.formAdd.fields.length>0,a=t.formEdit&&t.formEdit.fields.length>0,v={on:"el-icon-success",off:"el-icon-remove-outline"},g=[{type:"delete",text:T?"修改删除":"配置删除",icon:T?v.on:v.off,style:T?"primary":"info"},{type:"add",text:c?"修改新增表单":"配置新增表单",icon:c?v.on:v.off,style:c?"primary":"info"},{type:"edit",text:a?"修改编辑表单":"配置编辑表单",icon:a?v.on:v.off,style:a?"primary":"info"}];return e("div",null,[r.editMode?e(J,null,[g.map(L=>e(_("el-button"),{type:L.style,link:!0,onClick:()=>d(L.type)},{default:()=>[e("i",{class:`el-icon--left ${L.icon}`},null),L.text]}))]):e(J,null,[T?e(_("el-button"),{type:"danger",link:!0,disabled:r.disabled,onClick:()=>d("delete")},{default:()=>[e("i",{class:"el-icon--left el-icon-delete"},null),W("删除")]}):null,c?e(_("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>d("add")},{default:()=>[e("i",{class:"el-icon--left el-icon-plus"},null),W("新增")]}):null,e(_("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>d("export")},{default:()=>[e("i",{class:"el-icon--left el-icon-download"},null),W("导出")]}),e(_("el-tooltip"),{effect:"dark",content:"配置表格展示、排序等操作",placement:"top-end"},{default:()=>[e(_("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>d("setting")},{default:()=>[e("i",{class:"el-icon--left el-icon-setting"},null),W("设置")]})]})])])}function St(){const r=Array.from({length:6}).map((d,t)=>({id:t}));return e("div",{class:"the-thumbnail-search flex"},[e("div",{class:"the-thumbnail-search-content f1"},[r.map(d=>e("div",{key:d.id,class:"the-thumbnail-search-item"},null))]),e("div",{class:"the-thumbnail-search-btn f-vertical"},[e("i",{class:"el-icon-search"},null)])])}function Ct(){return e("section",{class:"the-thumbnail-table"},[e("svg",{width:280,height:180,viewBox:`0 0 ${280*1} ${180*1}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","data-v-d2b0a988":"",class:"the-thumbnail-table-svg"},[e("rect",{width:280,height:180,fill:""},null),e("g",{filter:"url(#filter0_d_13550_224439)"},[e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V132C215 133.105 214.105 134 213 134H67C65.8954 134 65 133.105 65 132V60Z",fill:"var(--el-fill-color-blank)"},null),e("path",{d:"M67 57.7C65.7297 57.7 64.7 58.7297 64.7 60V132C64.7 133.27 65.7297 134.3 67 134.3H213C214.27 134.3 215.3 133.27 215.3 132V60C215.3 58.7297 214.27 57.7 213 57.7H67Z",stroke:"var(--el-border-color-dark)","stroke-width":.6*1},null)]),[76,92,108,124].map((T,c)=>e("rect",{key:c,x:71*1,y:T*1,width:16*1,height:4*1,rx:2*1,fill:"var(--el-color-primary)"},null)),[107,143,197].map((T,c)=>[76,92,108,124].map((a,v)=>e("rect",{key:`${c}-${v}`,x:T*1,y:a*1,width:c===2?12*1:20*1,height:4*1,rx:2*1,fill:"var(--el-border-color-dark)"},null))),e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V70H65V60Z",fill:"var(--el-border-color-light)"},null),[71,107,143,199].map(T=>e("rect",{key:T,x:T*1,y:63*1,width:10*1,height:2*1,rx:1*1,fill:"var(--el-border-color-dark)"},null)),[85.75,101.75,117.75].map((T,c)=>e("line",{key:c,x1:65*1,y1:T*1,x2:215*1,y2:T*1,stroke:"var(--el-border-color-light)","stroke-width":.5*1},null)),e("defs",null,[e("filter",{id:"filter0_d_13550_224439",x:"51.0666",y:"44.0671",width:177.867*1,height:103.866*1,filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},[e("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"},null),e("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"},null),e("feOffset",null,null),e("feGaussianBlur",{stdDeviation:6.66667*1},null),e("feComposite",{in2:"hardAlpha",operator:"out"},null),e("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"},null),e("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_13550_224439"},null),e("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_13550_224439",result:"shape"},null)])])])])}const Tt={key:0,class:"el-icon-rank el-icon--left",style:{"line-height":"32px"}},Et={class:"f-vertical w-full"},Ut=$("i",{class:"el-icon-edit"},null,-1),Mt=$("i",{class:"el-icon-delete"},null,-1),Ot={key:1},Nt=$("i",{class:"el-icon--left el-icon-delete"},null,-1),Bt=$("i",{class:"el-icon--left el-icon-finished"},null,-1),Ft=$("i",{class:"el-icon--left el-icon-plus"},null,-1),Lt={name:"TableForm"},lt=ne({...Lt,props:{config:{type:Object,default:()=>Ie()},type:{type:String},editMode:{type:Boolean},disabled:{type:Boolean}},emits:["change"],setup(r,{expose:d,emit:t}){const T=r,c=t,a=he(),v=Ie(),g=oe({config:v,form:{},rules:{}}),L=Ne(),q=Q(()=>T.type==="add"?"新增":"编辑"),E=Q(()=>L.editor.show);function j(Y){i(),L.editor.action=Y>=0?"edit":"add",L.editor.form=g.config,L.editor.index=Y,L.editor.show=!0}function K(Y){const C=g.config.fields;i(),ve({title:"操作提示",content:`是否删除【${C[Y].label}】？`,cancelText:"取消",confirm(){C.splice(Y,1)}})}function A(){ve({title:"操作提示",content:`是否移除【${q.value}】表单？移除后将不会出现对应功能按钮。`,cancelText:"取消",confirm(){g.config.fields=[]}})}function b(){c("change")}function B(){const Y=T.type==="add"?"编辑":"新增";ve({title:"操作提示",content:`是否将表单数据同步到【${Y}】表单？`,cancelText:"不同步",confirmText:"同步",cancel(){c("change",g.config)},confirm(){c("change",g.config,!0)}})}function I(Y){var C;(C=a.value)==null||C.validate(n=>{if(n&&Y){const V=S.value,m={};ae.value.forEach(f=>{m[f.key]=V[f.key]}),Y(V,m)}})}function i(){var Y;(Y=a.value)==null||Y.clearValidate()}function G(){g.config.fields.forEach(Be)}function w(Y){g.config.fields.forEach(C=>{if(Object.prototype.hasOwnProperty.call(Y,C.key)){const n=Y[C.key];if(!n)return;switch(C.type){case"date":X(n,"array")?C.value=n.map(V=>new Date(V)):C.value=new Date(n);break;default:C.value=n;break}}})}const{onDragStart:y,onDragMove:F,onDropEnd:Z}=De({list:()=>g.config.fields,key:"id",findLevel:10});ge(()=>T.config,function(Y){Y&&(g.config=se(Y))},{immediate:!0}),ge(()=>g.config.fields,function(Y){const C={},n={},V=["input","input-between","textarea"];Y&&Y.forEach(m=>{C[m.key]=m.value,m.required&&(n[m.key]=[{required:!0,validator(f,x,P){const p=[void 0,null,""];if(m.type==="input-between"&&!m.value[0]&&!m.value[1]){P(new Error("请输入两个范围字段"));return}if(m.valueType==="array"&&!m.value.length){P(new Error(m.placeholder||"请选择"));return}if(m.valueType!=="boolean"&&p.includes(m.value)){const o=V.includes(m.type)?"请输入内容":"请选择";P(new Error(m.placeholder||o));return}P()},trigger:V.includes(m.type)?"blur":"change"}])}),g.form=C,g.rules=n,setTimeout(i)},{immediate:!0});const S=Q(()=>{const Y={};return g.config.fields.forEach(C=>{Y[C.key]=Ze(C).value}),Y}),ae=Q(()=>g.config.fields.filter(Y=>{const C=Y.show;if(!C)return!0;if(X(C,"function"))return C(S.value);if(C.includes("return"))try{return new Function("formData",C)(S.value)}catch(n){console.warn("解析表单展示逻辑代码错误 >>",n)}return!0}));return d({clear:i,validate:I,reset:G,setFormData:w}),(Y,C)=>{const n=_("el-button"),V=_("el-form-item"),m=_("el-empty"),f=_("el-form");return s(),U(f,{ref_key:"formRef",ref:a,model:g.form,rules:g.rules,labelWidth:k(_e)(g.config.labelWidth),labelPosition:g.config.labelPosition,disabled:T.disabled,style:Se(T.editMode?{width:k(_e)(g.config.width)}:null),class:ce([{"is-edit-form":T.editMode}])},{default:l(()=>[T.editMode?(s(),M(J,{key:0},[e(Ve,{name:"the-group",tag:"div"},{default:l(()=>[(s(!0),M(J,null,te(g.config.fields,(x,P)=>(s(),U(V,{class:ce([{"the-curd-selected":k(L).editor.index===P&&E.value}]),prop:x.key,key:x.id,"data-key":x.id,draggable:g.config.fields.length>1&&!k(L).editor.show?!0:null,onDragstart:p=>k(y)(P),onDragover:p=>k(F)(p,P),onDrop:k(Z)},{label:l(()=>[g.config.fields.length>1&&!k(L).editor.show?(s(),M("i",Tt)):O("",!0),$("span",null,le(x.label),1)]),default:l(()=>[$("div",Et,[e(xe,{class:"mgr-10",fieldData:x,editMode:""},null,8,["fieldData"]),e(n,{link:"",type:"success",disabled:E.value,onClick:p=>j(P)},{default:l(()=>[Ut]),_:2},1032,["disabled","onClick"]),e(n,{link:"",type:"danger",disabled:E.value,onClick:p=>K(P)},{default:l(()=>[Mt]),_:2},1032,["disabled","onClick"])])]),_:2},1032,["class","prop","data-key","draggable","onDragstart","onDragover","onDrop"]))),128))]),_:1}),g.config.fields.length?O("",!0):(s(),U(m,{key:0,description:`当前没有表单项，当没有表单项时【${q.value}】功能按钮不会出现~`},null,8,["description"])),E.value?O("",!0):(s(),M("div",Ot,[e(n,{link:"",onClick:C[0]||(C[0]=x=>b())},{default:l(()=>[W(" 退出编辑 ")]),_:1}),e(n,{type:"danger",link:"",disabled:!g.config.fields.length,onClick:C[1]||(C[1]=x=>A())},{default:l(()=>[Nt,W(" 删除表单 ")]),_:1},8,["disabled"]),e(n,{type:"success",link:"",onClick:C[2]||(C[2]=x=>B())},{default:l(()=>[Bt,W(" 完成表单 ")]),_:1}),e(n,{type:"primary",link:"",onClick:C[3]||(C[3]=x=>j(-1))},{default:l(()=>[Ft,W(" 添加一项 ")]),_:1})]))],64)):O("",!0),!T.editMode&&g.config&&g.config.fields?(s(!0),M(J,{key:1},te(ae.value,x=>(s(),U(V,{label:x.label,prop:x.key,key:x.id},{default:l(()=>[e(xe,{fieldData:x},null,8,["fieldData"])]),_:2},1032,["label","prop"]))),128)):O("",!0)]),_:1},8,["model","rules","labelWidth","labelPosition","disabled","style","class"])}}}),Wt={key:1,class:"f-vertical w-full"},qt=$("i",{class:"el-icon--right el-icon-question the-tips-icon"},null,-1),At={key:1,class:"f1 f-right"},Yt={name:"TableHeader"},ot=ne({...Yt,props:{column:{type:Object,required:!0}},emits:["sort"],setup(r,{emit:d}){const t=r,T=d,c=Q(()=>!t.column.sort&&!t.column.iconTips),a={true:{index:0,icon:"el-icon-sort"},asc:{index:1,icon:"el-icon-sort-up"},desc:{index:2,icon:"el-icon-sort-down"}},v=[!0,"asc","desc"];function g(){const L=t.column.sort.toString();let q=a[L].index;q++,q>=v.length&&(q=0);const E=v[q];T("sort",t.column.prop,E)}return(L,q)=>{const E=_("el-tooltip"),j=_("el-button");return c.value?(s(),M(J,{key:0},[W(le(t.column.label),1)],64)):(s(),M("div",Wt,[$("span",null,le(t.column.label),1),t.column.iconTips?(s(),U(E,{key:0,effect:"dark",content:t.column.iconTips,placement:"top"},{default:l(()=>[qt]),_:1},8,["content"])):O("",!0),t.column.sort?(s(),M("div",At,[e(j,{link:"",onClick:g},{default:l(()=>[$("i",{class:ce(["el-icon--right",a[t.column.sort.toString()].icon])},null,2)]),_:1})])):O("",!0)]))}}}),Jt={name:"TableColumnConfig"},jt=ne({...Jt,props:{show:{type:Boolean,required:!0},type:{type:String,required:!0},keys:{type:Array,required:!0},form:Object},emits:["update:show","submit"],setup(r,{emit:d}){const t=r,T=d,c=oe({show:!1,form:Me("","")}),a=Q(()=>`${t.type==="add"?"新增":"编辑"}表格列`),v=he(),g={label:{required:!0,message:"请输入表格列标题",trigger:"blur"},prop:{required:!0,validator(A,b,B){b?t.keys.includes(c.form.prop)?B(new Error("已经存在相同的值！")):B():B(new Error("输入字段不能为空！"))},trigger:"blur"},jsCode:{required:!0,validator(A,b,B){b?b.includes("return")?B():B(new Error('代码片段必须带有返回字段 "return"')):B(new Error("代码片段不能为空！"))},trigger:"blur"}},L=[{label:"默认普通文本",value:"text"},{label:"图片预览组件",value:"image"},{label:"自定义 js 代码",value:"js"}],q=[{label:"不可排序",value:!1},{label:"可排序",value:!0},{label:"默认升序",value:"asc"},{label:"默认降序",value:"desc"}],E=`
<p>函数代码片段：</p>
<p>第一个参数${ee("cellValue")}是表格值;</p>
<p>第二个参数${ee("row")}是完整对象;</p>
<p>例如：${ee("return cellValue + row.id;")};</p>
<p>也可以是HTML：${ee("return `html 标签`")};</p>
`;function j(){T("update:show",!1)}function K(){var A;(A=v.value)==null||A.validate(b=>{if(!b)return;const B=se(c.form);["width","minWidth","imageWidth","imageHeight"].forEach(i=>{B[i]&&(B[i]=Number(B[i]))}),B.cellType==="image"&&(B.slot=B.prop),(B.sort||B.iconTips)&&(B.slotHead=`header-${B.prop}`),T("submit",B),j()})}return ge(()=>t.show,function(A){c.show=A,A&&(t.type==="add"?c.form=Me("",""):c.form=se(t.form),setTimeout(()=>{var b;return(b=v.value)==null?void 0:b.clearValidate()}))},{immediate:!0}),(A,b)=>{const B=_("el-input"),I=_("el-form-item"),i=_("el-input-number"),G=_("el-option"),w=_("el-select"),y=_("el-switch"),F=_("el-form"),Z=_("base-dialog");return s(),U(Z,{modelValue:c.show,"onUpdate:modelValue":b[11]||(b[11]=S=>c.show=S),title:a.value,width:"580px",onClose:j},{footer:l(()=>[e(k($e),{onClose:j,onSubmit:K})]),default:l(()=>[e(F,{ref_key:"formRef",ref:v,model:c.form,rules:g,"label-position":"right","label-width":"130px"},{default:l(()=>[e(I,{label:"表格列标题",prop:"label"},{default:l(()=>[e(B,{modelValue:c.form.label,"onUpdate:modelValue":b[0]||(b[0]=S=>c.form.label=S),clearable:"",placeholder:g.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(I,{label:"表格列键值",prop:"prop"},{default:l(()=>[e(B,{modelValue:c.form.prop,"onUpdate:modelValue":b[1]||(b[1]=S=>c.form.prop=S),clearable:"",placeholder:"请输入表格列键值"},null,8,["modelValue"])]),_:1}),e(I,{label:"表格列宽度",prop:"width"},{default:l(()=>[e(i,{modelValue:c.form.width,"onUpdate:modelValue":b[2]||(b[2]=S=>c.form.width=S),class:"w-full","controls-position":"right",placeholder:"请输入表格列宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(I,{label:"表格列最小宽度",prop:"minWidth"},{default:l(()=>[e(i,{modelValue:c.form.minWidth,"onUpdate:modelValue":b[3]||(b[3]=S=>c.form.minWidth=S),class:"w-full","controls-position":"right",placeholder:"请输入表格列最小宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(I,{label:"表格列展示类型",prop:"cellType"},{default:l(()=>[e(w,{modelValue:c.form.cellType,"onUpdate:modelValue":b[4]||(b[4]=S=>c.form.cellType=S)},{default:l(()=>[(s(),M(J,null,te(L,S=>e(G,{key:S.value,value:S.value,label:S.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),c.form.cellType==="image"?(s(),M(J,{key:0},[e(I,{label:"图片宽度(像素)",prop:"imageWidth"},{default:l(()=>[e(i,{modelValue:c.form.imageWidth,"onUpdate:modelValue":b[5]||(b[5]=S=>c.form.imageWidth=S),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1}),e(I,{label:"图片高度(像素)",prop:"imageHeight"},{default:l(()=>[e(i,{modelValue:c.form.imageHeight,"onUpdate:modelValue":b[6]||(b[6]=S=>c.form.imageHeight=S),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1})],64)):O("",!0),c.form.cellType==="js"?(s(),U(I,{key:1,prop:"jsCode"},{label:l(()=>[e(k(ye),{label:"js代码",tips:E})]),default:l(()=>[e(B,{modelValue:c.form.jsCode,"onUpdate:modelValue":b[7]||(b[7]=S=>c.form.jsCode=S),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1})):O("",!0),e(I,{label:"表格列排序操作",prop:"sort"},{default:l(()=>[e(w,{modelValue:c.form.sort,"onUpdate:modelValue":b[8]||(b[8]=S=>c.form.sort=S)},{default:l(()=>[(s(),M(J,null,te(q,S=>e(G,{key:S.value.toString(),value:S.value,label:S.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(I,{label:"内容溢出截断",prop:"tooltip"},{default:l(()=>[e(y,{modelValue:c.form.tooltip,"onUpdate:modelValue":b[9]||(b[9]=S=>c.form.tooltip=S),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(I,{label:"表头图标提示文字",prop:"iconTips"},{default:l(()=>[e(B,{modelValue:c.form.iconTips,"onUpdate:modelValue":b[10]||(b[10]=S=>c.form.iconTips=S),clearable:"",placeholder:"请输入表头图标提示文字"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),It=$("p",{class:"mgb-10"},"表格数据中的字段，例如表格数：",-1),Pt=$("p",{class:"mgb-10"},"则键值可以为 id",-1),Ht=$("p",null,[$("i",{class:"el-icon-info el-icon--left"}),W(" 不填则没有删除功能 ")],-1),Rt={name:"TableDeleteConfig"},zt=ne({...Rt,props:{show:{type:Boolean,default:!1},selectKey:{type:String,default:""}},emits:["update:show","submit"],setup(r,{emit:d}){const t=r,T=d,c='[{ id: 1, name: "名称", status: 2 }]',a=oe({show:!1,keyword:""});function v(){T("update:show",!1)}function g(){v(),T("submit",a.keyword)}return ge(()=>t.show,function(L){a.show=L,L&&(a.keyword=t.selectKey||"")},{immediate:!0}),(L,q)=>{const E=_("el-input"),j=_("el-form-item"),K=_("el-form"),A=_("base-dialog");return s(),U(A,{modelValue:a.show,"onUpdate:modelValue":q[1]||(q[1]=b=>a.show=b),title:"配置表格删除功能",width:"400px",onClose:v},{footer:l(()=>[e(k($e),{onClose:v,onSubmit:g})]),default:l(()=>[e(K,{labelPosition:"right",labelWidth:"120px"},{default:l(()=>[e(j,{label:"数据键值"},{default:l(()=>[e(E,{class:"mgb-10",modelValue:a.keyword,"onUpdate:modelValue":q[0]||(q[0]=b=>a.keyword=b),placeholder:"请输入数据键值",clearable:""},null,8,["modelValue"]),$("div",{class:"the-tag blue"},[It,$("p",{class:"mgb-10"},le(c)),Pt,Ht])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Kt={class:"flex"},Gt={class:"f1"},Zt={class:"f-vertical w-full"},Xt={class:"f-right w-full"},Qt=$("i",{class:"el-icon--left el-icon-finished"},null,-1),el=$("i",{class:"el-icon--left el-icon-plus"},null,-1),tl=["data-key","draggable","onDragstart","onDragover"],ll={key:0,class:"el-icon--left el-icon-rank"},ol=$("div",{class:"f1"},null,-1),al=$("i",{class:"el-icon-delete"},null,-1),nl=$("i",{class:"el-icon-edit"},null,-1),il={key:1,class:"w-full f-right"},rl=$("i",{class:"el-icon--left el-icon-plus"},null,-1),sl={name:"TableActionConfig"},ul=ne({...sl,props:{show:{type:Boolean,default:!1},list:{type:Array,required:!0},columnWidth:{type:Number},actionMax:{type:Number}},emits:["update:show","submit"],setup(r,{emit:d}){const t=r,T=d,c=he(),a=he(),v=oe({show:!1,list:[],index:-1,hasEdit:!1,formEdit:!1}),g=oe({btn:Ce(),column:{width:160,max:3}}),L={width:{required:!0,message:"请输入表格列宽度，例如：160",trigger:"blur"},max:{required:!1,message:"请输入数量，超出用“更多”下拉展示",trigger:"blur"}},q={text:{required:!0,message:"请输入按钮文字",trigger:"blur"},click:{required:!0,message:"请输入按钮操作代码",trigger:"blur"},icon:{required:!1,message:"请输入图标 class",trigger:"blur"},type:{required:!1,message:"请选择按钮类型",trigger:"change"}};function E(){T("update:show",!1)}function j(){a.value.validate(C=>{if(!C)return;E();const{width:n,max:V}=g.column;T("submit",se(v.list),n,V)})}function K(C){c.value.validate(n=>{if(!n)return;const V=se(g.btn);C==="add"?v.list.push(V):v.list[v.index]=g.btn,A()})}function A(){v.index=-1,g.btn=Ce(),v.formEdit=!1,setTimeout(()=>{var C;return(C=c.value)==null?void 0:C.clearValidate()})}function b(C){const n=v.list[C];g.btn=JSON.parse(JSON.stringify(n)),v.index=C,v.formEdit=!0}function B(C){v.list.splice(C,1)}ge(()=>t.show,function(C){v.show=C,C&&(v.list=se(t.list),v.hasEdit=v.list.some(n=>n.key===fe),v.index=-1,g.btn=Ce(),g.column={width:t.columnWidth,max:t.actionMax},setTimeout(()=>{var n,V;(n=c.value)==null||n.clearValidate(),(V=a.value)==null||V.clearValidate()}))},{immediate:!0});const I=[{label:"默认（蓝色）",value:"primary"},{label:"成功（绿色）",value:"success"},{label:"警告（橙色）",value:"warning"},{label:"危险（红色）",value:"danger"},{label:"文本（灰色）",value:"info"}],i="https://element.eleme.cn/#/zh-CN/component/icon",{onDragStart:G,onDragMove:w,onDropEnd:y}=De({list:()=>v.list,key:"key"});function F(C){if(C.key!=fe&&v.list.length>1&&v.index===-1)return!0}function Z(C){const n=C.text;if(X(n,"string")){if(!n.includes("return"))return n;let V="文字配置有误";try{V=new Function("row",n)({})}catch(m){console.warn("解析按钮文字代码错误 >>",m)}return V}return X(n,"function")?n({}):"未设置按钮"}const S=`
<p>可以输入代码片段，</p>
<p>以${ee("return")}关键字为函数标记，</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>例如：${ee('return row.status === 1 ? "下架" : "上架";')}</p>
`,ae=`
<p>函数代码片段，点击的时候运行</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>第二个参数${ee("index")}是当前索引</p>
<p>例如：${ee("console.log(row, index);")}</p>
`,Y=`
<p>可以输入代码片段，</p>
<p>以${ee("return")}关键字为函数标记，</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>例如：${ee("return row.status === 1;")}返回布尔值进行判断</p>
`;return(C,n)=>{const V=_("el-text"),m=_("el-divider"),f=_("el-input-number"),x=_("el-form-item"),P=_("el-form"),p=_("el-input"),o=_("el-option"),h=_("el-select"),u=_("el-button"),R=_("el-popconfirm"),H=_("el-empty"),z=_("base-dialog");return s(),U(z,{modelValue:v.show,"onUpdate:modelValue":n[13]||(n[13]=N=>v.show=N),title:"配置操作列按钮功能",width:"880px",onClose:E},{footer:l(()=>[e(k($e),{disabledSubmit:v.formEdit,onClose:E,onSubmit:j},null,8,["disabledSubmit"])]),default:l(()=>[$("div",Kt,[$("section",Gt,[e(m,{"content-position":"left","border-style":"dashed"},{default:l(()=>[e(V,{type:"info"},{default:l(()=>[W("操作列配置")]),_:1})]),_:1}),e(P,{ref_key:"formColumn",ref:a,model:g.column,rules:L,labelPosition:"right",labelWidth:"128px"},{default:l(()=>[e(x,{label:"操作列宽度",prop:"width"},{default:l(()=>[e(f,{modelValue:g.column.width,"onUpdate:modelValue":n[0]||(n[0]=N=>g.column.width=N),class:"w-full","controls-position":"right",placeholder:L.width.message},null,8,["modelValue","placeholder"])]),_:1}),e(x,{label:"操作按钮限制",prop:"max"},{default:l(()=>[e(f,{modelValue:g.column.max,"onUpdate:modelValue":n[1]||(n[1]=N=>g.column.max=N),class:"w-full","controls-position":"right",min:2,placeholder:L.max.message},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),e(m,{"content-position":"left","border-style":"dashed"},{default:l(()=>[e(V,{type:"info"},{default:l(()=>[W("操作按钮配置")]),_:1})]),_:1}),e(P,{ref_key:"formBtn",ref:c,model:g.btn,rules:q,labelPosition:"right",labelWidth:"128px",class:ce({"the-filter-mask":!v.formEdit}),"data-tips":"待新增或编辑操作"},{default:l(()=>[e(x,{prop:"text"},{label:l(()=>[e(k(ye),{label:"按钮文字",tips:S})]),default:l(()=>[e(p,{modelValue:g.btn.text,"onUpdate:modelValue":n[2]||(n[2]=N=>g.btn.text=N),type:"textarea",placeholder:q.text.message},null,8,["modelValue","placeholder"])]),_:1}),e(x,{prop:"click"},{label:l(()=>[e(k(ye),{label:"按钮功能代码",tips:ae})]),default:l(()=>[e(p,{modelValue:g.btn.click,"onUpdate:modelValue":n[3]||(n[3]=N=>g.btn.click=N),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1}),e(x,{prop:"show"},{label:l(()=>[e(k(ye),{label:"按钮显示条件",tips:Y})]),default:l(()=>[e(p,{modelValue:g.btn.show,"onUpdate:modelValue":n[4]||(n[4]=N=>g.btn.show=N),type:"textarea",placeholder:"请输入条件代码，为空则默认显示"},null,8,["modelValue"])]),_:1}),e(x,{prop:"disabled"},{label:l(()=>[e(k(ye),{label:"按钮禁用条件",tips:Y})]),default:l(()=>[e(p,{modelValue:g.btn.disabled,"onUpdate:modelValue":n[5]||(n[5]=N=>g.btn.disabled=N),type:"textarea",placeholder:"请输入条件代码，为空则默认不禁用"},null,8,["modelValue"])]),_:1}),e(x,{label:"按钮图标",prop:"icon"},{default:l(()=>[$("div",Zt,[e(p,{modelValue:g.btn.icon,"onUpdate:modelValue":n[6]||(n[6]=N=>g.btn.icon=N),placeholder:q.icon.message,clearable:""},null,8,["modelValue","placeholder"]),e(V,{type:"primary",style:{width:"110px","text-align":"right"}},{default:l(()=>[$("a",{href:i,target:"_blank"},"去官网复制")]),_:1})])]),_:1}),e(x,{label:"按钮类型",prop:"type"},{default:l(()=>[e(h,{modelValue:g.btn.type,"onUpdate:modelValue":n[7]||(n[7]=N=>g.btn.type=N),placeholder:q.type.message},{default:l(()=>[(s(),M(J,null,te(I,N=>e(o,{key:N.value,value:N.value,label:N.label},null,8,["value","label"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1}),e(x,null,{default:l(()=>[$("div",Xt,[e(u,{onClick:n[8]||(n[8]=N=>A())},{default:l(()=>[W("取 消")]),_:1}),v.index>-1?(s(),U(u,{key:0,type:"primary",plain:"",onClick:n[9]||(n[9]=N=>K("edit"))},{default:l(()=>[Qt,W(" 确认修改 ")]),_:1})):(s(),U(u,{key:1,type:"primary",plain:"",onClick:n[10]||(n[10]=N=>K("add"))},{default:l(()=>[el,W(" 确认新增 ")]),_:1}))])]),_:1})]),_:1},8,["model","class"])]),e(Ve,{name:"the-group",tag:"div",class:"the-curd-option-list f1"},{default:l(()=>[(s(!0),M(J,null,te(v.list,(N,ie)=>(s(),M("div",{class:ce(["the-curd-option-item f-vertical",{"the-curd-selected":ie===v.index}]),key:N.key,"data-key":N.key!==k(fe)?N.key:null,draggable:F(N),onDragstart:ue=>k(G)(ie),onDragover:ue=>k(w)(ue,ie),onDrop:n[11]||(n[11]=(...ue)=>k(y)&&k(y)(...ue))},[v.index===-1&&N.key!==k(fe)?(s(),M("i",ll)):O("",!0),e(u,{type:N.type,link:""},{default:l(()=>[N.icon?(s(),M("i",{key:0,class:ce(["el-icon--left",N.icon])},null,2)):O("",!0),W(" "+le(Z(N)),1)]),_:2},1032,["type"]),ol,N.key===k(fe)?(s(),U(V,{key:1,type:"info",size:"small"},{default:l(()=>[W("编辑按钮不可删除、拖拽等操作，且处于首位")]),_:1})):(s(),M(J,{key:2},[e(R,{width:"186px",title:"是否删除该按钮功能？",onConfirm:ue=>B(ie)},{reference:l(()=>[e(u,{link:"",type:"danger",disabled:v.index>-1},{default:l(()=>[al]),_:1},8,["disabled"])]),_:2},1032,["onConfirm"]),e(u,{link:"",type:"success",onClick:ue=>b(ie)},{default:l(()=>[nl]),_:2},1032,["onClick"])],64))],42,tl))),128)),v.list.length?O("",!0):(s(),U(H,{key:"empty","image-size":120,description:"请添加操作列功能按钮"})),v.formEdit?O("",!0):(s(),M("div",il,[v.formEdit?O("",!0):(s(),U(u,{key:0,type:"primary",plain:"",onClick:n[12]||(n[12]=N=>v.formEdit=!0)},{default:l(()=>[rl,W(" 新增功能按钮 ")]),_:1}))]))]),_:1})])]),_:1},8,["modelValue"])}}}),dl={class:"the-curd-table-model the-curd-scrollbar"},cl=["data-key","draggable","onDragstart","onDragover"],pl={class:"fake-table-head f-vertical"},fl=$("i",{class:"el-icon-rank el-icon--left"},null,-1),ml={class:"fake-table-cell"},vl=$("i",{class:"el-icon-edit"},null,-1),yl=$("i",{class:"el-icon-delete"},null,-1),gl={class:"fake-table-cell f-vertical"},bl={key:1,class:"the-tag blue"},hl=$("div",{class:"fake-table-head fvc"},"操作",-1),_l={class:"fake-table-cell",style:{"text-align":"center"}},wl=$("i",{class:"el-icon-setting"},null,-1),kl=$("i",{class:"el-icon-delete"},null,-1),xl={class:"fake-table-cell"},Vl={class:"f-vertical",key:"fixed"},Dl=$("i",{class:"el-icon-plus el-icon--left"},null,-1),$l={key:0},Sl=$("i",{class:"el-icon-plus el-icon--left"},null,-1),Cl={name:"TableModel"},Tl=ne({...Cl,props:{config:{type:Object,required:!0}},emits:["action"],setup(r,{emit:d}){const t=r,T=d,c="https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",a=oe({show:!1,type:"add",index:-1,form:void 0,keys:[]}),v=Q(()=>{const n=t.config.columns,V=[],m=[];for(let f=0;f<n.length;f++){const x=n[f];x.prop===be?m.push(x):V.push(x)}return{drag:V,action:m}});function g(n,V){if(a.keys=t.config.columns.map(m=>m.prop),n==="edit"){const m=t.config.columns[V];a.keys=a.keys.filter(f=>f!==m.prop),a.index=V,a.form=m}else a.form=void 0;a.type=n,a.show=!0}function L(n){const V=t.config;if(a.type==="add"){const m=JSON.parse(JSON.stringify(v.value.drag));m.push(n),V.columns=m.concat(v.value.action)}else V.columns[a.index]=n}function q(n){const V=v.value.drag[n];ve({title:"操作提示",content:`是否删除【${V.label}】列？`,cancelText:"取消",confirm(){const m=t.config.columns.findIndex(f=>f.prop===V.prop);t.config.columns.splice(m,1)}})}const{onDragStart:E,onDragMove:j,onDropEnd:K}=De({list:()=>t.config.columns,key:"prop",findLevel:5});function A(n){const V={};return n&&n.width&&(V.width=`${n.width}px`),n&&n.minWidth&&(V.minWidth=`${n.minWidth}px`),V}const b=Q(()=>{const n=t.config.columns;if(n.length>0&&n[n.length-1].prop===be)return n[n.length-1]});function B(){const n=Me(be,"操作");n.minWidth=120,n.width=160,t.config.columns.push(n)}function I(){const n=t.config.columns;ve({title:"操作提示",content:"是否删除操作列？删除之后需要重新配置。",cancelText:"取消",confirm(){n.splice(n.length-1,1),t.config.actions=[],t.config.formEdit&&(t.config.formEdit=void 0)}})}const i=oe({show:!1,keyword:""});function G(){const n=t.config.selectKey;i.keyword=n?n.toString():"",i.show=!0}function w(n){t.config.selectKey=n}const y=oe({show:!1,columnWidth:0,actionMax:0});function F(){y.show=!0,y.columnWidth=b.value.width,y.actionMax=t.config.actionMax}function Z(n,V){t.config.actions=n;const m=t.config.columns.find(f=>f.prop===be);m.width=V}const S=oe({show:!1,form:null,type:"add"});function ae(n){S.type=n,n==="add"&&t.config.formAdd&&(S.form=t.config.formAdd),n==="edit"&&t.config.formEdit&&(S.form=t.config.formEdit),S.show=!0}function Y(n,V){const m=t.config,f=m.actions;function x(){const P=f.length>0&&f[0].key===fe;n&&n.fields.length>0?(b.value||B(),P||f.unshift({key:fe,text:"编辑",type:"success",icon:"el-icon-edit"})):P&&f.splice(0,1)}n&&(S.type==="add"?(m.formAdd=n,V&&(m.formEdit=JSON.parse(JSON.stringify(n)),x())):(m.formEdit=n,V&&(m.formAdd=JSON.parse(JSON.stringify(n))),x())),S.show=!1,S.form=null}function C(n){switch(n){case"delete":G();break;case"add":ae("add");break;case"edit":ae("edit");break}}return(n,V)=>{const m=_("el-empty"),f=_("el-button"),x=_("el-tooltip"),P=_("base-table-actions"),p=_("el-text");return s(),M(J,null,[S.show?O("",!0):(s(),U(k(tt),{key:0,class:"mgb-10 w-full",editMode:!0,config:t.config,onAction:C},null,8,["config"])),$("div",dl,[S.show?(s(),U(lt,{key:0,config:S.form,type:S.type,editMode:!0,onChange:Y},null,8,["config","type"])):(s(),U(Ve,{key:1,name:"the-group",tag:"div",class:"fake-table"},{default:l(()=>[t.config.columns.length?O("",!0):(s(),U(m,{key:"empty",style:{padding:"10px 40px"},"image-size":120,description:"请添加表格列"})),(s(!0),M(J,null,te(v.value.drag,(o,h)=>(s(),M("div",{key:o.prop,"data-key":o.prop,class:"fake-table-item",draggable:v.value.drag.length>1,style:Se(A(o)),onDragstart:u=>k(E)(h),onDragover:u=>k(j)(u,h),onDrop:V[0]||(V[0]=u=>k(K)())},[$("div",pl,[fl,e(ot,{column:o},null,8,["column"])]),$("div",ml,[e(f,{circle:"",plain:"",type:"success",size:"small",onClick:u=>g("edit",h)},{default:l(()=>[vl]),_:2},1032,["onClick"]),e(f,{circle:"",plain:"",type:"danger",size:"small",onClick:u=>q(h)},{default:l(()=>[yl]),_:2},1032,["onClick"])]),$("div",gl,[o.cellType==="text"?(s(),M(J,{key:0},[W("文本内容")],64)):o.cellType==="js"?(s(),M("span",bl,"自定义代码")):O("",!0),e(k(et),{column:o,src:c},null,8,["column"])])],44,cl))),128)),b.value?(s(),M("div",{style:Se(A(b.value)),key:k(be),class:"fake-table-item"},[hl,$("div",_l,[e(x,{effect:"dark",content:"配置【操作按钮】和【操作列】的宽度",placement:"top"},{default:l(()=>[e(f,{circle:"",plain:"",type:"primary",size:"small",onClick:V[1]||(V[1]=o=>F())},{default:l(()=>[wl]),_:1})]),_:1}),e(f,{circle:"",plain:"",type:"danger",size:"small",onClick:V[2]||(V[2]=o=>I())},{default:l(()=>[kl]),_:1})]),$("div",xl,[t.config.actions.length?(s(),U(P,{key:0,row:{},index:1,actions:t.config.actions},null,8,["actions"])):(s(),U(p,{key:1,type:"info"},{default:l(()=>[W("待添加操作~")]),_:1}))])],4)):O("",!0),$("div",Vl,[$("div",null,[$("p",null,[e(f,{type:"primary",text:"",onClick:V[3]||(V[3]=o=>g("add"))},{default:l(()=>[Dl,W(" 添加内容列 ")]),_:1})]),b.value?O("",!0):(s(),M("p",$l,[e(f,{type:"primary",text:"",onClick:V[4]||(V[4]=o=>B())},{default:l(()=>[Sl,W(" 添加操作列 ")]),_:1})]))])])]),_:1}))]),S.show?O("",!0):(s(),U(k(Qe),{key:1,type:S.type,onAction:V[5]||(V[5]=o=>T("action",o))},null,8,["type"])),e(jt,{show:a.show,"onUpdate:show":V[6]||(V[6]=o=>a.show=o),type:a.type,keys:a.keys,form:a.form,onSubmit:L},null,8,["show","type","keys","form"]),e(zt,{show:i.show,"onUpdate:show":V[7]||(V[7]=o=>i.show=o),"select-key":i.keyword,onSubmit:w},null,8,["show","select-key"]),e(ul,{show:y.show,"onUpdate:show":V[8]||(V[8]=o=>y.show=o),columnWidth:y.columnWidth,actionMax:y.actionMax,list:t.config.actions,onSubmit:Z},null,8,["show","columnWidth","actionMax","list"])],64)}}}),El={class:"the-curd-example"},Ul={name:"Example"},Ml=ne({...Ul,props:{selected:{type:String},type:{type:String}},emits:["choose"],setup(r,{emit:d}){const t=r,T=d,c=[{...re("input"),placeholder:de.input},{...re("select"),placeholder:de.select},{...re("select-multiple"),placeholder:de["select-multiple"]},{...re("cascader"),placeholder:de.cascader},{...re("date"),placeholder:de.date},{...re("checkbox"),options:[{label:"多选-A",value:1},{label:"多选-B",value:2}],defaultValue:[1]},{...re("radio"),options:[{label:"单选-A",value:"radio-1"},{label:"单选-B",value:"radio-2"}],defaultValue:"radio-1"},{...re("switch"),defaultValue:!0},{...re("textarea"),placeholder:de.textarea},{...re("input-between"),placeholder:["范围区间操作","范围区间操作"]}],a=["radio","checkbox","textarea","switch"],v=Q(()=>t.type==="search"?c.filter(g=>!a.includes(g.type)):c);return(g,L)=>(s(),M("div",El,[(s(!0),M(J,null,te(v.value,q=>(s(),U(xe,{key:q.type,"field-data":q,class:ce(["the-curd-example-item fvc",{"the-curd-selected":t.selected===q.type}]),readonly:"",onClick:E=>T("choose",q.type)},null,8,["field-data","class","onClick"]))),128))]))}}),Ol={key:0,class:"the-curd-editor-content"},Nl=$("h2",{class:"the-title mgb-20"},"基础设置",-1),Bl={class:"f-vertical f-between mgb-20"},Fl=$("h2",{class:"the-title"},"第1步：点击选取组件",-1),Ll={class:"f-vertical mgb-20"},Wl={class:"the-title"},ql=$("div",{class:"f1"},null,-1),Al={key:0,class:"the-curd-target-box"},Yl=$("i",{class:"el-icon-question the-tips-icon mgl-10"},null,-1),Jl=$("a",{href:"https://www.json.cn/",target:"_blank"}," JSON编辑工具 ",-1),jl={class:"f-right"},Il=$("i",{class:"el-icon--left el-icon-plus"},null,-1),Pl=$("i",{class:"el-icon--left el-icon-edit"},null,-1),Hl={name:"Editor"},Rl=ne({...Hl,props:{show:{type:Boolean,default:!1},config:{type:Object,required:!0}},emits:["update:show"],setup(r,{emit:d}){const t=r,T=d;function c(){T("update:show",!1)}const a=["checkbox","radio","switch"],v=["select","select-multiple","radio","checkbox","cascader"],g=["input","textarea","select","radio"],L=["input-between","select-multiple","checkbox","cascader"],q=["input","select","radio"],E=["daterange","datetimerange"],j=q.concat(L),K=`<p>参考 src/utils/index.ts 中的${ee("formatDate")}函数</p>`,A=`
<p>动态表单项的条件显示逻辑函数；</p>
<p>返回${ee("false")}则不展示对应项；</p>
<p>函数有一个参数：${ee("formData")}为当前表单的数据值；</p>
<p>以${ee("return")}为函数代码片段标记；</p>
<p>例如：${ee("return formData.type !== 2")}</p>
`,b=Ne(),B=Q(()=>b.editor.action==="add"),I=Q(()=>{let p=[];return i.formData&&i.formData.type==="date"&&(p=Fe[i.formData.dateType].map((h,u)=>({label:h.text,value:u}))),p.unshift({label:"将预览组件中的值设为默认",value:-1}),p}),i=oe({step:0,formData:void 0});function G(p){i.step=p}const w={label:{required:!0,message:"请输入功能标题",trigger:"blur"},key:{required:!0,trigger:"blur",validator(p,o,h){o?x.includes(o)?h(new Error("当前键值已经被占用！")):h():h(new Error("绑定的键值不能为空"))}},format:{required:!0,message:"格式化规则不能为空",trigger:"blur"},separator:{required:!0,message:"请输入串联符号",trigger:"blur"},defaultValue:{required:!0,trigger:"blur",validator(p,o,h){const u=ae();u===!0?h():h(new Error(u)),h()}},options:{required:!0,trigger:"blur",validator(p,o,h){const u=Y();u===!0?h():h(new Error(u))}}},y=he(),F=oe({options:"",defaultValue:""});function Z(p){p.type!=="date"&&(F.defaultValue=JSON.stringify({value:p.defaultValue})),v.includes(p.type)&&(F.options=JSON.stringify(p.options))}function S(p){var u;const o=b.editor,h=re(p,"",o.type==="search");i.formData=h,Z(h),(u=y.value)==null||u.clearValidate(),G(1)}function ae(){const p='输入的格式必须为 { "value": "input value" }',o=F.defaultValue;if(!o)return p;const h=i.formData.type,u=i.formData.valueType,R=de[h];try{const H=JSON.parse(o);if(!X(H,"object"))return p;if(h==="switch"&&!X(H.value,"boolean"))return`${R}的绑定值应该为 boolean 类型`;if(L.includes(h)){if(!X(H.value,"array"))return`${R}的绑定值应该为 array 类型`;if(u==="array<number>"&&H.value.some(z=>z!==""&&!X(z,"number")))return"数组中只能出现数字"}if(g.includes(h)&&!["string","number"].includes(Ee(H.value)))return`${R}的绑定值应该为 string/number 类型`;if(h==="date"){const z=i.formData;if(E.includes(z.dateType)){if(!X(H.value,"array"))return"范围日期绑定值应该为 array 类型"}else if(!X(H.value,"string"))return"日期类型绑定值应该为 string 类型"}if(q.includes(h)&&u==="number"&&H.value!==""&&!X(H.value,"number"))return`${R}的绑定值应该为 number 类型`}catch(H){return console.warn("checkDefaultValue >>",H),p}return!0}function Y(){const p=F.options;if(!p)return"选项数据不能为空！";try{const o=JSON.parse(p);if(!X(o,"array"))return"选项数据格式不正确，需要为数组类型！";const h=i.formData,u=h.optionSetting.value||"value",R=[void 0,null];for(let H=0;H<o.length;H++){const z=o[H];if(!X(z,"object"))return"数组项必须为对象！";if(R.includes(z[u]))return`数组项的值不能为${R.join("/")}`;if(["array<number>","number"].includes(h.valueType)&&!X(z[u],"number")&&z[u]!=="")return"数组项的值必须为 number 类型"}return!0}catch(o){return console.warn("checkOptions >>",o),"不合法的JSON,注意使用双引号,结尾不能为逗号等"}}function C(){Y()===!0&&(i.formData.options=JSON.parse(F.options))}function n(){if(ae()===!0){const o=i.formData,h=JSON.parse(F.defaultValue).value;o.type!=="date"&&(o.defaultValue=h)}}function V(p){const o=Pe.find(u=>u.value===p),h=i.formData;h.shortcutIndex="",E.includes(o.value)?(h.value=[],h.valueType="array"):(h.value="",h.valueType="string"),h.formatShow=o.formatShow,h.format=o.format}function m(p){return/^[+-]?(\d|([1-9]\d+))(\.\d+)?$/.test(p)}function f(){var p;(p=y.value)==null||p.validate(o=>{if(ft("#the-editor-form",o),!o)return;n(),v.includes(i.formData.type)&&C();const h=b.editor,u=JSON.parse(JSON.stringify(i.formData));if(v.includes(u.type)&&C(),u.valueType||(u.valueType=Ee(u.defaultValue)),v.includes(u.type)&&["number","array<number>"].includes(u.valueType)){let H=u.optionSetting.value;H||(H="value",u.optionSetting.value=H);for(let z=0;z<u.options.length;z++){const N=u.options[z],ie=N[H];if([null,void 0].includes(ie))return pe.error("数据值字段与选项数据不匹配，请检查！");if(m(ie.toString()))N[H]=Number(ie);else{const ue=N[u.optionSetting.label];return pe.error(`选项数据中【${ue}】的值应该为数字！`)}}}u.type==="date"&&!X(u.shortcutIndex,"number")&&(u.value=u.valueType==="array"?[]:""),{search(H){H?t.config.search.list.push(u):t.config.search.list[h.index]=u},table(H){if(H){const z=JSON.parse(JSON.stringify(h.form.fields));z.push(u),h.form.fields=z}else{const z=JSON.parse(JSON.stringify(h.form.fields));z[h.index]=u,h.form.fields=z}}}[h.type](B.value),c()})}let x=[];function P(p){const o=b.editor;x=[],{search(){x=t.config.search.list.map(u=>u.key)},table(){x=o.form.fields.map(u=>u.key)}}[o.type](),p&&(x=x.filter(u=>u!==p))}return ge(()=>t.show,function(p){if(!p){i.formData=void 0;return}const o=b.editor;if(o.action==="add")i.step=0,i.formData=void 0,P();else{const h=o.index;({search(){i.formData=JSON.parse(JSON.stringify(t.config.search.list[h]))},table(){var R;i.formData=JSON.parse(JSON.stringify((R=o.form)==null?void 0:R.fields[h]))}})[o.type](),Z(i.formData),P(i.formData.key),i.step=1}}),(p,o)=>{const h=_("el-input-number"),u=_("el-form-item"),R=_("el-switch"),H=_("el-form"),z=_("el-button"),N=_("el-input"),ie=_("el-text"),ue=_("el-tooltip"),Le=_("el-option"),We=_("el-select");return s(),M("section",{class:ce(["the-curd-editor the-curd-scrollbar",{"is-show":t.show}])},[e(it,{name:"the-curd-editor-move"},{default:l(()=>{var qe;return[t.show?(s(),M("div",Ol,[Nl,e(H,{"label-position":"right","label-width":"120px"},{default:l(()=>[k(b).editor.type==="search"?(s(),M(J,{key:0},[e(u,{label:"整体标题宽度"},{default:l(()=>[e(h,{modelValue:t.config.search.labelWidth,"onUpdate:modelValue":o[0]||(o[0]=D=>t.config.search.labelWidth=D),class:"w-full","controls-position":"right",placeholder:"例如：120px"},null,8,["modelValue"])]),_:1}),e(u,{label:"标题靠右对齐"},{default:l(()=>[e(R,{modelValue:t.config.search.labelRight,"onUpdate:modelValue":o[1]||(o[1]=D=>t.config.search.labelRight=D),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):O("",!0),k(b).editor.type==="table"&&k(b).editor.form?(s(),M(J,{key:1},[e(u,{label:"表单宽度"},{default:l(()=>[e(h,{modelValue:k(b).editor.form.width,"onUpdate:modelValue":o[2]||(o[2]=D=>k(b).editor.form.width=D),class:"w-full","controls-position":"right",placeholder:"请输入宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"文字宽度"},{default:l(()=>[e(h,{modelValue:k(b).editor.form.labelWidth,"onUpdate:modelValue":o[3]||(o[3]=D=>k(b).editor.form.labelWidth=D),class:"w-full","controls-position":"right",placeholder:"请输入标题宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(u,{label:"文字靠右排版"},{default:l(()=>[e(R,{modelValue:k(b).editor.form.labelPosition,"onUpdate:modelValue":o[4]||(o[4]=D=>k(b).editor.form.labelPosition=D),"inline-prompt":"","active-value":"right","inactive-value":"left","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):O("",!0)]),_:1}),i.step===0?(s(),M(J,{key:0},[$("div",Bl,[Fl,e(z,{link:"",type:"primary",onClick:o[5]||(o[5]=D=>c())},{default:l(()=>[W("退出编辑")]),_:1})]),e(Ml,{selected:(qe=i.formData)==null?void 0:qe.type,type:k(b).editor.type,onChoose:S},null,8,["selected","type"])],64)):O("",!0),i.step===1?(s(),M(J,{key:1},[$("div",Ll,[$("h2",Wl,"第2步：配置"+le(k(de)[i.formData.type]),1),ql,e(z,{link:"",type:"success",onClick:o[6]||(o[6]=D=>G(0))},{default:l(()=>[W("上一步")]),_:1}),e(z,{link:"",type:"primary",onClick:o[7]||(o[7]=D=>c())},{default:l(()=>[W("退出编辑")]),_:1})]),i.formData?(s(),M("div",Al,[e(xe,{"field-data":i.formData,"edit-mode":""},null,8,["field-data"])])):O("",!0),i.formData?(s(),U(H,{key:1,id:"the-editor-form",ref_key:"formRef",ref:y,model:i.formData,rules:w,"label-position":"right","label-width":"128px"},{default:l(()=>[e(u,{label:"组件标题",prop:"label"},{default:l(()=>[e(N,{modelValue:i.formData.label,"onUpdate:modelValue":o[8]||(o[8]=D=>i.formData.label=D),clearable:"",placeholder:w.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(u,{label:"绑定的键值",prop:"key"},{default:l(()=>[e(N,{modelValue:i.formData.key,"onUpdate:modelValue":o[9]||(o[9]=D=>i.formData.key=D),clearable:"",placeholder:"请输入绑定的键值"},null,8,["modelValue"])]),_:1}),e(u,{label:"标题宽度",prop:"labelWidth"},{default:l(()=>[e(h,{modelValue:i.formData.labelWidth,"onUpdate:modelValue":o[10]||(o[10]=D=>i.formData.labelWidth=D),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：120"},null,8,["modelValue"])]),_:1}),a.includes(i.formData.type)?O("",!0):(s(),U(u,{key:0,label:"组件宽度",prop:"valueWidth"},{default:l(()=>[e(h,{modelValue:i.formData.valueWidth,"onUpdate:modelValue":o[11]||(o[11]=D=>i.formData.valueWidth=D),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：140"},null,8,["modelValue"])]),_:1})),e(u,{label:"提示/规则文字",prop:"placeholder"},{default:l(()=>[i.formData.type==="input-between"?(s(),M(J,{key:0},[e(N,{modelValue:i.formData.placeholder[0],"onUpdate:modelValue":o[12]||(o[12]=D=>i.formData.placeholder[0]=D),class:"f1",clearable:"",placeholder:"请输入提示-1"},null,8,["modelValue"]),e(ie,{style:{padding:"0 6px"}},{default:l(()=>[W("-")]),_:1}),e(N,{modelValue:i.formData.placeholder[1],"onUpdate:modelValue":o[13]||(o[13]=D=>i.formData.placeholder[1]=D),class:"f1",clearable:"",placeholder:"请输入提示-2"},null,8,["modelValue"])],64)):(s(),U(N,{key:1,modelValue:i.formData.placeholder,"onUpdate:modelValue":o[14]||(o[14]=D=>i.formData.placeholder=D),clearable:"",placeholder:"请输入规则提示/输入框提示文字"},null,8,["modelValue"]))]),_:1}),e(u,{label:"是否必填",prop:"required"},{default:l(()=>[e(R,{modelValue:i.formData.required,"onUpdate:modelValue":o[15]||(o[15]=D=>i.formData.required=D),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),k(j).includes(i.formData.type)?(s(),U(u,{label:"绑定值为数字类型",key:"is-number"},{default:l(()=>[L.includes(i.formData.type)?(s(),U(R,{key:0,modelValue:i.formData.valueType,"onUpdate:modelValue":o[16]||(o[16]=D=>i.formData.valueType=D),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"array<number>","inactive-value":"array"},null,8,["modelValue"])):(s(),U(R,{key:1,modelValue:i.formData.valueType,"onUpdate:modelValue":o[17]||(o[17]=D=>i.formData.valueType=D),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"number","inactive-value":"string"},null,8,["modelValue"])),v.includes(i.formData.type)?(s(),U(ue,{key:2,effect:"dark",content:"设为数字类型之后，将会在保存时校验选项数据",placement:"top"},{default:l(()=>[Yl]),_:1})):O("",!0)]),_:1})):O("",!0),i.formData.type!=="date"?(s(),U(u,{key:2,label:"组件默认值",prop:"defaultValue"},{default:l(()=>[e(N,{modelValue:F.defaultValue,"onUpdate:modelValue":o[18]||(o[18]=D=>F.defaultValue=D),type:"textarea",clearable:"",placeholder:"请输入JSON，值为 value",onBlur:o[19]||(o[19]=D=>n())},null,8,["modelValue"])]),_:1})):O("",!0),i.formData.type==="input-between"?(s(),U(u,{key:3,label:"串联符号",prop:"separator"},{default:l(()=>[e(N,{modelValue:i.formData.separator,"onUpdate:modelValue":o[20]||(o[20]=D=>i.formData.separator=D),clearable:"",placeholder:w.separator.message},null,8,["modelValue","placeholder"])]),_:1})):O("",!0),v.includes(i.formData.type)?(s(),M(J,{key:4},[e(u,{label:"选项数据",prop:"options"},{default:l(()=>[e(N,{modelValue:F.options,"onUpdate:modelValue":o[21]||(o[21]=D=>F.options=D),type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"请输入数组JSON",style:{"margin-bottom":"4px"},onBlur:o[22]||(o[22]=D=>C())},null,8,["modelValue"]),e(z,{link:"",type:"primary"},{default:l(()=>[Jl]),_:1})]),_:1}),e(u,{label:"数据展示字段",prop:"optionSetting.label"},{default:l(()=>[e(N,{modelValue:i.formData.optionSetting.label,"onUpdate:modelValue":o[23]||(o[23]=D=>i.formData.optionSetting.label=D),clearable:"",placeholder:"不填则使用 label"},null,8,["modelValue"])]),_:1}),e(u,{label:"数据值字段",prop:"optionSetting.value"},{default:l(()=>[e(N,{modelValue:i.formData.optionSetting.value,"onUpdate:modelValue":o[24]||(o[24]=D=>i.formData.optionSetting.value=D),clearable:"",placeholder:"不填则使用 value"},null,8,["modelValue"])]),_:1}),i.formData.type==="cascader"?(s(),M(J,{key:0},[e(u,{label:"下级字段",prop:"optionSetting.children"},{default:l(()=>[e(N,{modelValue:i.formData.optionSetting.children,"onUpdate:modelValue":o[25]||(o[25]=D=>i.formData.optionSetting.children=D),clearable:"",placeholder:"不填则使用 children"},null,8,["modelValue"])]),_:1}),e(u,{label:"是否多选",prop:"multiple"},{default:l(()=>[e(R,{modelValue:i.formData.multiple,"onUpdate:modelValue":o[26]||(o[26]=D=>i.formData.multiple=D),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(u,{label:"允许只选中某一项",prop:"checkStrictly"},{default:l(()=>[e(R,{modelValue:i.formData.checkStrictly,"onUpdate:modelValue":o[27]||(o[27]=D=>i.formData.checkStrictly=D),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):O("",!0)],64)):O("",!0),i.formData.type==="date"?(s(),M(J,{key:5},[e(u,{label:"日期类型",prop:"dateType"},{default:l(()=>[e(We,{modelValue:i.formData.dateType,"onUpdate:modelValue":o[28]||(o[28]=D=>i.formData.dateType=D),class:"w-full",onChange:V},{default:l(()=>[(s(!0),M(J,null,te(k(Pe),D=>(s(),U(Le,{key:D.value,label:D.label,value:D.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"日期默认值",prop:"shortcutIndex"},{default:l(()=>[e(We,{modelValue:i.formData.shortcutIndex,"onUpdate:modelValue":o[29]||(o[29]=D=>i.formData.shortcutIndex=D),class:"w-full",placeholder:"请选择",clearable:""},{default:l(()=>[(s(!0),M(J,null,te(I.value,D=>(s(),U(Le,{key:D.value,label:D.label,value:D.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{prop:"format"},{label:l(()=>[e(k(ye),{label:"格式化规则",tips:K})]),default:l(()=>[e(N,{modelValue:i.formData.format,"onUpdate:modelValue":o[30]||(o[30]=D=>i.formData.format=D),clearable:"",placeholder:w.format.message},null,8,["modelValue","placeholder"])]),_:1})],64)):O("",!0),k(b).editor.type==="table"?(s(),U(u,{key:6,prop:"show"},{label:l(()=>[e(k(ye),{label:"表单显示逻辑",tips:A})]),default:l(()=>[e(N,{modelValue:i.formData.show,"onUpdate:modelValue":o[31]||(o[31]=D=>i.formData.show=D),type:"textarea",placeholder:"请输入条件代码，为空则默认展示"},null,8,["modelValue"])]),_:1})):O("",!0),$("div",jl,[e(z,{onClick:o[32]||(o[32]=D=>c())},{default:l(()=>[W("关闭")]),_:1}),B.value?(s(),U(z,{key:0,type:"primary",onClick:o[33]||(o[33]=D=>f())},{default:l(()=>[Il,W(" 新增 ")]),_:1})):(s(),U(z,{key:1,type:"success",onClick:o[34]||(o[34]=D=>f())},{default:l(()=>[Pl,W(" 确认 ")]),_:1}))])]),_:1},8,["model"])):O("",!0)],64)):O("",!0)])):O("",!0)]}),_:1})],2)}}}),zl=["data-key","onDragstart","onDragover"],Kl=$("i",{class:"el-icon--left el-icon-rank"},null,-1),Gl={class:"f1"},Zl={name:"TableSetting"},Xl=ne({...Zl,props:{show:{type:Boolean,default:!1},columns:{type:Array,required:!0}},emits:["update:show","submit"],setup(r,{emit:d}){const t=r,T=d,c=[{label:"固定左边",value:"left"},{label:"默认",value:!1},{label:"固定右边",value:"right"}],a=oe({show:!1,list:[]}),{onDragStart:v,onDragMove:g,onDropEnd:L}=De({list:()=>a.list,key:"prop"});let q;function E(){T("update:show",!1)}function j(){E();const K=se(a.list);q&&K.push(q),T("submit",K)}return ge(()=>t.show,function(K){if(a.show=K,!K)return;const A=se(t.columns),b=[];for(let B=0;B<A.length;B++){const I=A[B];I.prop===be?q=I:b.push(I)}a.list=b},{immediate:!0}),(K,A)=>{const b=_("el-radio-button"),B=_("el-radio-group"),I=_("el-switch"),i=_("el-empty"),G=_("base-dialog");return s(),U(G,{modelValue:a.show,"onUpdate:modelValue":A[1]||(A[1]=w=>a.show=w),title:"表格设置",width:"840px",onClose:E},{footer:l(()=>[e(k($e),{onClose:E,onSubmit:j})]),default:l(()=>[e(Ve,{name:"the-group",tag:"div"},{default:l(()=>[(s(!0),M(J,null,te(a.list,(w,y)=>(s(),M("div",{class:"the-curd-option-item f-vertical",key:w.prop,"data-key":w.prop,draggable:!0,onDragstart:F=>k(v)(y),onDragover:F=>k(g)(F,y),onDrop:A[0]||(A[0]=(...F)=>k(L)&&k(L)(...F))},[Kl,$("span",Gl,le(w.label),1),e(B,{modelValue:w.fixed,"onUpdate:modelValue":F=>w.fixed=F,size:"small",class:"mgr-10"},{default:l(()=>[(s(),M(J,null,te(c,F=>e(b,{key:F.value.toString(),value:F.value},{default:l(()=>[W(le(F.label),1)]),_:2},1032,["value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(I,{modelValue:w.visible,"onUpdate:modelValue":F=>w.visible=F,"inline-prompt":"","active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue","onUpdate:modelValue"])],40,zl))),128)),a.list.length?O("",!0):(s(),U(i,{key:"empty","image-size":120,description:"暂无可以设置的表格列"}))]),_:1})]),_:1},8,["modelValue"])}}}),Ql={class:"the-curd-main-page"},eo={class:"f-vertical mgb-10"},to={key:0,class:"the-tag blue"},lo=$("div",{class:"f1"},null,-1),oo=$("i",{class:"el-icon-arrow-left"},null,-1),ao=$("p",{class:"mgb-10"},"配置筛选相关功能",-1),no=$("p",null,"配置表格相关功能",-1),io={name:"Curd"},fo=ne({...io,props:{data:{type:Object,required:!0},action:{type:Object,required:!0}},setup(r){const d=r,t=oe({loading:!1,editor:{show:!1,type:void 0,form:void 0,action:"add",index:-1},showEntrance:!1}),T=Q(()=>{const m=t.editor.type;return m==="search"||!m&&d.data.search.list.length>0});rt(Ke,t);let c;function a(m){t.editor.type=m,t.editor.show=!1,t.editor.index=-1,t.showEntrance=!1,c={[m]:se(d.data[m])}}function v(m){const f=t.editor.type;m&&c&&(d.data[f]=c[f]),t.editor.index=-1,t.editor.show=!1,t.editor.type=void 0,t.editor.form=void 0,c=void 0}function g(){v()}function L(){Je(JSON.stringify(d.data),()=>pe.success("复制成功！"))}function q(m){m==="reset"&&d.data.search.list.forEach(Be),E.pageInfo.currentPage=1,E.selectList=[],S()}const E=oe({selectList:[],data:[],pageInfo:ct(),formShow:!1,formType:"add",formLoading:!1}),j=Q(()=>d.data.table),K=Q(()=>j.value.columns.filter(f=>f.visible).map(f=>{const x={...f};return x.cellType==="js"&&x.jsCode&&(x.rawContent=function(P,p){let o="";try{o=new Function("cellValue","row",x.jsCode)(P,p)}catch(h){console.warn("解析 rawContent 代码错误 >>",h),o="-"}return o}),x})),A=Q(()=>j.value.actions.map(f=>{const x={...f};return x.key===fe&&(x.click=w),x})),b=Q(()=>{const m=[],f=[];return K.value.forEach(x=>{x.slotHead&&m.push(x.slotHead),x.slot&&f.push(x.slot)}),{head:m,cell:f}});function B(m){return j.value.columns.find(x=>x.prop===m)||{}}const I=he(),i=Q(()=>{const m=j.value,f={title:"编辑表单",config:m.formEdit||{}};return E.formType==="add"&&(f.title="新增表单",f.config=m.formAdd||{}),f});let G=null;function w(m){m?(E.formType="edit",G=m):E.formType="add",E.formShow=!0,setTimeout(()=>{var f;return(f=I.value)==null?void 0:f.clear()}),Re(()=>{var f;return G&&((f=I.value)==null?void 0:f.setFormData(G))})}function y(){var m;E.formShow=!1,(m=I.value)==null||m.reset(),G=null}function F(){var m;(m=I.value)==null||m.validate(async(f,x)=>{if(E.formType==="add"&&d.action.onAdd){E.formLoading=!0;const P=await d.action.onAdd(f,x);if(E.formLoading=!1,P.code!==1)return;y(),S()}if(E.formType==="edit"&&d.action.onEdit){E.formLoading=!0;const P=await d.action.onEdit(f,x);if(E.formLoading=!1,P.code!==1)return;y(),S()}})}function Z(m){const f=d.data.search.list,x={};for(let h=0;h<f.length;h++){const u=f[h],R=Ze(u);if(u.required&&X(R.result,"string"))return mt(document.querySelector(`.${u.id}`)),pe.error(R.result),m&&m.key==="page"&&(E.pageInfo=m.before),null;R.result===!0&&(x[u.key]=R.value)}const P=j.value.columns,p=[],o=[];return m&&m.key==="sort"?P.forEach(h=>{h.sort&&(h.prop===m.prop?h.sort=m.action:h.sort=!0),h.sort==="asc"&&p.push(h.prop),h.sort==="desc"&&o.push(h.prop)}):P.forEach(h=>{h.sort==="asc"&&p.push(h.prop),h.sort==="desc"&&o.push(h.prop)}),p.length&&(x.asc=p.toString()),o.length&&(x.desc=o.toString()),x}async function S(m){const f=Z(m);if(!f)return;const x=JSON.parse(JSON.stringify(E.pageInfo));t.loading=!0;const P=await d.action.getTableData(f,x);t.loading=!1,P.code===1&&(E.pageInfo.total=P.data.total,E.data=P.data.list||[])}function ae(m){const f=E.selectList;switch(m){case"add":w();break;case"delete":if(!f.length)return pe.error("请选择要删除的列表再进行操作~");ve({title:"操作提示",content:`是否删除选中的 ${f.length} 条数据？`,cancelText:"取消",async confirm(){d.action.onDelete?(t.loading=!0,(await d.action.onDelete(JSON.parse(JSON.stringify(E.selectList)))).code===1?(pe.success("删除成功！"),E.selectList=[],S()):t.loading=!1):pe.info("请设置 action.onDelete 删除逻辑")}});break;case"setting":n();break;case"export":d.action.onExport?d.action.onExport():pe.info("请设置 action.onExport 导出逻辑");break}}function Y(m){({exit:()=>v(!0),copy:L,complete:g})[m]()}const C=oe({show:!1});function n(){C.show=!0}function V(m){j.value.columns=m}return yt({formatDate:Ue,copyText:Je,messageBox:ve,message:pe,jsonToPath:pt,request:vt,getData:S,state:t}),ze(function(){d.action.created&&j.value.columns.length&&d.action.created(S)}),(m,f)=>{const x=_("base-table"),P=_("base-pagination"),p=_("el-button"),o=_("el-empty"),h=_("base-dialog");return s(),M("div",Ql,[$("section",{class:ce([t.editor.show?"f1":"w-full"])},[T.value?(s(),U(Dt,{key:0,data:d.data.search,onSearch:q},null,8,["data"])):O("",!0),t.editor.type==="table"?(s(),U(Tl,{key:1,config:j.value,onAction:Y},null,8,["config"])):t.editor.type==="search"?(s(),U(k(Qe),{key:2,onAction:Y})):(s(),M(J,{key:3},[j.value.columns.length>0?(s(),M(J,{key:0},[$("div",eo,[j.value.selectKey?(s(),M("span",to," 已选择 "+le(E.selectList.length)+" 条数据 ",1)):O("",!0),lo,e(k(tt),{config:j.value,disabled:t.loading,onAction:ae},null,8,["config","disabled"])]),e(x,{"select-list":E.selectList,"onUpdate:selectList":f[1]||(f[1]=u=>E.selectList=u),data:E.data,columns:K.value,actions:A.value,actionMax:j.value.actionMax,loading:t.loading,"select-key":j.value.selectKey},Te({_:2},[te(b.value.head,u=>({name:u,fn:l(({$index:R})=>[e(ot,{column:K.value[j.value.selectKey?R-1:R],onSort:f[0]||(f[0]=(H,z)=>S({key:"sort",prop:H,action:z}))},null,8,["column"])])})),te(b.value.cell,u=>({name:u,fn:l(({row:R})=>[e(k(et),{column:B(u),src:R[u],previewList:b.value.cell.map(H=>R[H])},null,8,["column","src","previewList"])])}))]),1032,["select-list","data","columns","actions","actionMax","loading","select-key"]),e(P,{disabled:t.loading,pageInfo:E.pageInfo,onChange:f[2]||(f[2]=u=>S({key:"page",...u}))},null,8,["disabled","pageInfo"])],64)):(s(),U(o,{key:1,description:"当前页面没有表格配置数据，请配置后再操作~"},{default:l(()=>[e(p,{type:"primary",onClick:f[3]||(f[3]=u=>a("table"))},{default:l(()=>[W("去配置")]),_:1})]),_:1}))],64))],2),e(Rl,{show:t.editor.show,"onUpdate:show":f[4]||(f[4]=u=>t.editor.show=u),config:d.data},null,8,["show","config"]),e(h,{modelValue:E.formShow,"onUpdate:modelValue":f[7]||(f[7]=u=>E.formShow=u),title:i.value.title,width:k(_e)(i.value.config.width),onClose:f[8]||(f[8]=u=>y())},{footer:l(()=>[e(k($e),{loading:E.formLoading,onClose:f[5]||(f[5]=u=>y()),onSubmit:f[6]||(f[6]=u=>F())},null,8,["loading"])]),default:l(()=>[e(lt,{ref_key:"formRef",ref:I,config:i.value.config,type:E.formType,disabled:E.formLoading},null,8,["config","type","disabled"])]),_:1},8,["modelValue","title","width"]),e(Xl,{show:C.show,"onUpdate:show":f[9]||(f[9]=u=>C.show=u),columns:j.value.columns,onSubmit:V},null,8,["show","columns"]),!t.showEntrance&&!t.editor.type?(s(),U(p,{key:0,class:"the-curd-entrance",type:"primary",size:"small",onClick:f[10]||(f[10]=u=>t.showEntrance=!0)},{default:l(()=>[oo]),_:1})):O("",!0),e(h,{modelValue:t.showEntrance,"onUpdate:modelValue":f[14]||(f[14]=u=>t.showEntrance=u),title:"请选择配置操作",width:"600px"},{footer:l(()=>[e(p,{onClick:f[13]||(f[13]=u=>t.showEntrance=!1)},{default:l(()=>[W("关 闭")]),_:1})]),default:l(()=>[$("div",{class:"the-curd-entrance-item",onClick:f[11]||(f[11]=u=>a("search"))},[ao,e(k(St))]),$("div",{class:"the-curd-entrance-item",onClick:f[12]||(f[12]=u=>a("table"))},[no,e(k(Ct))])]),_:1},8,["modelValue"])])}}});export{fo as _,Me as a,fe as b,be as c,re as g};
