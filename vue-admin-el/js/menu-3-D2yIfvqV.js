import{d as A,f as v,O as z,b as D,h as g,j as m,y as x,l as w,p as S,z as R,x as q,e as T,t as U,u as h,B as G,aB as H,C as Q,q as J,D as W,F,s as I,G as X,r as N,a as Y,w as Z,Q as ee,c as P}from"./element-plus-HQxsU011.js";import{u as te,e as j}from"./index-VAE7USV8.js";function ne(d,e){return d[e.label]||"-"}const se=[null,void 0,""];function _(d,e){const t=d[e.key],a=d[e.value];return se.includes(t)?a:t}function ae(){const d={};return{on(e,t){d.hasOwnProperty(e)||(d[e]=[]),d[e].some(a=>a===t)||d[e].push(t)},off(e,t){const a=d[e];if(a&&a.length>0&&t){for(let s=0;s<a.length;s++)if(a[s]===t){a.splice(s,1);break}}else console.log("[moduleEvent] => 没有要解绑的事件")},dispatch(e,t){const a=d[e];if(a&&a.length>0)for(let s=0;s<a.length;s++){const u=a[s];u(t)}else console.log("[moduleEvent] => 没有要执行的事件")}}}const K=ae(),oe={class:"the-tree"},le={class:"the-tree-item f-vertical"},ie={key:1,class:"the-tree-icon fvc"},ue=x("i",{class:"el-icon-collection-tag"},null,-1),re=[ue],ce=x("span",{class:"el-checkbox__inner"},null,-1),de=[ce],pe={class:"the-tree-sub"},fe={name:"Level"},he=A({...fe,props:{option:{type:Object,required:!0},setting:{type:Object,required:!0},openKeys:{type:Array,required:!0},parentKeys:{type:Array,required:!0},parentValues:{type:Array,required:!0},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},disabled:{type:Function,default:void 0},usableValueMap:{type:Object,required:!0}},setup(d){const e=d,t=v(()=>e.option[e.setting.children]||[]),a=v(()=>_(e.option,e.setting)),s=v(()=>e.option[e.setting.value]),u=v(()=>e.openKeys.includes(a.value)),y=v(()=>e.values.includes(s.value)),f=v(()=>e.disabled?e.disabled(e.option):!1),L=v(()=>{if(!y.value)return!1;const i=e.usableValueMap[a.value];return i?i.some(c=>!e.values.includes(c)):!1}),{onBeforeEnter:C,onEnter:V,onAfterEnter:k,onBeforeLeave:B,onLeave:M,onAfterLeave:E}=te(),l=z("treeRoot");function n(){K.dispatch(l.eventMap.itemOpen,a.value)}function o(){if(f.value)return;const i={key:a.value,value:s.value,parentKeys:e.parentKeys,parentValues:e.parentValues,hasSub:t.value.length>0};K.dispatch(l.eventMap.itemCheck,i)}return(i,c)=>{const p=D("Level",!0);return m(),g("div",oe,[x("div",le,[t.value.length>0?(m(),g("div",{key:0,class:"the-tree-icon fvc cursor-pointer",onClick:c[0]||(c[0]=r=>n())},[x("i",{class:q(["el-icon-caret-right",{"is-opened":u.value}])},null,2)])):(m(),g("div",ie,re)),d.checkbox?(m(),g("span",{key:2,onClick:c[1]||(c[1]=r=>o()),class:q(["el-checkbox el-checkbox__input",{"is-checked":y.value,"is-disabled":f.value,"is-indeterminate":L.value}])},de,2)):S("",!0),R(i.$slots,"treeitem",G(H(e.option)),()=>[T(U(h(ne)(e.option,e.setting)),1)])]),t.value.length>0?(m(),w(Q,{key:0,onBeforeEnter:h(C),onEnter:h(V),onAfterEnter:h(k),onBeforeLeave:h(B),onLeave:h(M),onAfterLeave:h(E)},{default:J(()=>[W(x("div",pe,[(m(!0),g(F,null,I(t.value,r=>(m(),w(p,{key:h(_)(r,e.setting),option:r,setting:e.setting,"open-keys":e.openKeys,checkbox:e.checkbox,values:e.values,disabled:e.disabled,"usable-value-map":e.usableValueMap,"parent-keys":[...e.parentKeys,a.value],"parent-values":[...e.parentValues,s.value]},null,8,["option","setting","open-keys","checkbox","values","disabled","usable-value-map","parent-keys","parent-values"]))),128))],512),[[X,u.value]])]),_:1},8,["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])):S("",!0)])}}});let O=1;const ve={name:"Tree"},me=A({...ve,props:{options:{type:Array,default:()=>[]},optionSetting:{type:Object,default:()=>({})},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},checkParent:{type:Boolean,default:!1},checkChild:{type:Boolean,default:!1},filterMethod:{type:Function,default:void 0},disabledMethod:{type:Function,default:void 0}},emits:["update:values"],setup(d,{emit:e}){const t=d,a=e,s=v(()=>({label:"label",value:"value",children:"children",...t.optionSetting})),u=N({allKeys:[],openKeys:[]});function y(l,n){return l.forEach(o=>{n.push(_(o,s.value));const i=o[s.value.children]||[];i.length>0&&y(i,n)}),n}function f(l,n){return l.forEach(o=>{const i=o[s.value.value];t.disabledMethod?!t.disabledMethod(o)&&n.push(i):n.push(i);const c=o[s.value.children]||[];c.length>0&&f(c,n)}),n}function L(l,n){for(let o=0;o<l.length;o++){const i=l[o];if(_(i,s.value)===n)return i;const c=i[s.value.children]||[];if(c.length>0){const p=L(c,n);if(p)return p}}}function C(l){u.openKeys.includes(l)?u.openKeys=u.openKeys.filter(n=>n!==l):u.openKeys.push(l)}function V(l){const{value:n,parentValues:o,key:i,hasSub:c}=l;let p=[];if(t.checkChild&&c){const b=L(t.options,i);b&&(p=b[s.value.children]||[])}let r=j(t.values);if(r.includes(n)){if(r=r.filter(b=>b!==n),p.length>0){const b=f(p,[]);r=r.filter($=>!b.includes($))}}else r.push(n),t.checkParent&&r.push(...o),p.length>0&&r.push(...f(p,[])),(t.checkParent||p.length>0)&&(r=[...new Set(r)]);a("update:values",r)}const k={itemCheck:`tree-item-check-${O}`,itemOpen:`tree-item-open-${O}`};O++,K.on(k.itemOpen,C),K.on(k.itemCheck,V),Y(function(){K.off(k.itemCheck,V),K.off(k.itemOpen,C)}),ee("treeRoot",{eventMap:k});function B(l){return l.filter(n=>{const o=n[s.value.children]||[];return!!(o.length>0&&(n[s.value.children]=B(o),n[s.value.children].length>0)||t.filterMethod(n))})}const M=v(()=>t.filterMethod?B(j(t.options)):t.options),E=v(()=>{if(t.checkParent||t.checkChild){let l=function(o){const i=o[s.value.children]||[];if(i.length<1)return;const c=_(o,s.value);n[c]=[];for(const p of i){const r=_(p,s.value),b=p[s.value.value];(t.disabledMethod?t.disabledMethod(p):!1)||n[c].push(b),l(p),n[r]&&n[c].push(...n[r])}};const n={};for(const o of t.options)l(o);return n}return{}});return Z(()=>t.options,function(l){const n=y(l,[]);u.openKeys=u.openKeys.filter(o=>n.includes(o)),u.allKeys=n},{immediate:!0,deep:!0}),(l,n)=>(m(!0),g(F,null,I(M.value,o=>(m(),w(he,{key:h(_)(o,s.value),option:o,setting:s.value,"open-keys":u.openKeys,checkbox:t.checkbox,values:t.values,disabled:t.disabledMethod,"parent-keys":[],"parent-values":[],"usable-value-map":E.value},null,8,["option","setting","open-keys","checkbox","values","disabled","usable-value-map"]))),128))}}),be={class:"menu-3"},ye=x("div",{class:"mb-[10px]"},[x("span",{class:"the-tag purple"},"树形组件")],-1),_e=A({__name:"menu-3",setup(d){const e=[{id:"1",name:"选项 1",list:[{id:"1-1",name:"选项 1-1"},{id:"1-2",name:"选项 1-2",list:[{id:"1-2-1",name:"选项 1-2-1"},{id:"1-2-2",name:"选项 1-2-2"},{id:"1-2-3",name:"选项 1-2-3"},{id:"1-2-4",name:"选项 1-2-4"}]},{id:"1-3",name:"选项 1-3"},{id:"1-4",name:"选项 1-4"},{id:"1-5",name:"选项 1-5"}]},{id:"2",name:"选项 2",list:[{id:"2-1",name:"选项 2-1",list:[{id:"**s",name:"三级选项-1"},{id:"**",name:"三级选项-2"},{id:"999",name:"三级选项-3"}]},{id:"2-2",name:"选项 2-2"},{id:"2-3",name:"选项 2-3"}]}],t={value:"id",label:"name",children:"list"},a=N({values:["1"],keyword:""});return(s,u)=>{const y=D("el-input");return m(),g("div",be,[ye,P(y,{class:"max-w-[300px] mb-[10px]",modelValue:a.keyword,"onUpdate:modelValue":u[0]||(u[0]=f=>a.keyword=f),clearable:"",placeholder:"请输入关键字检索"},null,8,["modelValue"]),P(h(me),{values:a.values,"onUpdate:values":u[1]||(u[1]=f=>a.values=f),checkbox:"","check-parent":"","check-child":"",options:e,"option-setting":t,"disabled-method":f=>["999","2-2"].includes(f.id),"filter-method":f=>f.name.includes(a.keyword)},null,8,["values","disabled-method","filter-method"])])}}});export{_e as default};
