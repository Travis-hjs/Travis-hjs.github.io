import{g as X,R as Y,w,U as Z,B as T,V as ee}from"./index-BDoDd2cX.js";import{d as R,b as P,h as g,i as r,p as h,k as _,j as L,q as $,n as x,t as D,x as te,aC as se,g as C,aA as ae,F as I,G as ne,u as y,c as O,ai as le,m as v,l as ie,C as F,s as E,e as oe,A as re}from"./element-plus-DM0gVeuf.js";const de={class:"the-pagination f-vertical"},ce={name:"Pagination"},ue=R({...ce,props:{pageInfo:{type:Object,default:()=>X()},pageSizes:{type:Array,default:()=>[10,30,100,200,300]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},position:{type:String,default:"right"},disabled:{type:Boolean,default:!1}},emits:["change"],setup(b,{emit:k}){const e=b,c=k;function m(i){const f=JSON.parse(JSON.stringify(e.pageInfo));e.pageInfo.currentPage=1,e.pageInfo.pageSize=i,c("change",{type:"pageSize",value:i,before:f})}function u(i){const f=JSON.parse(JSON.stringify(e.pageInfo));e.pageInfo.currentPage=i,c("change",{type:"currentPage",value:i,before:f})}return(i,f)=>{const z=P("el-pagination");return r(),g("div",de,[h("div",{class:x([{f1:["center","right"].includes(e.position)}])},[$(i.$slots,"left")],2),e.pageInfo.total?(r(),_(z,{key:0,background:"",disabled:e.disabled,layout:e.layout,total:e.pageInfo.total,"current-page":e.pageInfo.currentPage,"page-sizes":e.pageSizes,onSizeChange:m,onCurrentChange:u},null,8,["disabled","layout","total","current-page","page-sizes"])):L("",!0),h("div",{class:x([{f1:["center","left"].includes(e.position)}])},[$(i.$slots,"right")],2)])}}}),fe={class:"f-vertical f-between"},pe={class:"pl-[6px]"},ge={name:"SortBar"},ye=R({...ge,props:{column:{type:Object,required:!0},disabled:{type:Boolean,default:void 0}},emits:["sort"],setup(b,{emit:k}){const e=b,c=k;function m(u){if(e.disabled)return;const i=e.column;i.sort===u&&(u=!0),i.sort=u,c("sort",i.prop,u)}return(u,i)=>(r(),g("div",fe,[h("span",null,D(e.column.title),1),h("div",pe,[h("div",{class:x(["the-sort-icon top",[{"is-select":e.column.sort==="asc"},{"is-disabled":e.disabled}]]),onClick:i[0]||(i[0]=f=>m("asc"))},null,2),h("div",{class:x(["the-sort-icon bottom",[{"is-select":e.column.sort==="desc"},{"is-disabled":e.disabled}]]),onClick:i[1]||(i[1]=f=>m("desc"))},null,2)])]))}}),he=["id"],be=["innerHTML"],me={class:"the-tag blue"},ve={name:"Table"},Se=R({...ve,props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},isRowClick:{type:Boolean,default:!1},actions:{type:Array,default:()=>[]},actionMax:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},selectKey:{type:String,default:void 0},selectList:{type:Array,default:void 0},selectDisabled:{type:Function,default:void 0},pageInfo:{type:Object,default:void 0},pageSizes:{type:Array,default:void 0},sortMultiple:{type:Boolean,default:!1}},emits:["update:selectList","update:pageInfo","row","page","sort"],setup(b,{emit:k}){const e=b,c=k,m=te(),{adaptive:u,update:i}=Y();se(function(){var t;(t=m.value)==null||t.doLayout(),i()});function f(t,a,n){c("row",t,a,n)}function z(t){return["",null,void 0,"null","undefined"].includes(t)}function q(t){const a=t.prop!==w;return T(t.tooltip,"boolean")?t.tooltip:a}function U(t,a,n){return T(n.formatter,"function")?n.formatter(t,t[a],n):z(t[n.prop])?"-":t[n.prop]}function K(t,a){return T(e.selectDisabled,"function")?!e.selectDisabled(t,a):!0}const H=C(()=>{const t=e.selectList,a=e.selectKey;return t&&a?t.map(n=>n[a]):[]});function A(t){const a=e.selectKey;return H.value.includes(t[a])}const S=C(()=>e.data.filter((t,a)=>K(t,a))),J=C(()=>S.value.length===0),N=C(()=>J.value?!1:S.value.every(t=>A(t))),G=C(()=>N.value?!1:S.value.some(t=>A(t))),M=()=>JSON.parse(JSON.stringify(e.selectList));function W(){if(!e.selectList)return console.warn("选择功能需要绑定 selectList 属性！");const t=e.selectKey,a=S.value.map(o=>o[t]);let n=M();N.value?n=n.filter(o=>!a.includes(o[t])):n=ee(n.concat(S.value),(o,p)=>o[t]===p[t]),c("update:selectList",n)}function V(t){if(!e.selectList)return console.warn("选择功能需要绑定 selectList 属性！");const a=e.selectKey,n=H.value;let o=M();n.includes(t[a])?o=o.filter(p=>p[a]!==t[a]):o.push(t),c("update:selectList",o)}const d={fields:[],rules:[]};function j(t,a,n){const o=e.columns,p=[];for(const l of o){const B=l.prop;B===t?l.sort=a:!e.sortMultiple&&l.sort&&(l.sort=!0,d.fields=d.fields.filter(Q=>Q!==l.prop)),l.sort==="asc"&&p.push(B)}typeof a=="string"?d.fields.push(t):a&&(d.fields=d.fields.filter(l=>l!==t)),d.fields=[...new Set(d.fields)];const s={...e.pageInfo||{}};d.fields.length>0?(d.rules=d.fields.map(l=>p.includes(l)?1:0),s.sortFields=d.fields.toString(),s.sortRules=d.rules.toString()):(d.rules=[],delete s.sortFields,delete s.sortRules),c("update:pageInfo",s),!n&&c("sort",s,t)}for(const t of e.columns)if(typeof t.sort=="string"&&(j(t.prop,t.sort,!0),!e.sortMultiple))break;return(t,a)=>{const n=P("el-checkbox"),o=P("el-table-column"),p=ae("loading");return r(),g(I,null,[ne((r(),g("div",{class:x(["the-table",t.$attrs.class]),id:y(u).id},[O(y(le),{ref:"the-table",stripe:"",border:"","max-height":e.maxHeight||y(u).height,data:e.data,onRowClick:f,onSelectionChange:V},{default:v(()=>[e.selectKey?(r(),_(o,{key:0,resizable:!1,width:"55",align:"center",fixed:"left"},{header:v(()=>[O(n,{indeterminate:G.value,"model-value":N.value,disabled:J.value,onChange:W},null,8,["indeterminate","model-value","disabled"])]),default:v(({row:s,$index:l})=>[O(n,{"model-value":A(s),disabled:!K(s,l),onChange:B=>V(s)},null,8,["model-value","disabled","onChange"])]),_:1})):L("",!0),(r(!0),g(I,null,ie(e.columns,s=>(r(),g(I,{key:s.prop},[typeof s.visible!="boolean"||s.visible?(r(),_(o,{key:s.prop,prop:s.prop,label:s.title,"min-width":s.minWidth,width:s.width,"show-overflow-tooltip":q(s),fixed:s.prop===y(w)?"right":s.fixed,align:s.prop===y(w)?"center":s.align,"class-name":b.isRowClick&&s.prop!==y(w)?"the-table-column-click":""},{header:v(l=>[s.slotHead?$(t.$slots,s.slotHead,F(E({key:0},l))):s.sort?(r(),_(ye,{key:1,column:s,onSort:j},null,8,["column"])):L("",!0)]),default:v(l=>[s.slot?$(t.$slots,s.slot,F(E({key:0},l))):s.prop===y(w)?(r(),_(Z,{key:1,row:l.row,index:l.$index,actions:e.actions,clickStop:e.isRowClick},null,8,["row","index","actions","clickStop"])):s.rawContent?(r(),g("div",{key:2,innerHTML:s.rawContent(l.row[s.prop],l.row)},null,8,be)):(r(),g(I,{key:3},[oe(D(U(l.row,s.prop,s)),1)],64))]),_:2},1032,["prop","label","min-width","width","show-overflow-tooltip","fixed","align","class-name"])):L("",!0)],64))),128))]),_:3},8,["max-height","data"])],10,he)),[[p,e.loading]]),e.pageInfo?(r(),_(ue,{key:0,class:"mt-[20px]",disabled:e.loading,"page-info":e.pageInfo,"page-sizes":e.pageSizes,onChange:a[0]||(a[0]=s=>c("page",s))},re({_:2},[e.selectList&&e.selectList.length>0?{name:"left",fn:v(()=>[h("span",me,"已选择："+D(e.selectList.length)+" 条数据",1)]),key:"0"}:void 0]),1032,["disabled","page-info","page-sizes"])):L("",!0)],64)}}});export{Se as _};
