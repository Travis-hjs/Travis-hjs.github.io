import{g as Z,Y as Q,z as y,Z as X,$ as ee,E as N,a0 as te}from"./index-CAkezAZH.js";import{d as E,b as P,h as u,i as r,p as B,k as b,j as _,q as L,n as D,x as se,aC as ae,g as m,aA as ne,F as C,G as le,u as p,c as T,ah as ie,m as h,l as oe,C as F,s as V,e as re,t as j,A as de}from"./element-plus-CwxVOKr1.js";const fe={class:"the-pagination f-vertical"},ce={name:"Pagination"},pe=E({...ce,props:{pageInfo:{type:Object,default:()=>Z()},pageSizes:{type:Array,default:()=>[10,30,100,200,300]},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},position:{type:String,default:"right"},disabled:{type:Boolean,default:!1}},emits:["change"],setup(k,{emit:x}){const t=k,f=x;function S(d){const g=JSON.parse(JSON.stringify(t.pageInfo));t.pageInfo.currentPage=1,t.pageInfo.pageSize=d,f("change",{type:"pageSize",value:d,before:g})}function w(d){const g=JSON.parse(JSON.stringify(t.pageInfo));t.pageInfo.currentPage=d,f("change",{type:"currentPage",value:d,before:g})}return(d,g)=>{const I=P("el-pagination");return r(),u("div",fe,[B("div",{class:D([{f1:["center","right"].includes(t.position)}])},[L(d.$slots,"left")],2),t.pageInfo.total?(r(),b(I,{key:0,background:"",disabled:t.disabled,layout:t.layout,total:t.pageInfo.total,"current-page":t.pageInfo.currentPage,"page-sizes":t.pageSizes,onSizeChange:S,onCurrentChange:w},null,8,["disabled","layout","total","current-page","page-sizes"])):_("",!0),B("div",{class:D([{f1:["center","left"].includes(t.position)}])},[L(d.$slots,"right")],2)])}}}),ue=["id"],ge=["innerHTML"],ye={class:"the-tag blue"},he={name:"Table"},me=E({...he,props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},isRowClick:{type:Boolean,default:!1},actions:{type:Array,default:()=>[]},actionMax:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},selectKey:{type:String,default:void 0},selectList:{type:Array,default:void 0},selectDisabled:{type:Function,default:void 0},pageInfo:{type:Object,default:void 0},pageSizes:{type:Array,default:void 0},sortMultiple:{type:Boolean,default:!1}},emits:["update:selectList","update:pageInfo","row","page","sort"],setup(k,{emit:x}){const t=k,f=x,S=se(),{adaptive:w,update:d}=Q();ae(function(){var e;(e=S.value)==null||e.doLayout(),d()});function g(e,a,n){f("row",e,a,n)}function I(e){return["",null,void 0,"null","undefined"].includes(e)}function q(e){const a=e.prop!==y;return N(e.tooltip,"boolean")?e.tooltip:a}function G(e,a,n){return N(n.formatter,"function")?n.formatter(e,e[a],n):I(e[n.prop])?"-":e[n.prop]}function O(e,a){return N(t.selectDisabled,"function")?!t.selectDisabled(e,a):!0}const K=m(()=>{const e=t.selectList,a=t.selectKey;return e&&a?e.map(n=>n[a]):[]});function z(e){const a=t.selectKey;return K.value.includes(e[a])}const v=m(()=>t.data.filter((e,a)=>O(e,a))),R=m(()=>v.value.length===0),A=m(()=>R.value?!1:v.value.every(e=>z(e))),U=m(()=>A.value?!1:v.value.some(e=>z(e))),H=()=>JSON.parse(JSON.stringify(t.selectList));function W(){if(!t.selectList)return console.warn("选择功能需要绑定 selectList 属性！");const e=t.selectKey,a=v.value.map(i=>i[e]);let n=H();A.value?n=n.filter(i=>!a.includes(i[e])):n=te(n.concat(v.value),(i,c)=>i[e]===c[e]),f("update:selectList",n)}function J(e){if(!t.selectList)return console.warn("选择功能需要绑定 selectList 属性！");const a=t.selectKey,n=K.value;let i=H();n.includes(e[a])?i=i.filter(c=>c[a]!==e[a]):i.push(e),f("update:selectList",i)}const o={fields:[],rules:[]};function M(e,a,n){const i=t.columns,c=[];for(const l of i){const $=l.prop;$===e?l.sort=a:!t.sortMultiple&&l.sort&&(l.sort=!0,o.fields=o.fields.filter(Y=>Y!==l.prop)),l.sort==="asc"&&c.push($)}typeof a=="string"?o.fields.push(e):a&&(o.fields=o.fields.filter(l=>l!==e)),o.fields=[...new Set(o.fields)];const s={...t.pageInfo||{}};o.fields.length>0?(o.rules=o.fields.map(l=>c.includes(l)?"asc":"desc"),s.sortFields=o.fields.toString(),s.sortRules=o.rules.toString()):(o.rules=[],delete s.sortFields,delete s.sortRules),f("update:pageInfo",s),!n&&f("sort",s,e)}for(const e of t.columns)if(typeof e.sort=="string"&&(M(e.prop,e.sort,!0),!t.sortMultiple))break;return(e,a)=>{const n=P("el-checkbox"),i=P("el-table-column"),c=ne("loading");return r(),u(C,null,[le((r(),u("div",{class:D(["the-table",e.$attrs.class]),id:p(w).id},[T(p(ie),{ref_key:"theTable",ref:S,stripe:"",border:"","max-height":t.maxHeight||p(w).height,data:t.data,onRowClick:g,onSelectionChange:J},{default:h(()=>[t.selectKey?(r(),b(i,{key:0,resizable:!1,width:"55",align:"center",fixed:"left"},{header:h(()=>[T(n,{indeterminate:U.value,"model-value":A.value,disabled:R.value,onChange:W},null,8,["indeterminate","model-value","disabled"])]),default:h(({row:s,$index:l})=>[T(n,{"model-value":z(s),disabled:!O(s,l),onChange:$=>J(s)},null,8,["model-value","disabled","onChange"])]),_:1})):_("",!0),(r(!0),u(C,null,oe(t.columns,s=>(r(),u(C,{key:s.prop},[typeof s.visible!="boolean"||s.visible?(r(),b(i,{key:s.prop,prop:s.prop,label:s.title,"min-width":s.minWidth,width:s.width,"show-overflow-tooltip":q(s),fixed:s.prop===p(y)?"right":s.fixed,align:s.prop===p(y)?"center":s.align,"class-name":k.isRowClick&&s.prop!==p(y)?"the-table-column-click":""},{header:h(l=>[s.slotHead?L(e.$slots,s.slotHead,F(V({key:0},l))):s.prop!==p(y)?(r(),b(ee,{key:1,column:s,disabled:t.loading,onSort:M},null,8,["column","disabled"])):_("",!0)]),default:h(l=>[s.slot?L(e.$slots,s.slot,F(V({key:0},l))):s.prop===p(y)?(r(),b(X,{key:1,row:l.row,index:l.$index,actions:t.actions,clickStop:t.isRowClick},null,8,["row","index","actions","clickStop"])):s.rawContent?(r(),u("div",{key:2,innerHTML:s.rawContent(l.row[s.prop],l.row)},null,8,ge)):(r(),u(C,{key:3},[re(j(G(l.row,s.prop,s)),1)],64))]),_:2},1032,["prop","label","min-width","width","show-overflow-tooltip","fixed","align","class-name"])):_("",!0)],64))),128))]),_:3},8,["max-height","data"])],10,ue)),[[c,t.loading]]),t.pageInfo?(r(),b(pe,{key:0,class:"mt-[20px]",disabled:t.loading,"page-info":t.pageInfo,"page-sizes":t.pageSizes,onChange:a[0]||(a[0]=s=>f("page",s))},de({_:2},[t.selectList&&t.selectList.length>0?{name:"left",fn:h(()=>[B("span",ye,"已选择："+j(t.selectList.length)+" 条数据",1)]),key:"0"}:void 0]),1032,["disabled","page-info","page-sizes"])):_("",!0)],64)}}});export{me as _};
