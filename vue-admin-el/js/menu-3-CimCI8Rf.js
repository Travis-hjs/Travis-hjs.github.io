import{d as O,f as m,O as N,b as P,h as b,j as v,y as k,l as A,p as M,z,x as $,e as R,t as T,u as h,B as U,aB as G,C as H,q as Q,D as J,F as j,s as D,G as W,r as F,a as X,w as Y,Q as Z,c as S}from"./element-plus-B95ogeqs.js";import{u as ee,e as q}from"./index-Cw8pUpDv.js";function te(r,e){return r[e.label]||"-"}const ne=[null,void 0,""];function K(r,e){const t=r[e.key],s=r[e.value];return ne.includes(t)?s:t}function se(){const r={};return{on(e,t){r.hasOwnProperty(e)||(r[e]=[]),r[e].some(s=>s===t)||r[e].push(t)},off(e,t){const s=r[e];if(s&&s.length>0&&t){for(let o=0;o<s.length;o++)if(s[o]===t){s.splice(o,1);break}}else console.log("[moduleEvent] => 没有要解绑的事件")},dispatch(e,t){const s=r[e];if(s&&s.length>0)for(let o=0;o<s.length;o++){const i=s[o];i(t)}else console.log("[moduleEvent] => 没有要执行的事件")}}}const x=se(),oe={class:"the-tree"},le={class:"the-tree-item f-vertical"},ae={key:1,class:"the-tree-icon fvc"},ie=k("i",{class:"el-icon-collection-tag"},null,-1),re=[ie],ue=k("span",{class:"el-checkbox__inner"},null,-1),ce=[ue],de={class:"the-tree-sub"},pe={name:"Level"},fe=O({...pe,props:{option:{type:Object,required:!0},setting:{type:Object,required:!0},openKeys:{type:Array,required:!0},parentKeys:{type:Array,required:!0},parentValues:{type:Array,required:!0},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},disabled:{type:Function,default:void 0}},setup(r){const e=r,t=m(()=>e.option[e.setting.children]||[]),s=m(()=>K(e.option,e.setting)),o=m(()=>e.option[e.setting.value]),i=m(()=>e.openKeys.includes(s.value)),g=m(()=>e.values.includes(o.value)),d=m(()=>e.disabled?e.disabled(e.option):!1),{onBeforeEnter:L,onEnter:C,onAfterEnter:B,onBeforeLeave:y,onLeave:E,onAfterLeave:V}=ee(),a=N("treeRoot");function n(){x.dispatch(a.eventMap.itemOpen,s.value)}function l(){if(d.value)return;const c={key:s.value,value:o.value,parentKeys:e.parentKeys,parentValues:e.parentValues,hasSub:t.value.length>0};x.dispatch(a.eventMap.itemCheck,c)}return(c,p)=>{const f=P("Level",!0);return v(),b("div",oe,[k("div",le,[t.value.length>0?(v(),b("div",{key:0,class:"the-tree-icon fvc cursor-pointer",onClick:p[0]||(p[0]=u=>n())},[k("i",{class:$(["el-icon-caret-right",{"is-opened":i.value}])},null,2)])):(v(),b("div",ae,re)),r.checkbox?(v(),b("span",{key:2,onClick:p[1]||(p[1]=u=>l()),class:$(["el-checkbox el-checkbox__input",{"is-checked":g.value,"is-disabled":d.value}])},ce,2)):M("",!0),z(c.$slots,"treeitem",U(G(e.option)),()=>[R(T(h(te)(e.option,e.setting)),1)])]),t.value.length>0?(v(),A(H,{key:0,onBeforeEnter:h(L),onEnter:h(C),onAfterEnter:h(B),onBeforeLeave:h(y),onLeave:h(E),onAfterLeave:h(V)},{default:Q(()=>[J(k("div",de,[(v(!0),b(j,null,D(t.value,u=>(v(),A(f,{key:h(K)(u,e.setting),option:u,setting:e.setting,"open-keys":e.openKeys,checkbox:e.checkbox,values:e.values,disabled:e.disabled,"parent-keys":[...e.parentKeys,s.value],"parent-values":[...e.parentValues,o.value]},null,8,["option","setting","open-keys","checkbox","values","disabled","parent-keys","parent-values"]))),128))],512),[[W,i.value]])]),_:1},8,["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])):M("",!0)])}}});let w=1;const he={name:"Tree"},ve=O({...he,props:{options:{type:Array,default:()=>[]},optionSetting:{type:Object,default:()=>({})},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},checkParent:{type:Boolean,default:!1},checkChild:{type:Boolean,default:!1},filterMethod:{type:Function,default:void 0},disabledMethod:{type:Function,default:void 0}},emits:["update:values"],setup(r,{emit:e}){const t=r,s=e,o=m(()=>({label:"label",value:"value",children:"children",...t.optionSetting})),i=F({allKeys:[],openKeys:[]});function g(a,n){return a.forEach(l=>{n.push(K(l,o.value));const c=l[o.value.children]||[];c.length>0&&g(c,n)}),n}function d(a,n){return a.forEach(l=>{const c=l[o.value.value];t.disabledMethod?!t.disabledMethod(l)&&n.push(c):n.push(c);const p=l[o.value.children]||[];p.length>0&&d(p,n)}),n}function L(a,n){for(let l=0;l<a.length;l++){const c=a[l];if(K(c,o.value)===n)return c;const p=c[o.value.children]||[];if(p.length>0){const f=L(p,n);if(f)return f}}}function C(a){i.openKeys.includes(a)?i.openKeys=i.openKeys.filter(n=>n!==a):i.openKeys.push(a)}function B(a){const{value:n,parentValues:l,key:c,hasSub:p}=a;let f=[];if(t.checkChild&&p){const _=L(t.options,c);_&&(f=_[o.value.children]||[])}let u=q(t.values);if(u.includes(n)){if(u=u.filter(_=>_!==n),f.length>0){const _=d(f,[]);u=u.filter(I=>!_.includes(I))}}else u.push(n),t.checkParent&&u.push(...l),f.length>0&&u.push(...d(f,[])),(t.checkParent||f.length>0)&&(u=[...new Set(u)]);s("update:values",u)}const y={itemCheck:`tree-item-check-${w}`,itemOpen:`tree-item-open-${w}`};w++,x.on(y.itemOpen,C),x.on(y.itemCheck,B),X(function(){x.off(y.itemCheck,B),x.off(y.itemOpen,C)}),Z("treeRoot",{eventMap:y});function E(a){return a.filter(n=>{const l=n[o.value.children]||[];return!!(l.length>0&&(n[o.value.children]=E(l),n[o.value.children].length>0)||t.filterMethod(n))})}const V=m(()=>t.filterMethod?E(q(t.options)):t.options);return Y(()=>t.options,function(a){const n=g(a,[]);i.openKeys=i.openKeys.filter(l=>n.includes(l)),i.allKeys=n},{immediate:!0,deep:!0}),(a,n)=>(v(!0),b(j,null,D(V.value,l=>(v(),A(fe,{key:h(K)(l,o.value),option:l,setting:o.value,"open-keys":i.openKeys,checkbox:t.checkbox,values:t.values,disabled:t.disabledMethod,"parent-keys":[],"parent-values":[]},null,8,["option","setting","open-keys","checkbox","values","disabled"]))),128))}}),me={class:"menu-3"},ye=k("div",{class:"mb-[10px]"},[k("span",{class:"the-tag purple"},"树形组件")],-1),ge=O({__name:"menu-3",setup(r){const e=[{id:"1",name:"选项 1",list:[{id:"1-1",name:"选项 1-1"},{id:"1-2",name:"选项 1-2",list:[{id:"1-2-1",name:"选项 1-2-1"},{id:"1-2-2",name:"选项 1-2-2"},{id:"1-2-3",name:"选项 1-2-3"},{id:"1-2-4",name:"选项 1-2-4"}]},{id:"1-3",name:"选项 1-3"},{id:"1-4",name:"选项 1-4"},{id:"1-5",name:"选项 1-5"}]},{id:"2",name:"选项 2",list:[{id:"2-1",name:"选项 2-1"},{id:"2-2",name:"选项 2-2"},{id:"2-3",name:"选项 2-3"}]}],t={value:"id",label:"name",children:"list"},s=F({values:["1"],keyword:""});return(o,i)=>{const g=P("el-input");return v(),b("div",me,[ye,S(g,{class:"max-w-[300px] mb-[10px]",modelValue:s.keyword,"onUpdate:modelValue":i[0]||(i[0]=d=>s.keyword=d),clearable:"",placeholder:"请输入关键字检索"},null,8,["modelValue"]),S(h(ve),{values:s.values,"onUpdate:values":i[1]||(i[1]=d=>s.values=d),checkbox:"","check-parent":"","check-child":"",options:e,"option-setting":t,"disabled-method":d=>d.id==="2-2","filter-method":d=>d.name.includes(s.keyword)},null,8,["values","disabled-method","filter-method"])])}}});export{ge as default};
