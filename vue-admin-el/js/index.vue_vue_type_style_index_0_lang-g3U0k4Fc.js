import{H as ot,I as nt,a as at,d as ae,h as ee,o as Re,b as h,e as s,f as U,k as E,B as we,m as N,F as I,c as e,g as l,C as A,t as oe,z as le,u as w,q as Se,aw as Te,n as ce,i as D,N as Ve,j as he,r as ne,w as ge,T as it,K as rt}from"./element-plus-CrjfmyRg.js";import{b as st,F as Ae,a as ut}from"./index-Swj4FZD7.js";import{g as Q,h as Ee,k as se,f as Ue,i as Ye,b as ve,l as De,n as dt,a as pe,u as ct,c as Je,p as pt}from"./index-uaPo7K-X.js";import{v as ft,s as mt}from"./dom-vtHEqTVj.js";import{r as vt}from"./common-0LqOjFM7.js";const ze="the-curd-state",Ne=()=>ot(ze),be="action-right",fe="action-edit",de={input:"输入框",textarea:"文本域","input-between":"输入框-串联",select:"下拉框-单选","select-multiple":"下拉框-多选",checkbox:"多选复选框",radio:"单选选择框",switch:"开关切换",date:"日期选择器",cascader:"级联选择器"};let je=0;function Ke(){return je++,je}function Be(r){if(r.type=="date"){const u=r.shortcutIndex,t="the-date-shortcut-selected",S=document.querySelector(`.${t}`);if(S&&S.classList.remove(t),Q(u,"number")&&u>=0){const d=Fe[r.dateType][u].value();r.value=d;const n=`.${r.id} .el-picker-panel__sidebar`,m=document.querySelector(n);m&&nt(()=>m.children[u].classList.add(t))}!Q(r.value,"array")&&r.valueType==="array"&&(r.value=[])}else["object","array"].includes(Ee(r.defaultValue))?r.value=se(r.defaultValue):r.value=r.defaultValue}function re(r,u="",t){const S=Ke(),d=Date.now(),n="请输入",m="请选择",v=`field-${r}-${S}-${d}`,Y={input:{key:u,id:v,type:"input",value:"",defaultValue:"",placeholder:n,valueType:"string"},textarea:{id:v,value:"",defaultValue:"",type:"textarea",placeholder:n,key:u,valueType:"string"},"input-between":{key:u,id:v,value:["",""],defaultValue:["",""],type:"input-between",placeholder:["请输入范围一","请输入范围二"],separator:"-",valueType:"array"},select:{key:u,id:v,value:"",defaultValue:"",type:"select",placeholder:m,options:[],optionSetting:{label:"",value:""},valueType:"string"},"select-multiple":{key:u,id:v,value:[],defaultValue:[],type:"select-multiple",placeholder:m,options:[],optionSetting:{label:"",value:""},valueType:"array"},checkbox:{key:u,id:v,value:[],defaultValue:[],type:"checkbox",placeholder:m,options:[],optionSetting:{label:"",value:""},valueType:"array"},radio:{key:u,id:v,value:"",defaultValue:"",type:"radio",placeholder:m,options:[],optionSetting:{label:"",value:""},valueType:"string"},switch:{key:u,id:v,value:!1,defaultValue:!1,type:"switch",placeholder:"",valueType:"boolean"},date:{key:u,id:v,value:"",type:"date",placeholder:m,dateType:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D",valueType:"string",shortcutIndex:""},cascader:{key:u,id:v,value:[],defaultValue:[],type:"cascader",placeholder:m,options:[],optionSetting:{label:"",value:"",children:""},multiple:!1,checkStrictly:!1,valueType:"array"}}[r];return Y.label="",Y.required=!1,Y}function Me(r,u){return{label:u,prop:r,width:void 0,minWidth:void 0,tooltip:!1,cellType:"text",sort:!1,fixed:!1,iconTips:"",imageWidth:void 0,imageHeight:void 0,jsCode:"",visible:!0}}function Ie(){return{width:500,labelWidth:120,labelPosition:"left",fields:[]}}function Ce(){return{key:`action-${Ke()}-${Date.now()}`,text:"",icon:"",click:"",type:"primary"}}function Ge(r){const u={value:r.value,result:!0};if(r.type==="date"){if(!u.value)return u.result=r.placeholder,u;if(["datetimerange","daterange"].includes(r.dateType)){const n=r.value;return n.length<2?(u.result=r.placeholder,u):(u.value=n.map(m=>Ue(m,r.format)),u)}return u.value=Ue(r.value,r.format),u}const t=[null,void 0,""];if(r.type==="input-between"){const n=r.value;if(t.includes(n[0]))return u.result=r.placeholder[0],u;if(t.includes(n[1]))return u.result=r.placeholder[1],u;u.value=JSON.parse(JSON.stringify(n))}if(["input","textarea","radio","select"].includes(r.type)&&t.includes(r.value))return u.result=r.placeholder,u;if(["checkbox","select-multiple"].includes(r.type)){const n=r.value;if(!n.length)return u.result=r.placeholder,u;u.value=JSON.parse(JSON.stringify(n))}return u}function _e(r){if(r)return r=parseInt(r.toString()),r=Math.abs(r),`${r}px`}const Pe=[{label:"选择年份",value:"year",formatShow:"YYYY",format:"Y"},{label:"选择年份-月份",value:"month",formatShow:"YYYY-MM",format:"Y-M"},{label:"选择年份-周",value:"week",formatShow:"YYYY年 第ww周",format:"Y-M-D"},{label:"选择年份-月份-日",value:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择年份-月份-日 时:分:秒",value:"datetime",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"},{label:"选择日期范围",value:"daterange",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择日期-时间范围",value:"datetimerange",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"}],Ze=3600*1e3*24;function me(r=0){const u=new Date;return u.setMonth(new Date().getMonth()-r),u}function ke(r=0){const u=new Date,t=Ze*7*r;return u.setTime(u.getTime()-t),u}const Oe=[{text:"今天",value:()=>new Date},{text:"昨天",value(){const r=new Date;return r.setTime(r.getTime()-Ze),r}},{text:"一周前",value:()=>ke(1)},{text:"一个月前",value:()=>me(1)},{text:"三个月前",value:()=>me(3)},{text:"半年前",value:()=>me(6)},{text:"一年前",value:()=>me(12)}],He=Oe.map((r,u)=>{const t=u===0,S=new Date().toLocaleDateString(),d=[new Date(`${S} 00:00:00`),new Date(`${S} 23:59:59`)];return{text:t?"今天内":`${r.text}至今`,value:()=>t?d:[r.value(),new Date]}}),Fe={year:[{text:"今年",value:()=>new Date},{text:"去年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-1))},{text:"前年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-2))}],month:[{text:"当月",value:()=>new Date},{text:"上月",value:()=>me(1)},{text:"前3个月",value:()=>me(3)},{text:"前6个月",value:()=>me(6)},{text:"前12个月",value:()=>me(12)}],week:[{text:"本周",value:()=>new Date},{text:"上周",value:()=>ke(1)},{text:"上2周",value:()=>ke(2)},{text:"上3周",value:()=>ke(3)},{text:"上4周",value:()=>ke(4)}],date:Oe,datetime:Oe,daterange:He,datetimerange:He};function yt(r){const u=window;for(const t in r){const S=`_${t}`;u[S]=r[t]}at(function(){for(const t in r){const S=`_${t}`;u[S]=null}})}function te(r){return`<b style="color: var(--yellow)"> ${r} </b>`}const gt={name:"Field"},xe=ae({...gt,props:{fieldData:{type:Object,required:!0},editMode:Boolean,readonly:Boolean,disabled:Boolean},emits:["change"],setup(r,{emit:u}){const t=r,S=u;Be(t.fieldData);function d(_){let y=_||t.fieldData.value;Q(y,"array")&&(y=se(y)),S("change",y)}const n=ee(()=>t.fieldData),m=ee(()=>{const _=t.fieldData.optionSetting||{};return{value:_.value||"value",label:_.label||"label"}}),v=ee(()=>{const _=t.fieldData;return{multiple:_.multiple,checkStrictly:_.checkStrictly,value:_.optionSetting.value||"value",label:_.optionSetting.label||"label",children:_.optionSetting.children||"children"}});function q(_){const y=n.value.placeholder;return{disabled:t.disabled,readonly:t.readonly,clearable:!0,placeholder:Q(_,"number")?y[_]:y}}function Y(_){const y=t.fieldData;y.valueType==="number"?(y.value=Ye(_,!0,!0),d(Number(y.value))):(y.value=_,d())}function C(_,y){const L=t.fieldData;L.valueType==="array<number>"?(L.value[y]=Ye(_,!0,!0),d(L.value.map(Z=>Number(Z)))):(L.value[y]=_,d())}const H=["-",".","",null,void 0];function K(){const _=t.fieldData;_.valueType==="number"&&(H.includes(_.value)?_.value="":_.value=Number(_.value))}function J(_){const y=t.fieldData;if(y.valueType==="array<number>"){const L=y.value[_];H.includes(L)?y.value[_]="":y.value[_]=Number(L)}}function g(_){const y=_.type==="select-multiple";return{placeholder:_.placeholder,disabled:t.disabled,multiple:_.type==="select-multiple",clearable:!0,filterable:!0,collapseTags:!0,class:`field-item${y?" is-multiple-select":""}`}}let W=[];const R="the-date-shortcut-selected";function i(){const _=document.querySelector(`.${R}`);_&&_.classList.remove(R),d()}function G(_){_.classList.add(R)}return Re(function(){const _=t.fieldData;if(_.type==="date"){const y=`.${_.id} .el-picker-panel__sidebar`,L=document.querySelector(y);if(!L)return console.warn("找不到日期快捷面板节点！");W=Array.from(L.children),W.forEach(T=>{T.addEventListener("click",()=>G(T))});const Z=_.shortcutIndex;Q(Z,"number")&&Z>=0&&G(W[Z])}}),(_,y)=>{const L=h("el-input"),Z=h("el-text"),T=h("el-select-v2"),X=h("el-option"),P=h("el-select"),$=h("el-checkbox"),a=h("el-checkbox-group"),k=h("el-radio"),O=h("el-radio-group"),b=h("el-switch"),c=h("el-cascader"),B=h("el-date-picker");return s(),U("div",{class:"the-curd-form-field f-vertical short-value",style:Se({width:w(_e)(n.value.valueWidth)})},[n.value.type==="input"?(s(),E(L,we({key:0,"model-value":n.value.value},q(),{class:"the-curd-field",onInput:Y,onBlur:K}),null,16,["model-value"])):N("",!0),n.value.type==="textarea"?(s(),E(L,{key:1,modelValue:n.value.value,"onUpdate:modelValue":y[0]||(y[0]=f=>n.value.value=f),readonly:t.readonly,disabled:t.disabled,autosize:{minRows:2,maxRows:10},placeholder:n.value.placeholder,type:"textarea",class:"the-curd-field",onInput:y[1]||(y[1]=f=>d())},null,8,["modelValue","readonly","disabled","placeholder"])):N("",!0),n.value.type==="input-between"?(s(),U(I,{key:2},[e(L,we({"model-value":n.value.value[0]},q(0),{class:"f1",onInput:y[2]||(y[2]=f=>C(f,0)),onBlur:y[3]||(y[3]=f=>J(0))}),null,16,["model-value"]),e(Z,{style:{padding:"0 6px"}},{default:l(()=>[A(oe(n.value.separator),1)]),_:1}),e(L,we({"model-value":n.value.value[1]},q(1),{class:"f1",onInput:y[4]||(y[4]=f=>C(f,1)),onBlur:y[5]||(y[5]=f=>J(1))}),null,16,["model-value"])],64)):N("",!0),n.value.type==="select"||n.value.type==="select-multiple"?(s(),U(I,{key:3},[n.value.options.length>50?(s(),E(T,we({key:0,modelValue:n.value.value,"onUpdate:modelValue":y[6]||(y[6]=f=>n.value.value=f),options:n.value.options,props:n.value.optionSetting},g(n.value),{onChange:y[7]||(y[7]=f=>d())}),null,16,["modelValue","options","props"])):(s(),E(P,we({key:1,modelValue:n.value.value,"onUpdate:modelValue":y[8]||(y[8]=f=>n.value.value=f)},g(n.value),{onChange:y[9]||(y[9]=f=>d())}),{default:l(()=>[(s(!0),U(I,null,le(n.value.options,f=>(s(),E(X,{key:f[m.value.value],value:f[m.value.value],label:f[m.value.label]},null,8,["value","label"]))),128))]),_:1},16,["modelValue"]))],64)):N("",!0),n.value.type==="checkbox"?(s(),U(I,{key:4},[e(a,{modelValue:n.value.value,"onUpdate:modelValue":y[10]||(y[10]=f=>n.value.value=f),disabled:t.disabled,onChange:y[11]||(y[11]=f=>d())},{default:l(()=>[(s(!0),U(I,null,le(n.value.options,f=>(s(),E($,{key:f[m.value.value],value:f[m.value.value]},{default:l(()=>[A(oe(f[m.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),t.editMode&&!n.value.options.length?(s(),E(Z,{key:0,type:"primary"},{default:l(()=>[A(oe(w(de).checkbox)+"（空数据） ",1)]),_:1})):N("",!0)],64)):N("",!0),n.value.type==="radio"?(s(),U(I,{key:5},[e(O,{modelValue:n.value.value,"onUpdate:modelValue":y[12]||(y[12]=f=>n.value.value=f),disabled:t.disabled,onChange:y[13]||(y[13]=f=>d())},{default:l(()=>[(s(!0),U(I,null,le(n.value.options,f=>(s(),E(k,{key:f[m.value.value],value:f[m.value.value]},{default:l(()=>[A(oe(f[m.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),t.editMode&&!n.value.options.length?(s(),E(Z,{key:0,type:"primary"},{default:l(()=>[A(oe(w(de).radio)+"（空数据） ",1)]),_:1})):N("",!0)],64)):N("",!0),n.value.type==="switch"?(s(),E(b,{key:6,modelValue:n.value.value,"onUpdate:modelValue":y[14]||(y[14]=f=>n.value.value=f),"inline-prompt":"","active-text":"是","inactive-text":"否",onChange:y[15]||(y[15]=f=>d())},null,8,["modelValue"])):N("",!0),n.value.type==="cascader"?(s(),E(c,{key:7,modelValue:n.value.value,"onUpdate:modelValue":y[16]||(y[16]=f=>n.value.value=f),options:n.value.options,props:v.value,placeholder:n.value.placeholder,disabled:t.disabled,clearable:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",class:"the-curd-field",onChange:y[17]||(y[17]=f=>d())},null,8,["modelValue","options","props","placeholder","disabled"])):N("",!0),n.value.type==="date"?(s(),E(B,{key:8,modelValue:n.value.value,"onUpdate:modelValue":y[18]||(y[18]=f=>n.value.value=f),placeholder:n.value.placeholder,type:n.value.dateType,format:n.value.formatShow,shortcuts:w(Fe)[n.value.dateType],disabled:t.disabled,"popper-class":n.value.id.toString(),"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"the-curd-field",onChange:i},null,8,["modelValue","placeholder","type","format","shortcuts","disabled","popper-class"])):N("",!0)],4)}}}),bt={key:0,class:"el-icon-rank el-icon--left"},ht={style:{"line-height":"1"}},_t={key:0,class:"the-curd-edit-mask f-vertical f-right"},wt=D("i",{class:"el-icon-delete el-icon--left"},null,-1),kt=D("i",{class:"el-icon-edit el-icon--left"},null,-1),xt=D("i",{class:"el-icon-plus"},null,-1),Vt={name:"Search"},Dt=ae({...Vt,props:{data:{type:Object,required:!0}},emits:["search"],setup(r,{emit:u}){const t=r,S=u,d=Ne(),n=ee(()=>d.editor.type==="search"&&!d.editor.show);function m(J){const g=t.data.list[J].label||t.data.list[J].key;ve({title:"操作提示",content:`是否删除【${g}】？`,cancelText:"取消",confirm(){t.data.list.splice(J,1)}})}function v(J){d.editor.index=J,d.editor.action="edit",d.editor.show=!0}function q(J){return d.editor.index===J&&d.editor.type==="search"&&d.editor.show}function Y(){d.editor.index=-1,d.editor.action="add",d.editor.show=!0}const{onDragStart:C,onDragMove:H,onDropEnd:K}=De({list:()=>t.data.list,key:"id",findLevel:5});return(J,g)=>{const W=h("el-button"),R=h("el-text");return s(),E(w(ut),{class:"the-curd-search","label-right":t.data.labelRight,"label-width":w(_e)(t.data.labelWidth)||"auto"},Te({content:l(()=>[e(Ve,{name:"the-group",tag:"div",class:"the-filter-content f1"},{default:l(()=>[(s(!0),U(I,null,le(t.data.list,(i,G)=>(s(),E(w(Ae),{key:i.id,"data-key":i.id,class:ce([{"the-curd-selected":q(G)},i.id]),label:i.label,"label-width":w(_e)(i.labelWidth),required:i.required,draggable:n.value,onDragstart:_=>w(C)(G),onDragover:_=>w(H)(_,G),onDrop:g[0]||(g[0]=_=>w(K)())},Te({default:l(()=>[e(xe,{"field-data":i,disabled:w(d).loading},null,8,["field-data","disabled"]),n.value?(s(),U("div",_t,[e(W,{link:"",type:"danger",onClick:_=>m(G)},{default:l(()=>[wt,A(" 删除 ")]),_:2},1032,["onClick"]),e(W,{link:"",type:"success",onClick:_=>v(G)},{default:l(()=>[kt,A(" 编辑 ")]),_:2},1032,["onClick"])])):N("",!0)]),_:2},[w(d).editor.type==="search"?{name:"label",fn:l(()=>[n.value?(s(),U("i",bt)):N("",!0),D("span",ht,oe(i.label),1)]),key:"0"}:void 0]),1032,["data-key","class","label","label-width","required","draggable","onDragstart","onDragover"]))),128)),n.value?(s(),E(w(Ae),{key:0},{default:l(()=>[t.data.list.length?N("",!0):(s(),E(R,{key:0,type:"info",style:{"margin-right":"12px"}},{default:l(()=>[A(" 请添加筛选条件~ ")]),_:1})),e(W,{type:"primary",circle:"",onClick:g[1]||(g[1]=i=>Y())},{default:l(()=>[xt]),_:1})]),_:1})):N("",!0)]),_:1})]),_:2},[w(d).editor.type?void 0:{name:"right",fn:l(()=>[e(w(st),{loading:w(d).loading,onSearch:g[2]||(g[2]=i=>S("search",i))},null,8,["loading"])]),key:"0"}]),1032,["label-right","label-width"])}}});function Xe(r){const u=r.onAction||(()=>{});return e(I,null,[e(h("el-button"),{link:!0,onClick:()=>u("exit")},{default:()=>[A("退出编辑")]}),e(h("el-button"),{type:"success",plain:!0,onClick:()=>u("copy")},{default:()=>[e("i",{class:"el-icon-document-copy el-icon--left"},null),A("复制JSON")]}),e(h("el-button"),{type:"primary",onClick:()=>u("complete")},{default:()=>[A("完成编辑")]})])}function $e(r){const u=r.onClose||(()=>{}),t=r.onSubmit||(()=>{});return e(I,null,[e(h("el-button"),{onClick:u},{default:()=>[A("取 消")]}),e(h("el-button"),{type:"primary",loading:r.loading,disabled:r.disabledSubmit,onClick:t},{default:()=>[A("确 认")]})])}function $t(r){const u={};return r.imageWidth&&(u.width=`${r.imageWidth}px`),r.imageHeight&&(u.height=`${r.imageHeight}px`),u}function Qe(r){function u(){dt({urls:r.previewList?r.previewList:[r.src]})}return r.column.cellType==="image"?e(h("el-image"),{class:"the-table-image",style:$t(r.column),src:r.src,onClick:u,fit:"cover"},null):null}function ye(r){return e(I,null,[r.label,e(h("el-tooltip"),{effect:"dark",content:r.tips,"raw-content":!0,placement:"top-start"},{default:()=>[e(h("el-button"),{type:"info",link:!0,style:"height: 32px;"},{default:()=>[e("i",{class:"el-icon-question"},null)]})]})])}function et(r){const u=r.onAction||(()=>{}),t=r.config,S=!!t.selectKey,d=t.formAdd&&t.formAdd.fields.length>0,n=t.formEdit&&t.formEdit.fields.length>0,m={on:"el-icon-success",off:"el-icon-remove-outline"},v=[{type:"delete",text:S?"修改删除":"配置删除",icon:S?m.on:m.off,style:S?"primary":"info"},{type:"add",text:d?"修改新增表单":"配置新增表单",icon:d?m.on:m.off,style:d?"primary":"info"},{type:"edit",text:n?"修改编辑表单":"配置编辑表单",icon:n?m.on:m.off,style:n?"primary":"info"}];return e("div",null,[r.editMode?e(I,null,[v.map(q=>e(h("el-button"),{type:q.style,link:!0,onClick:()=>u(q.type)},{default:()=>[e("i",{class:`el-icon--left ${q.icon}`},null),q.text]}))]):e(I,null,[S?e(h("el-button"),{type:"danger",link:!0,disabled:r.disabled,onClick:()=>u("delete")},{default:()=>[e("i",{class:"el-icon--left el-icon-delete"},null),A("删除")]}):null,d?e(h("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>u("add")},{default:()=>[e("i",{class:"el-icon--left el-icon-plus"},null),A("新增")]}):null,e(h("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>u("export")},{default:()=>[e("i",{class:"el-icon--left el-icon-download"},null),A("导出")]}),e(h("el-tooltip"),{effect:"dark",content:"配置表格展示、排序等操作",placement:"top-end"},{default:()=>[e(h("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>u("setting")},{default:()=>[e("i",{class:"el-icon--left el-icon-setting"},null),A("设置")]})]})])])}function St(){const r=Array.from({length:6}).map((u,t)=>({id:t}));return e("div",{class:"the-thumbnail-search flex"},[e("div",{class:"the-thumbnail-search-content f1"},[r.map(u=>e("div",{key:u.id,class:"the-thumbnail-search-item"},null))]),e("div",{class:"the-thumbnail-search-btn f-vertical"},[e("i",{class:"el-icon-search"},null)])])}function Ct(){return e("section",{class:"the-thumbnail-table"},[e("svg",{width:280,height:180,viewBox:`0 0 ${280*1} ${180*1}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","data-v-d2b0a988":"",class:"the-thumbnail-table-svg"},[e("rect",{width:280,height:180,fill:""},null),e("g",{filter:"url(#filter0_d_13550_224439)"},[e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V132C215 133.105 214.105 134 213 134H67C65.8954 134 65 133.105 65 132V60Z",fill:"var(--el-fill-color-blank)"},null),e("path",{d:"M67 57.7C65.7297 57.7 64.7 58.7297 64.7 60V132C64.7 133.27 65.7297 134.3 67 134.3H213C214.27 134.3 215.3 133.27 215.3 132V60C215.3 58.7297 214.27 57.7 213 57.7H67Z",stroke:"var(--el-border-color-dark)","stroke-width":.6*1},null)]),[76,92,108,124].map((S,d)=>e("rect",{key:d,x:71*1,y:S*1,width:16*1,height:4*1,rx:2*1,fill:"var(--el-color-primary)"},null)),[107,143,197].map((S,d)=>[76,92,108,124].map((n,m)=>e("rect",{key:`${d}-${m}`,x:S*1,y:n*1,width:d===2?12*1:20*1,height:4*1,rx:2*1,fill:"var(--el-border-color-dark)"},null))),e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V70H65V60Z",fill:"var(--el-border-color-light)"},null),[71,107,143,199].map(S=>e("rect",{key:S,x:S*1,y:63*1,width:10*1,height:2*1,rx:1*1,fill:"var(--el-border-color-dark)"},null)),[85.75,101.75,117.75].map((S,d)=>e("line",{key:d,x1:65*1,y1:S*1,x2:215*1,y2:S*1,stroke:"var(--el-border-color-light)","stroke-width":.5*1},null)),e("defs",null,[e("filter",{id:"filter0_d_13550_224439",x:"51.0666",y:"44.0671",width:177.867*1,height:103.866*1,filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},[e("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"},null),e("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"},null),e("feOffset",null,null),e("feGaussianBlur",{stdDeviation:6.66667*1},null),e("feComposite",{in2:"hardAlpha",operator:"out"},null),e("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"},null),e("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_13550_224439"},null),e("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_13550_224439",result:"shape"},null)])])])])}const Tt={key:0,class:"el-icon-rank el-icon--left",style:{"line-height":"32px"}},Et={class:"f-vertical w-full"},Ut=D("i",{class:"el-icon-edit"},null,-1),Mt=D("i",{class:"el-icon-delete"},null,-1),Ot={key:1},Nt=D("i",{class:"el-icon--left el-icon-delete"},null,-1),Bt=D("i",{class:"el-icon--left el-icon-finished"},null,-1),Ft=D("i",{class:"el-icon--left el-icon-plus"},null,-1),Lt={name:"TableForm"},tt=ae({...Lt,props:{config:{type:Object,default:()=>Ie()},type:{type:String},editMode:{type:Boolean},disabled:{type:Boolean}},emits:["change"],setup(r,{expose:u,emit:t}){const S=r,d=t,n=he(),m=Ie(),v=ne({config:m,form:{},rules:{}}),q=Ne(),Y=ee(()=>S.type==="add"?"新增":"编辑"),C=ee(()=>q.editor.show);function H(P){i(),q.editor.action=P>=0?"edit":"add",q.editor.form=v.config,q.editor.index=P,q.editor.show=!0}function K(P){const $=v.config.fields;i(),ve({title:"操作提示",content:`是否删除【${$[P].label}】？`,cancelText:"取消",confirm(){$.splice(P,1)}})}function J(){ve({title:"操作提示",content:`是否移除【${Y.value}】表单？移除后将不会出现对应功能按钮。`,cancelText:"取消",confirm(){v.config.fields=[]}})}function g(){d("change")}function W(){const P=S.type==="add"?"编辑":"新增";ve({title:"操作提示",content:`是否将表单数据同步到【${P}】表单？`,cancelText:"不同步",confirmText:"同步",cancel(){d("change",v.config)},confirm(){d("change",v.config,!0)}})}function R(P){var $;($=n.value)==null||$.validate(a=>{if(a&&P){const k=T.value,O={};X.value.forEach(b=>{O[b.key]=k[b.key]}),P(k,O)}})}function i(){var P;(P=n.value)==null||P.clearValidate()}function G(){v.config.fields.forEach(Be)}function _(P){v.config.fields.forEach($=>{if(Object.prototype.hasOwnProperty.call(P,$.key)){const a=P[$.key];if(!a)return;switch($.type){case"date":Q(a,"array")?$.value=a.map(k=>new Date(k)):$.value=new Date(a);break;default:$.value=a;break}}})}const{onDragStart:y,onDragMove:L,onDropEnd:Z}=De({list:()=>v.config.fields,key:"id",findLevel:10});ge(()=>S.config,function(P){P&&(v.config=se(P))},{immediate:!0}),ge(()=>v.config.fields,function(P){const $={},a={},k=["input","input-between","textarea"];P&&P.forEach(O=>{$[O.key]=O.value,O.required&&(a[O.key]=[{required:!0,validator(b,c,B){const f=[void 0,null,""];if(O.type==="input-between"&&!O.value[0]&&!O.value[1]){B(new Error("请输入两个范围字段"));return}if(O.valueType==="array"&&!O.value.length){B(new Error(O.placeholder||"请选择"));return}if(O.valueType!=="boolean"&&f.includes(O.value)){const o=k.includes(O.type)?"请输入内容":"请选择";B(new Error(O.placeholder||o));return}B()},trigger:k.includes(O.type)?"blur":"change"}])}),v.form=$,v.rules=a,setTimeout(i)},{immediate:!0});const T=ee(()=>{const P={};return v.config.fields.forEach($=>{P[$.key]=Ge($).value}),P}),X=ee(()=>v.config.fields.filter(P=>{const $=P.show;if(!$)return!0;if(Q($,"function"))return $(T.value);if($.includes("return"))try{return new Function("formData",$)(T.value)}catch(a){console.warn("解析表单展示逻辑代码错误 >>",a)}return!0}));return u({clear:i,validate:R,reset:G,setFormData:_}),(P,$)=>{const a=h("el-button"),k=h("el-form-item"),O=h("el-empty"),b=h("el-form");return s(),E(b,{ref_key:"formRef",ref:n,model:v.form,rules:v.rules,labelWidth:w(_e)(v.config.labelWidth),labelPosition:v.config.labelPosition,disabled:S.disabled,style:Se(S.editMode?{width:w(_e)(v.config.width)}:null),class:ce([{"is-edit-form":S.editMode}])},{default:l(()=>[S.editMode?(s(),U(I,{key:0},[e(Ve,{name:"the-group",tag:"div"},{default:l(()=>[(s(!0),U(I,null,le(v.config.fields,(c,B)=>(s(),E(k,{class:ce([{"the-curd-selected":w(q).editor.index===B&&C.value}]),prop:c.key,key:c.id,"data-key":c.id,draggable:v.config.fields.length>1&&!w(q).editor.show?!0:null,onDragstart:f=>w(y)(B),onDragover:f=>w(L)(f,B),onDrop:w(Z)},{label:l(()=>[v.config.fields.length>1&&!w(q).editor.show?(s(),U("i",Tt)):N("",!0),D("span",null,oe(c.label),1)]),default:l(()=>[D("div",Et,[e(xe,{class:"mgr-10",fieldData:c,editMode:""},null,8,["fieldData"]),e(a,{link:"",type:"success",disabled:C.value,onClick:f=>H(B)},{default:l(()=>[Ut]),_:2},1032,["disabled","onClick"]),e(a,{link:"",type:"danger",disabled:C.value,onClick:f=>K(B)},{default:l(()=>[Mt]),_:2},1032,["disabled","onClick"])])]),_:2},1032,["class","prop","data-key","draggable","onDragstart","onDragover","onDrop"]))),128))]),_:1}),v.config.fields.length?N("",!0):(s(),E(O,{key:0,description:`当前没有表单项，当没有表单项时【${Y.value}】功能按钮不会出现~`},null,8,["description"])),C.value?N("",!0):(s(),U("div",Ot,[e(a,{link:"",onClick:$[0]||($[0]=c=>g())},{default:l(()=>[A(" 退出编辑 ")]),_:1}),e(a,{type:"danger",link:"",disabled:!v.config.fields.length,onClick:$[1]||($[1]=c=>J())},{default:l(()=>[Nt,A(" 删除表单 ")]),_:1},8,["disabled"]),e(a,{type:"success",link:"",onClick:$[2]||($[2]=c=>W())},{default:l(()=>[Bt,A(" 完成表单 ")]),_:1}),e(a,{type:"primary",link:"",onClick:$[3]||($[3]=c=>H(-1))},{default:l(()=>[Ft,A(" 添加一项 ")]),_:1})]))],64)):N("",!0),!S.editMode&&v.config&&v.config.fields?(s(!0),U(I,{key:1},le(X.value,c=>(s(),E(k,{label:c.label,prop:c.key,key:c.id},{default:l(()=>[e(xe,{fieldData:c},null,8,["fieldData"])]),_:2},1032,["label","prop"]))),128)):N("",!0)]),_:1},8,["model","rules","labelWidth","labelPosition","disabled","style","class"])}}}),Wt={key:1,class:"f-vertical w-full"},qt=D("i",{class:"el-icon--right el-icon-question the-tips-icon"},null,-1),At={key:1,class:"f1 f-right"},Yt={name:"TableHeader"},lt=ae({...Yt,props:{column:{type:Object,required:!0}},emits:["sort"],setup(r,{emit:u}){const t=r,S=u,d=ee(()=>!t.column.sort&&!t.column.iconTips),n={true:{index:0,icon:"el-icon-sort"},asc:{index:1,icon:"el-icon-sort-up"},desc:{index:2,icon:"el-icon-sort-down"}},m=[!0,"asc","desc"];function v(){const q=t.column.sort.toString();let Y=n[q].index;Y++,Y>=m.length&&(Y=0);const C=m[Y];S("sort",t.column.prop,C)}return(q,Y)=>{const C=h("el-tooltip"),H=h("el-button");return d.value?(s(),U(I,{key:0},[A(oe(t.column.label),1)],64)):(s(),U("div",Wt,[D("span",null,oe(t.column.label),1),t.column.iconTips?(s(),E(C,{key:0,effect:"dark",content:t.column.iconTips,placement:"top"},{default:l(()=>[qt]),_:1},8,["content"])):N("",!0),t.column.sort?(s(),U("div",At,[e(H,{link:"",onClick:v},{default:l(()=>[D("i",{class:ce(["el-icon--right",n[t.column.sort.toString()].icon])},null,2)]),_:1})])):N("",!0)]))}}}),Jt={name:"TableColumnConfig"},jt=ae({...Jt,props:{show:{type:Boolean,required:!0},type:{type:String,required:!0},keys:{type:Array,required:!0},form:Object},emits:["update:show","submit"],setup(r,{emit:u}){const t=r,S=u,d=ne({show:!1,form:Me("","")}),n=ee(()=>`${t.type==="add"?"新增":"编辑"}表格列`),m=he(),v={label:{required:!0,message:"请输入表格列标题",trigger:"blur"},prop:{required:!0,validator(J,g,W){g?t.keys.includes(d.form.prop)?W(new Error("已经存在相同的值！")):W():W(new Error("输入字段不能为空！"))},trigger:"blur"},jsCode:{required:!0,validator(J,g,W){g?g.includes("return")?W():W(new Error('代码片段必须带有返回字段 "return"')):W(new Error("代码片段不能为空！"))},trigger:"blur"}},q=[{label:"默认普通文本",value:"text"},{label:"图片预览组件",value:"image"},{label:"自定义 js 代码",value:"js"}],Y=[{label:"不可排序",value:!1},{label:"可排序",value:!0},{label:"默认升序",value:"asc"},{label:"默认降序",value:"desc"}],C=`
<p>函数代码片段：</p>
<p>第一个参数${te("cellValue")}是表格值;</p>
<p>第二个参数${te("row")}是完整对象;</p>
<p>例如：${te("return cellValue + row.id;")};</p>
<p>也可以是HTML：${te("return `html 标签`")};</p>
`;function H(){S("update:show",!1)}function K(){var J;(J=m.value)==null||J.validate(g=>{if(!g)return;const W=se(d.form);["width","minWidth","imageWidth","imageHeight"].forEach(i=>{W[i]&&(W[i]=Number(W[i]))}),W.cellType==="image"&&(W.slot=W.prop),(W.sort||W.iconTips)&&(W.slotHead=`header-${W.prop}`),S("submit",W),H()})}return ge(()=>t.show,function(J){d.show=J,J&&(t.type==="add"?d.form=Me("",""):d.form=se(t.form),setTimeout(()=>{var g;return(g=m.value)==null?void 0:g.clearValidate()}))},{immediate:!0}),(J,g)=>{const W=h("el-input"),R=h("el-form-item"),i=h("el-input-number"),G=h("el-option"),_=h("el-select"),y=h("el-switch"),L=h("el-form"),Z=h("base-dialog");return s(),E(Z,{modelValue:d.show,"onUpdate:modelValue":g[11]||(g[11]=T=>d.show=T),title:n.value,width:"580px",onClose:H},{footer:l(()=>[e(w($e),{onClose:H,onSubmit:K})]),default:l(()=>[e(L,{ref_key:"formRef",ref:m,model:d.form,rules:v,"label-position":"right","label-width":"130px"},{default:l(()=>[e(R,{label:"表格列标题",prop:"label"},{default:l(()=>[e(W,{modelValue:d.form.label,"onUpdate:modelValue":g[0]||(g[0]=T=>d.form.label=T),clearable:"",placeholder:v.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(R,{label:"表格列键值",prop:"prop"},{default:l(()=>[e(W,{modelValue:d.form.prop,"onUpdate:modelValue":g[1]||(g[1]=T=>d.form.prop=T),clearable:"",placeholder:"请输入表格列键值"},null,8,["modelValue"])]),_:1}),e(R,{label:"表格列宽度",prop:"width"},{default:l(()=>[e(i,{modelValue:d.form.width,"onUpdate:modelValue":g[2]||(g[2]=T=>d.form.width=T),class:"w-full","controls-position":"right",placeholder:"请输入表格列宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(R,{label:"表格列最小宽度",prop:"minWidth"},{default:l(()=>[e(i,{modelValue:d.form.minWidth,"onUpdate:modelValue":g[3]||(g[3]=T=>d.form.minWidth=T),class:"w-full","controls-position":"right",placeholder:"请输入表格列最小宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(R,{label:"表格列展示类型",prop:"cellType"},{default:l(()=>[e(_,{modelValue:d.form.cellType,"onUpdate:modelValue":g[4]||(g[4]=T=>d.form.cellType=T)},{default:l(()=>[(s(),U(I,null,le(q,T=>e(G,{key:T.value,value:T.value,label:T.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),d.form.cellType==="image"?(s(),U(I,{key:0},[e(R,{label:"图片宽度(像素)",prop:"imageWidth"},{default:l(()=>[e(i,{modelValue:d.form.imageWidth,"onUpdate:modelValue":g[5]||(g[5]=T=>d.form.imageWidth=T),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1}),e(R,{label:"图片高度(像素)",prop:"imageHeight"},{default:l(()=>[e(i,{modelValue:d.form.imageHeight,"onUpdate:modelValue":g[6]||(g[6]=T=>d.form.imageHeight=T),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1})],64)):N("",!0),d.form.cellType==="js"?(s(),E(R,{key:1,prop:"jsCode"},{label:l(()=>[e(w(ye),{label:"js代码",tips:C})]),default:l(()=>[e(W,{modelValue:d.form.jsCode,"onUpdate:modelValue":g[7]||(g[7]=T=>d.form.jsCode=T),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1})):N("",!0),e(R,{label:"表格列排序操作",prop:"sort"},{default:l(()=>[e(_,{modelValue:d.form.sort,"onUpdate:modelValue":g[8]||(g[8]=T=>d.form.sort=T)},{default:l(()=>[(s(),U(I,null,le(Y,T=>e(G,{key:T.value.toString(),value:T.value,label:T.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(R,{label:"内容溢出截断",prop:"tooltip"},{default:l(()=>[e(y,{modelValue:d.form.tooltip,"onUpdate:modelValue":g[9]||(g[9]=T=>d.form.tooltip=T),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(R,{label:"表头图标提示文字",prop:"iconTips"},{default:l(()=>[e(W,{modelValue:d.form.iconTips,"onUpdate:modelValue":g[10]||(g[10]=T=>d.form.iconTips=T),clearable:"",placeholder:"请输入表头图标提示文字"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),It=D("p",{class:"mgb-10"},"表格数据中的字段，例如表格数：",-1),Pt=D("p",{class:"mgb-10"},"则键值可以为 id",-1),Ht=D("p",null,[D("i",{class:"el-icon-info el-icon--left"}),A(" 不填则没有删除功能 ")],-1),Rt={name:"TableDeleteConfig"},zt=ae({...Rt,props:{show:{type:Boolean,default:!1},selectKey:{type:String,default:""}},emits:["update:show","submit"],setup(r,{emit:u}){const t=r,S=u,d='[{ id: 1, name: "名称", status: 2 }]',n=ne({show:!1,keyword:""});function m(){S("update:show",!1)}function v(){m(),S("submit",n.keyword)}return ge(()=>t.show,function(q){n.show=q,q&&(n.keyword=t.selectKey||"")},{immediate:!0}),(q,Y)=>{const C=h("el-input"),H=h("el-form-item"),K=h("el-form"),J=h("base-dialog");return s(),E(J,{modelValue:n.show,"onUpdate:modelValue":Y[1]||(Y[1]=g=>n.show=g),title:"配置表格删除功能",width:"400px",onClose:m},{footer:l(()=>[e(w($e),{onClose:m,onSubmit:v})]),default:l(()=>[e(K,{labelPosition:"right",labelWidth:"120px"},{default:l(()=>[e(H,{label:"数据键值"},{default:l(()=>[e(C,{class:"mgb-10",modelValue:n.keyword,"onUpdate:modelValue":Y[0]||(Y[0]=g=>n.keyword=g),placeholder:"请输入数据键值",clearable:""},null,8,["modelValue"]),D("div",{class:"the-tag blue"},[It,D("p",{class:"mgb-10"},oe(d)),Pt,Ht])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Kt={class:"flex"},Gt={class:"f1"},Zt={class:"f-vertical w-full"},Xt={class:"f-right w-full"},Qt=D("i",{class:"el-icon--left el-icon-finished"},null,-1),el=D("i",{class:"el-icon--left el-icon-plus"},null,-1),tl=["data-key","draggable","onDragstart","onDragover"],ll={key:0,class:"el-icon--left el-icon-rank"},ol=D("div",{class:"f1"},null,-1),nl=D("i",{class:"el-icon-delete"},null,-1),al=D("i",{class:"el-icon-edit"},null,-1),il={key:1,class:"w-full f-right"},rl=D("i",{class:"el-icon--left el-icon-plus"},null,-1),sl={name:"TableActionConfig"},ul=ae({...sl,props:{show:{type:Boolean,default:!1},list:{type:Array,required:!0},columnWidth:{type:Number},actionMax:{type:Number}},emits:["update:show","submit"],setup(r,{emit:u}){const t=r,S=u,d=he(),n=he(),m=ne({show:!1,list:[],index:-1,hasEdit:!1,formEdit:!1}),v=ne({btn:Ce(),column:{width:160,max:3}}),q={width:{required:!0,message:"请输入表格列宽度，例如：160",trigger:"blur"},max:{required:!1,message:"请输入数量，超出用“更多”下拉展示",trigger:"blur"}},Y={text:{required:!0,message:"请输入按钮文字",trigger:"blur"},click:{required:!0,message:"请输入按钮操作代码",trigger:"blur"},icon:{required:!1,message:"请输入图标 class",trigger:"blur"},type:{required:!1,message:"请选择按钮类型",trigger:"change"}};function C(){S("update:show",!1)}function H(){n.value.validate($=>{if(!$)return;C();const{width:a,max:k}=v.column;S("submit",se(m.list),a,k)})}function K($){d.value.validate(a=>{if(!a)return;const k=se(v.btn);$==="add"?m.list.push(k):m.list[m.index]=v.btn,J()})}function J(){m.index=-1,v.btn=Ce(),m.formEdit=!1,setTimeout(()=>{var $;return($=d.value)==null?void 0:$.clearValidate()})}function g($){const a=m.list[$];v.btn=JSON.parse(JSON.stringify(a)),m.index=$,m.formEdit=!0}function W($){m.list.splice($,1)}ge(()=>t.show,function($){m.show=$,$&&(m.list=se(t.list),m.hasEdit=m.list.some(a=>a.key===fe),m.index=-1,v.btn=Ce(),v.column={width:t.columnWidth,max:t.actionMax},setTimeout(()=>{var a,k;(a=d.value)==null||a.clearValidate(),(k=n.value)==null||k.clearValidate()}))},{immediate:!0});const R=[{label:"默认（蓝色）",value:"primary"},{label:"成功（绿色）",value:"success"},{label:"警告（橙色）",value:"warning"},{label:"危险（红色）",value:"danger"},{label:"文本（灰色）",value:"info"}],i="https://element.eleme.cn/#/zh-CN/component/icon",{onDragStart:G,onDragMove:_,onDropEnd:y}=De({list:()=>m.list,key:"key"});function L($){if($.key!=fe&&m.list.length>1&&m.index===-1)return!0}function Z($){const a=$.text;if(Q(a,"string")){if(!a.includes("return"))return a;let k="文字配置有误";try{k=new Function("row",a)({})}catch(O){console.warn("解析按钮文字代码错误 >>",O)}return k}return Q(a,"function")?a({}):"未设置按钮"}const T=`
<p>可以输入代码片段，</p>
<p>以${te("return")}关键字为函数标记，</p>
<p>函数第一个参数${te("row")}是表格对象值</p>
<p>例如：${te('return row.status === 1 ? "下架" : "上架";')}</p>
`,X=`
<p>函数代码片段，点击的时候运行</p>
<p>函数第一个参数${te("row")}是表格对象值</p>
<p>第二个参数${te("index")}是当前索引</p>
<p>例如：${te("console.log(row, index);")}</p>
`,P=`
<p>可以输入代码片段，</p>
<p>以${te("return")}关键字为函数标记，</p>
<p>函数第一个参数${te("row")}是表格对象值</p>
<p>例如：${te("return row.status === 1;")}返回布尔值进行判断</p>
`;return($,a)=>{const k=h("el-text"),O=h("el-divider"),b=h("el-input-number"),c=h("el-form-item"),B=h("el-form"),f=h("el-input"),o=h("el-option"),x=h("el-select"),p=h("el-button"),F=h("el-popconfirm"),j=h("el-empty"),z=h("base-dialog");return s(),E(z,{modelValue:m.show,"onUpdate:modelValue":a[13]||(a[13]=M=>m.show=M),title:"配置操作列按钮功能",width:"880px",onClose:C},{footer:l(()=>[e(w($e),{disabledSubmit:m.formEdit,onClose:C,onSubmit:H},null,8,["disabledSubmit"])]),default:l(()=>[D("div",Kt,[D("section",Gt,[e(O,{"content-position":"left","border-style":"dashed"},{default:l(()=>[e(k,{type:"info"},{default:l(()=>[A("操作列配置")]),_:1})]),_:1}),e(B,{ref_key:"formColumn",ref:n,model:v.column,rules:q,labelPosition:"right",labelWidth:"128px"},{default:l(()=>[e(c,{label:"操作列宽度",prop:"width"},{default:l(()=>[e(b,{modelValue:v.column.width,"onUpdate:modelValue":a[0]||(a[0]=M=>v.column.width=M),class:"w-full","controls-position":"right",placeholder:q.width.message},null,8,["modelValue","placeholder"])]),_:1}),e(c,{label:"操作按钮限制",prop:"max"},{default:l(()=>[e(b,{modelValue:v.column.max,"onUpdate:modelValue":a[1]||(a[1]=M=>v.column.max=M),class:"w-full","controls-position":"right",min:2,placeholder:q.max.message},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),e(O,{"content-position":"left","border-style":"dashed"},{default:l(()=>[e(k,{type:"info"},{default:l(()=>[A("操作按钮配置")]),_:1})]),_:1}),e(B,{ref_key:"formBtn",ref:d,model:v.btn,rules:Y,labelPosition:"right",labelWidth:"128px",class:ce({"the-filter-mask":!m.formEdit}),"data-tips":"待新增或编辑操作"},{default:l(()=>[e(c,{prop:"text"},{label:l(()=>[e(w(ye),{label:"按钮文字",tips:T})]),default:l(()=>[e(f,{modelValue:v.btn.text,"onUpdate:modelValue":a[2]||(a[2]=M=>v.btn.text=M),type:"textarea",placeholder:Y.text.message},null,8,["modelValue","placeholder"])]),_:1}),e(c,{prop:"click"},{label:l(()=>[e(w(ye),{label:"按钮功能代码",tips:X})]),default:l(()=>[e(f,{modelValue:v.btn.click,"onUpdate:modelValue":a[3]||(a[3]=M=>v.btn.click=M),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1}),e(c,{prop:"show"},{label:l(()=>[e(w(ye),{label:"按钮显示条件",tips:P})]),default:l(()=>[e(f,{modelValue:v.btn.show,"onUpdate:modelValue":a[4]||(a[4]=M=>v.btn.show=M),type:"textarea",placeholder:"请输入条件代码，为空则默认显示"},null,8,["modelValue"])]),_:1}),e(c,{prop:"disabled"},{label:l(()=>[e(w(ye),{label:"按钮禁用条件",tips:P})]),default:l(()=>[e(f,{modelValue:v.btn.disabled,"onUpdate:modelValue":a[5]||(a[5]=M=>v.btn.disabled=M),type:"textarea",placeholder:"请输入条件代码，为空则默认不禁用"},null,8,["modelValue"])]),_:1}),e(c,{label:"按钮图标",prop:"icon"},{default:l(()=>[D("div",Zt,[e(f,{modelValue:v.btn.icon,"onUpdate:modelValue":a[6]||(a[6]=M=>v.btn.icon=M),placeholder:Y.icon.message,clearable:""},null,8,["modelValue","placeholder"]),e(k,{type:"primary",style:{width:"110px","text-align":"right"}},{default:l(()=>[D("a",{href:i,target:"_blank"},"去官网复制")]),_:1})])]),_:1}),e(c,{label:"按钮类型",prop:"type"},{default:l(()=>[e(x,{modelValue:v.btn.type,"onUpdate:modelValue":a[7]||(a[7]=M=>v.btn.type=M),placeholder:Y.type.message},{default:l(()=>[(s(),U(I,null,le(R,M=>e(o,{key:M.value,value:M.value,label:M.label},null,8,["value","label"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1}),e(c,null,{default:l(()=>[D("div",Xt,[e(p,{onClick:a[8]||(a[8]=M=>J())},{default:l(()=>[A("取 消")]),_:1}),m.index>-1?(s(),E(p,{key:0,type:"primary",plain:"",onClick:a[9]||(a[9]=M=>K("edit"))},{default:l(()=>[Qt,A(" 确认修改 ")]),_:1})):(s(),E(p,{key:1,type:"primary",plain:"",onClick:a[10]||(a[10]=M=>K("add"))},{default:l(()=>[el,A(" 确认新增 ")]),_:1}))])]),_:1})]),_:1},8,["model","class"])]),e(Ve,{name:"the-group",tag:"div",class:"the-curd-option-list f1"},{default:l(()=>[(s(!0),U(I,null,le(m.list,(M,ie)=>(s(),U("div",{class:ce(["the-curd-option-item f-vertical",{"the-curd-selected":ie===m.index}]),key:M.key,"data-key":M.key!==w(fe)?M.key:null,draggable:L(M),onDragstart:ue=>w(G)(ie),onDragover:ue=>w(_)(ue,ie),onDrop:a[11]||(a[11]=(...ue)=>w(y)&&w(y)(...ue))},[m.index===-1&&M.key!==w(fe)?(s(),U("i",ll)):N("",!0),e(p,{type:M.type,link:""},{default:l(()=>[M.icon?(s(),U("i",{key:0,class:ce(["el-icon--left",M.icon])},null,2)):N("",!0),A(" "+oe(Z(M)),1)]),_:2},1032,["type"]),ol,M.key===w(fe)?(s(),E(k,{key:1,type:"info",size:"small"},{default:l(()=>[A("编辑按钮不可删除、拖拽等操作，且处于首位")]),_:1})):(s(),U(I,{key:2},[e(F,{width:"186px",title:"是否删除该按钮功能？",onConfirm:ue=>W(ie)},{reference:l(()=>[e(p,{link:"",type:"danger",disabled:m.index>-1},{default:l(()=>[nl]),_:1},8,["disabled"])]),_:2},1032,["onConfirm"]),e(p,{link:"",type:"success",onClick:ue=>g(ie)},{default:l(()=>[al]),_:2},1032,["onClick"])],64))],42,tl))),128)),m.list.length?N("",!0):(s(),E(j,{key:"empty","image-size":120,description:"请添加操作列功能按钮"})),m.formEdit?N("",!0):(s(),U("div",il,[m.formEdit?N("",!0):(s(),E(p,{key:0,type:"primary",plain:"",onClick:a[12]||(a[12]=M=>m.formEdit=!0)},{default:l(()=>[rl,A(" 新增功能按钮 ")]),_:1}))]))]),_:1})])]),_:1},8,["modelValue"])}}}),dl={class:"the-curd-table-model the-curd-scrollbar"},cl=["data-key","draggable","onDragstart","onDragover"],pl={class:"fake-table-head f-vertical"},fl=D("i",{class:"el-icon-rank el-icon--left"},null,-1),ml={class:"fake-table-cell"},vl=D("i",{class:"el-icon-edit"},null,-1),yl=D("i",{class:"el-icon-delete"},null,-1),gl={class:"fake-table-cell f-vertical"},bl={key:1,class:"the-tag blue"},hl=D("div",{class:"fake-table-head fvc"},"操作",-1),_l={class:"fake-table-cell",style:{"text-align":"center"}},wl=D("i",{class:"el-icon-setting"},null,-1),kl=D("i",{class:"el-icon-delete"},null,-1),xl={class:"fake-table-cell"},Vl={class:"f-vertical",key:"fixed"},Dl=D("i",{class:"el-icon-plus el-icon--left"},null,-1),$l={key:0},Sl=D("i",{class:"el-icon-plus el-icon--left"},null,-1),Cl={name:"TableModel"},Tl=ae({...Cl,props:{config:{type:Object,required:!0}},emits:["action"],setup(r,{emit:u}){const t=r,S=u,d="https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",n=ne({show:!1,type:"add",index:-1,form:void 0,keys:[]}),m=ee(()=>{const a=t.config.columns,k=[],O=[];for(let b=0;b<a.length;b++){const c=a[b];c.prop===be?O.push(c):k.push(c)}return{drag:k,action:O}});function v(a,k){if(n.keys=t.config.columns.map(O=>O.prop),a==="edit"){const O=t.config.columns[k];n.keys=n.keys.filter(b=>b!==O.prop),n.index=k,n.form=O}else n.form=void 0;n.type=a,n.show=!0}function q(a){const k=t.config;if(n.type==="add"){const O=JSON.parse(JSON.stringify(m.value.drag));O.push(a),k.columns=O.concat(m.value.action)}else k.columns[n.index]=a}function Y(a){const k=m.value.drag[a];ve({title:"操作提示",content:`是否删除【${k.label}】列？`,cancelText:"取消",confirm(){const O=t.config.columns.findIndex(b=>b.prop===k.prop);t.config.columns.splice(O,1)}})}const{onDragStart:C,onDragMove:H,onDropEnd:K}=De({list:()=>t.config.columns,key:"prop",findLevel:5});function J(a){const k={};return a&&a.width&&(k.width=`${a.width}px`),a&&a.minWidth&&(k.minWidth=`${a.minWidth}px`),k}const g=ee(()=>{const a=t.config.columns;if(a.length>0&&a[a.length-1].prop===be)return a[a.length-1]});function W(){const a=Me(be,"操作");a.minWidth=120,a.width=160,t.config.columns.push(a)}function R(){const a=t.config.columns;ve({title:"操作提示",content:"是否删除操作列？删除之后需要重新配置。",cancelText:"取消",confirm(){a.splice(a.length-1,1),t.config.actions=[],t.config.formEdit&&(t.config.formEdit=void 0)}})}const i=ne({show:!1,keyword:""});function G(){const a=t.config.selectKey;i.keyword=a?a.toString():"",i.show=!0}function _(a){t.config.selectKey=a}const y=ne({show:!1,columnWidth:0,actionMax:0});function L(){y.show=!0,y.columnWidth=g.value.width,y.actionMax=t.config.actionMax}function Z(a,k){t.config.actions=a;const O=t.config.columns.find(b=>b.prop===be);O.width=k}const T=ne({show:!1,form:null,type:"add"});function X(a){T.type=a,a==="add"&&t.config.formAdd&&(T.form=t.config.formAdd),a==="edit"&&t.config.formEdit&&(T.form=t.config.formEdit),T.show=!0}function P(a,k){const O=t.config,b=O.actions;function c(){const B=b.length>0&&b[0].key===fe;a&&a.fields.length>0?(g.value||W(),B||b.unshift({key:fe,text:"编辑",type:"success",icon:"el-icon-edit"})):B&&b.splice(0,1)}a&&(T.type==="add"?(O.formAdd=a,k&&(O.formEdit=JSON.parse(JSON.stringify(a)),c())):(O.formEdit=a,k&&(O.formAdd=JSON.parse(JSON.stringify(a))),c())),T.show=!1,T.form=null}function $(a){switch(a){case"delete":G();break;case"add":X("add");break;case"edit":X("edit");break}}return(a,k)=>{const O=h("el-empty"),b=h("el-button"),c=h("el-tooltip"),B=h("base-table-actions"),f=h("el-text");return s(),U(I,null,[T.show?N("",!0):(s(),E(w(et),{key:0,class:"mgb-10 w-full",editMode:!0,config:t.config,onAction:$},null,8,["config"])),D("div",dl,[T.show?(s(),E(tt,{key:0,config:T.form,type:T.type,editMode:!0,onChange:P},null,8,["config","type"])):(s(),E(Ve,{key:1,name:"the-group",tag:"div",class:"fake-table"},{default:l(()=>[t.config.columns.length?N("",!0):(s(),E(O,{key:"empty",style:{padding:"10px 40px"},"image-size":120,description:"请添加表格列"})),(s(!0),U(I,null,le(m.value.drag,(o,x)=>(s(),U("div",{key:o.prop,"data-key":o.prop,class:"fake-table-item",draggable:m.value.drag.length>1,style:Se(J(o)),onDragstart:p=>w(C)(x),onDragover:p=>w(H)(p,x),onDrop:k[0]||(k[0]=p=>w(K)())},[D("div",pl,[fl,e(lt,{column:o},null,8,["column"])]),D("div",ml,[e(b,{circle:"",plain:"",type:"success",size:"small",onClick:p=>v("edit",x)},{default:l(()=>[vl]),_:2},1032,["onClick"]),e(b,{circle:"",plain:"",type:"danger",size:"small",onClick:p=>Y(x)},{default:l(()=>[yl]),_:2},1032,["onClick"])]),D("div",gl,[o.cellType==="text"?(s(),U(I,{key:0},[A("文本内容")],64)):o.cellType==="js"?(s(),U("span",bl,"自定义代码")):N("",!0),e(w(Qe),{column:o,src:d},null,8,["column"])])],44,cl))),128)),g.value?(s(),U("div",{style:Se(J(g.value)),key:w(be),class:"fake-table-item"},[hl,D("div",_l,[e(c,{effect:"dark",content:"配置【操作按钮】和【操作列】的宽度",placement:"top"},{default:l(()=>[e(b,{circle:"",plain:"",type:"primary",size:"small",onClick:k[1]||(k[1]=o=>L())},{default:l(()=>[wl]),_:1})]),_:1}),e(b,{circle:"",plain:"",type:"danger",size:"small",onClick:k[2]||(k[2]=o=>R())},{default:l(()=>[kl]),_:1})]),D("div",xl,[t.config.actions.length?(s(),E(B,{key:0,row:{},index:1,actions:t.config.actions},null,8,["actions"])):(s(),E(f,{key:1,type:"info"},{default:l(()=>[A("待添加操作~")]),_:1}))])],4)):N("",!0),D("div",Vl,[D("div",null,[D("p",null,[e(b,{type:"primary",text:"",onClick:k[3]||(k[3]=o=>v("add"))},{default:l(()=>[Dl,A(" 添加内容列 ")]),_:1})]),g.value?N("",!0):(s(),U("p",$l,[e(b,{type:"primary",text:"",onClick:k[4]||(k[4]=o=>W())},{default:l(()=>[Sl,A(" 添加操作列 ")]),_:1})]))])])]),_:1}))]),T.show?N("",!0):(s(),E(w(Xe),{key:1,type:T.type,onAction:k[5]||(k[5]=o=>S("action",o))},null,8,["type"])),e(jt,{show:n.show,"onUpdate:show":k[6]||(k[6]=o=>n.show=o),type:n.type,keys:n.keys,form:n.form,onSubmit:q},null,8,["show","type","keys","form"]),e(zt,{show:i.show,"onUpdate:show":k[7]||(k[7]=o=>i.show=o),"select-key":i.keyword,onSubmit:_},null,8,["show","select-key"]),e(ul,{show:y.show,"onUpdate:show":k[8]||(k[8]=o=>y.show=o),columnWidth:y.columnWidth,actionMax:y.actionMax,list:t.config.actions,onSubmit:Z},null,8,["show","columnWidth","actionMax","list"])],64)}}}),El={class:"the-curd-example"},Ul={name:"Example"},Ml=ae({...Ul,props:{selected:{type:String},type:{type:String}},emits:["choose"],setup(r,{emit:u}){const t=r,S=u,d=[{...re("input"),placeholder:de.input},{...re("select"),placeholder:de.select},{...re("select-multiple"),placeholder:de["select-multiple"]},{...re("cascader"),placeholder:de.cascader},{...re("date"),placeholder:de.date},{...re("checkbox"),options:[{label:"多选-A",value:1},{label:"多选-B",value:2}],defaultValue:[1]},{...re("radio"),options:[{label:"单选-A",value:"radio-1"},{label:"单选-B",value:"radio-2"}],defaultValue:"radio-1"},{...re("switch"),defaultValue:!0},{...re("textarea"),placeholder:de.textarea},{...re("input-between"),placeholder:["范围区间操作","范围区间操作"]}],n=["radio","checkbox","textarea","switch"],m=ee(()=>t.type==="search"?d.filter(v=>!n.includes(v.type)):d);return(v,q)=>(s(),U("div",El,[(s(!0),U(I,null,le(m.value,Y=>(s(),E(xe,{key:Y.type,"field-data":Y,class:ce(["the-curd-example-item fvc",{"the-curd-selected":t.selected===Y.type}]),readonly:"",onClick:C=>S("choose",Y.type)},null,8,["field-data","class","onClick"]))),128))]))}}),Ol={key:0,class:"the-curd-editor-content"},Nl=D("h2",{class:"the-title mgb-20"},"基础设置",-1),Bl={class:"f-vertical f-between mgb-20"},Fl=D("h2",{class:"the-title"},"第1步：点击选取组件",-1),Ll={class:"f-vertical mgb-20"},Wl={class:"the-title"},ql=D("div",{class:"f1"},null,-1),Al={key:0,class:"the-curd-target-box"},Yl=D("i",{class:"el-icon-question the-tips-icon mgl-10"},null,-1),Jl=D("a",{href:"https://www.json.cn/",target:"_blank"}," JSON编辑工具 ",-1),jl={class:"f-right"},Il=D("i",{class:"el-icon--left el-icon-plus"},null,-1),Pl=D("i",{class:"el-icon--left el-icon-edit"},null,-1),Hl={name:"Editor"},Rl=ae({...Hl,props:{show:{type:Boolean,default:!1},config:{type:Object,required:!0}},emits:["update:show"],setup(r,{emit:u}){const t=r,S=u;function d(){S("update:show",!1)}const n=["checkbox","radio","switch"],m=["select","select-multiple","radio","checkbox","cascader"],v=["input","textarea","select","radio"],q=["input-between","select-multiple","checkbox","cascader"],Y=["input","select","radio"],C=["daterange","datetimerange"],H=Y.concat(q),K=`<p>参考 src/utils/index.ts 中的${te("formatDate")}函数</p>`,J=`
<p>动态表单项的条件显示逻辑函数；</p>
<p>返回${te("false")}则不展示对应项；</p>
<p>函数有一个参数：${te("formData")}为当前表单的数据值；</p>
<p>以${te("return")}为函数代码片段标记；</p>
<p>例如：${te("return formData.type !== 2")}</p>
`,g=Ne(),W=ee(()=>g.editor.action==="add"),R=ee(()=>{let f=[];return i.formData&&i.formData.type==="date"&&(f=Fe[i.formData.dateType].map((x,p)=>({label:x.text,value:p}))),f.unshift({label:"将预览组件中的值设为默认",value:-1}),f}),i=ne({step:0,formData:void 0});function G(f){i.step=f}const _={label:{required:!0,message:"请输入功能标题",trigger:"blur"},key:{required:!0,trigger:"blur",validator(f,o,x){o?c.includes(o)?x(new Error("当前键值已经被占用！")):x():x(new Error("绑定的键值不能为空"))}},format:{required:!0,message:"格式化规则不能为空",trigger:"blur"},separator:{required:!0,message:"请输入串联符号",trigger:"blur"},defaultValue:{required:!0,trigger:"blur",validator(f,o,x){const p=X();p===!0?x():x(new Error(p)),x()}},options:{required:!0,trigger:"blur",validator(f,o,x){const p=P();p===!0?x():x(new Error(p))}}},y=he(),L=ne({options:"",defaultValue:""});function Z(f){f.type!=="date"&&(L.defaultValue=JSON.stringify({value:f.defaultValue})),m.includes(f.type)&&(L.options=JSON.stringify(f.options))}function T(f){var p;const o=g.editor,x=re(f,"",o.type==="search");i.formData=x,Z(x),(p=y.value)==null||p.clearValidate(),G(1)}function X(){const f='输入的格式必须为 { "value": "input value" }',o=L.defaultValue;if(!o)return f;const x=i.formData.type,p=i.formData.valueType,F=de[x];try{const j=JSON.parse(o);if(!Q(j,"object"))return f;if(x==="switch"&&!Q(j.value,"boolean"))return`${F}的绑定值应该为 boolean 类型`;if(q.includes(x)){if(!Q(j.value,"array"))return`${F}的绑定值应该为 array 类型`;if(p==="array<number>"&&j.value.some(z=>z!==""&&!Q(z,"number")))return"数组中只能出现数字"}if(v.includes(x)&&!["string","number"].includes(Ee(j.value)))return`${F}的绑定值应该为 string/number 类型`;if(x==="date"){const z=i.formData;if(C.includes(z.dateType)){if(!Q(j.value,"array"))return"范围日期绑定值应该为 array 类型"}else if(!Q(j.value,"string"))return"日期类型绑定值应该为 string 类型"}if(Y.includes(x)&&p==="number"&&j.value!==""&&!Q(j.value,"number"))return`${F}的绑定值应该为 number 类型`}catch(j){return console.warn("checkDefaultValue >>",j),f}return!0}function P(){const f=L.options;if(!f)return"选项数据不能为空！";try{const o=JSON.parse(f);if(!Q(o,"array"))return"选项数据格式不正确，需要为数组类型！";const x=i.formData,p=x.optionSetting.value||"value",F=[void 0,null];for(let j=0;j<o.length;j++){const z=o[j];if(!Q(z,"object"))return"数组项必须为对象！";if(F.includes(z[p]))return`数组项的值不能为${F.join("/")}`;if(["array<number>","number"].includes(x.valueType)&&!Q(z[p],"number")&&z[p]!=="")return"数组项的值必须为 number 类型"}return!0}catch(o){return console.warn("checkOptions >>",o),"不合法的JSON,注意使用双引号,结尾不能为逗号等"}}function $(){P()===!0&&(i.formData.options=JSON.parse(L.options))}function a(){if(X()===!0){const o=i.formData,x=JSON.parse(L.defaultValue).value;o.type!=="date"&&(o.defaultValue=x)}}function k(f){const o=Pe.find(p=>p.value===f),x=i.formData;x.shortcutIndex="",C.includes(o.value)?(x.value=[],x.valueType="array"):(x.value="",x.valueType="string"),x.formatShow=o.formatShow,x.format=o.format}function O(f){return/^[+-]?(\d|([1-9]\d+))(\.\d+)?$/.test(f)}function b(){var f;(f=y.value)==null||f.validate(o=>{if(ft("#the-editor-form",o),!o)return;a(),m.includes(i.formData.type)&&$();const x=g.editor,p=JSON.parse(JSON.stringify(i.formData));if(m.includes(p.type)&&$(),p.valueType||(p.valueType=Ee(p.defaultValue)),m.includes(p.type)&&["number","array<number>"].includes(p.valueType)){let j=p.optionSetting.value;j||(j="value",p.optionSetting.value=j);for(let z=0;z<p.options.length;z++){const M=p.options[z],ie=M[j];if([null,void 0].includes(ie))return pe.error("数据值字段与选项数据不匹配，请检查！");if(O(ie.toString()))M[j]=Number(ie);else{const ue=M[p.optionSetting.label];return pe.error(`选项数据中【${ue}】的值应该为数字！`)}}}p.type==="date"&&!Q(p.shortcutIndex,"number")&&(p.value=p.valueType==="array"?[]:""),{search(j){j?t.config.search.list.push(p):t.config.search.list[x.index]=p},table(j){if(j){const z=JSON.parse(JSON.stringify(x.form.fields));z.push(p),x.form.fields=z}else{const z=JSON.parse(JSON.stringify(x.form.fields));z[x.index]=p,x.form.fields=z}}}[x.type](W.value),d()})}let c=[];function B(f){const o=g.editor;c=[],{search(){c=t.config.search.list.map(p=>p.key)},table(){c=o.form.fields.map(p=>p.key)}}[o.type](),f&&(c=c.filter(p=>p!==f))}return ge(()=>t.show,function(f){if(!f){i.formData=void 0;return}const o=g.editor;if(o.action==="add")i.step=0,i.formData=void 0,B();else{const x=o.index;({search(){i.formData=JSON.parse(JSON.stringify(t.config.search.list[x]))},table(){var F;i.formData=JSON.parse(JSON.stringify((F=o.form)==null?void 0:F.fields[x]))}})[o.type](),Z(i.formData),B(i.formData.key),i.step=1}}),(f,o)=>{const x=h("el-input-number"),p=h("el-form-item"),F=h("el-switch"),j=h("el-form"),z=h("el-button"),M=h("el-input"),ie=h("el-text"),ue=h("el-tooltip"),Le=h("el-option"),We=h("el-select");return s(),U("section",{class:ce(["the-curd-editor the-curd-scrollbar",{"is-show":t.show}])},[e(it,{name:"the-curd-editor-move"},{default:l(()=>{var qe;return[t.show?(s(),U("div",Ol,[Nl,e(j,{"label-position":"right","label-width":"120px"},{default:l(()=>[w(g).editor.type==="search"?(s(),U(I,{key:0},[e(p,{label:"整体标题宽度"},{default:l(()=>[e(x,{modelValue:t.config.search.labelWidth,"onUpdate:modelValue":o[0]||(o[0]=V=>t.config.search.labelWidth=V),class:"w-full","controls-position":"right",placeholder:"例如：120px"},null,8,["modelValue"])]),_:1}),e(p,{label:"标题靠右对齐"},{default:l(()=>[e(F,{modelValue:t.config.search.labelRight,"onUpdate:modelValue":o[1]||(o[1]=V=>t.config.search.labelRight=V),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):N("",!0),w(g).editor.type==="table"&&w(g).editor.form?(s(),U(I,{key:1},[e(p,{label:"表单宽度"},{default:l(()=>[e(x,{modelValue:w(g).editor.form.width,"onUpdate:modelValue":o[2]||(o[2]=V=>w(g).editor.form.width=V),class:"w-full","controls-position":"right",placeholder:"请输入宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"文字宽度"},{default:l(()=>[e(x,{modelValue:w(g).editor.form.labelWidth,"onUpdate:modelValue":o[3]||(o[3]=V=>w(g).editor.form.labelWidth=V),class:"w-full","controls-position":"right",placeholder:"请输入标题宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"文字靠右排版"},{default:l(()=>[e(F,{modelValue:w(g).editor.form.labelPosition,"onUpdate:modelValue":o[4]||(o[4]=V=>w(g).editor.form.labelPosition=V),"inline-prompt":"","active-value":"right","inactive-value":"left","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):N("",!0)]),_:1}),i.step===0?(s(),U(I,{key:0},[D("div",Bl,[Fl,e(z,{link:"",type:"primary",onClick:o[5]||(o[5]=V=>d())},{default:l(()=>[A("退出编辑")]),_:1})]),e(Ml,{selected:(qe=i.formData)==null?void 0:qe.type,type:w(g).editor.type,onChoose:T},null,8,["selected","type"])],64)):N("",!0),i.step===1?(s(),U(I,{key:1},[D("div",Ll,[D("h2",Wl,"第2步：配置"+oe(w(de)[i.formData.type]),1),ql,e(z,{link:"",type:"success",onClick:o[6]||(o[6]=V=>G(0))},{default:l(()=>[A("上一步")]),_:1}),e(z,{link:"",type:"primary",onClick:o[7]||(o[7]=V=>d())},{default:l(()=>[A("退出编辑")]),_:1})]),i.formData?(s(),U("div",Al,[e(xe,{"field-data":i.formData,"edit-mode":""},null,8,["field-data"])])):N("",!0),i.formData?(s(),E(j,{key:1,id:"the-editor-form",ref_key:"formRef",ref:y,model:i.formData,rules:_,"label-position":"right","label-width":"128px"},{default:l(()=>[e(p,{label:"组件标题",prop:"label"},{default:l(()=>[e(M,{modelValue:i.formData.label,"onUpdate:modelValue":o[8]||(o[8]=V=>i.formData.label=V),clearable:"",placeholder:_.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(p,{label:"绑定的键值",prop:"key"},{default:l(()=>[e(M,{modelValue:i.formData.key,"onUpdate:modelValue":o[9]||(o[9]=V=>i.formData.key=V),clearable:"",placeholder:"请输入绑定的键值"},null,8,["modelValue"])]),_:1}),e(p,{label:"标题宽度",prop:"labelWidth"},{default:l(()=>[e(x,{modelValue:i.formData.labelWidth,"onUpdate:modelValue":o[10]||(o[10]=V=>i.formData.labelWidth=V),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：120"},null,8,["modelValue"])]),_:1}),n.includes(i.formData.type)?N("",!0):(s(),E(p,{key:0,label:"组件宽度",prop:"valueWidth"},{default:l(()=>[e(x,{modelValue:i.formData.valueWidth,"onUpdate:modelValue":o[11]||(o[11]=V=>i.formData.valueWidth=V),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：140"},null,8,["modelValue"])]),_:1})),e(p,{label:"提示/规则文字",prop:"placeholder"},{default:l(()=>[i.formData.type==="input-between"?(s(),U(I,{key:0},[e(M,{modelValue:i.formData.placeholder[0],"onUpdate:modelValue":o[12]||(o[12]=V=>i.formData.placeholder[0]=V),class:"f1",clearable:"",placeholder:"请输入提示-1"},null,8,["modelValue"]),e(ie,{style:{padding:"0 6px"}},{default:l(()=>[A("-")]),_:1}),e(M,{modelValue:i.formData.placeholder[1],"onUpdate:modelValue":o[13]||(o[13]=V=>i.formData.placeholder[1]=V),class:"f1",clearable:"",placeholder:"请输入提示-2"},null,8,["modelValue"])],64)):(s(),E(M,{key:1,modelValue:i.formData.placeholder,"onUpdate:modelValue":o[14]||(o[14]=V=>i.formData.placeholder=V),clearable:"",placeholder:"请输入规则提示/输入框提示文字"},null,8,["modelValue"]))]),_:1}),e(p,{label:"是否必填",prop:"required"},{default:l(()=>[e(F,{modelValue:i.formData.required,"onUpdate:modelValue":o[15]||(o[15]=V=>i.formData.required=V),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),w(H).includes(i.formData.type)?(s(),E(p,{label:"绑定值为数字类型",key:"is-number"},{default:l(()=>[q.includes(i.formData.type)?(s(),E(F,{key:0,modelValue:i.formData.valueType,"onUpdate:modelValue":o[16]||(o[16]=V=>i.formData.valueType=V),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"array<number>","inactive-value":"array"},null,8,["modelValue"])):(s(),E(F,{key:1,modelValue:i.formData.valueType,"onUpdate:modelValue":o[17]||(o[17]=V=>i.formData.valueType=V),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"number","inactive-value":"string"},null,8,["modelValue"])),m.includes(i.formData.type)?(s(),E(ue,{key:2,effect:"dark",content:"设为数字类型之后，将会在保存时校验选项数据",placement:"top"},{default:l(()=>[Yl]),_:1})):N("",!0)]),_:1})):N("",!0),i.formData.type!=="date"?(s(),E(p,{key:2,label:"组件默认值",prop:"defaultValue"},{default:l(()=>[e(M,{modelValue:L.defaultValue,"onUpdate:modelValue":o[18]||(o[18]=V=>L.defaultValue=V),type:"textarea",clearable:"",placeholder:"请输入JSON，值为 value",onBlur:o[19]||(o[19]=V=>a())},null,8,["modelValue"])]),_:1})):N("",!0),i.formData.type==="input-between"?(s(),E(p,{key:3,label:"串联符号",prop:"separator"},{default:l(()=>[e(M,{modelValue:i.formData.separator,"onUpdate:modelValue":o[20]||(o[20]=V=>i.formData.separator=V),clearable:"",placeholder:_.separator.message},null,8,["modelValue","placeholder"])]),_:1})):N("",!0),m.includes(i.formData.type)?(s(),U(I,{key:4},[e(p,{label:"选项数据",prop:"options"},{default:l(()=>[e(M,{modelValue:L.options,"onUpdate:modelValue":o[21]||(o[21]=V=>L.options=V),type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"请输入数组JSON",style:{"margin-bottom":"4px"},onBlur:o[22]||(o[22]=V=>$())},null,8,["modelValue"]),e(z,{link:"",type:"primary"},{default:l(()=>[Jl]),_:1})]),_:1}),e(p,{label:"数据展示字段",prop:"optionSetting.label"},{default:l(()=>[e(M,{modelValue:i.formData.optionSetting.label,"onUpdate:modelValue":o[23]||(o[23]=V=>i.formData.optionSetting.label=V),clearable:"",placeholder:"不填则使用 label"},null,8,["modelValue"])]),_:1}),e(p,{label:"数据值字段",prop:"optionSetting.value"},{default:l(()=>[e(M,{modelValue:i.formData.optionSetting.value,"onUpdate:modelValue":o[24]||(o[24]=V=>i.formData.optionSetting.value=V),clearable:"",placeholder:"不填则使用 value"},null,8,["modelValue"])]),_:1}),i.formData.type==="cascader"?(s(),U(I,{key:0},[e(p,{label:"下级字段",prop:"optionSetting.children"},{default:l(()=>[e(M,{modelValue:i.formData.optionSetting.children,"onUpdate:modelValue":o[25]||(o[25]=V=>i.formData.optionSetting.children=V),clearable:"",placeholder:"不填则使用 children"},null,8,["modelValue"])]),_:1}),e(p,{label:"是否多选",prop:"multiple"},{default:l(()=>[e(F,{modelValue:i.formData.multiple,"onUpdate:modelValue":o[26]||(o[26]=V=>i.formData.multiple=V),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(p,{label:"允许只选中某一项",prop:"checkStrictly"},{default:l(()=>[e(F,{modelValue:i.formData.checkStrictly,"onUpdate:modelValue":o[27]||(o[27]=V=>i.formData.checkStrictly=V),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):N("",!0)],64)):N("",!0),i.formData.type==="date"?(s(),U(I,{key:5},[e(p,{label:"日期类型",prop:"dateType"},{default:l(()=>[e(We,{modelValue:i.formData.dateType,"onUpdate:modelValue":o[28]||(o[28]=V=>i.formData.dateType=V),class:"w-full",onChange:k},{default:l(()=>[(s(!0),U(I,null,le(w(Pe),V=>(s(),E(Le,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"日期默认值",prop:"shortcutIndex"},{default:l(()=>[e(We,{modelValue:i.formData.shortcutIndex,"onUpdate:modelValue":o[29]||(o[29]=V=>i.formData.shortcutIndex=V),class:"w-full",placeholder:"请选择",clearable:""},{default:l(()=>[(s(!0),U(I,null,le(R.value,V=>(s(),E(Le,{key:V.value,label:V.label,value:V.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{prop:"format"},{label:l(()=>[e(w(ye),{label:"格式化规则",tips:K})]),default:l(()=>[e(M,{modelValue:i.formData.format,"onUpdate:modelValue":o[30]||(o[30]=V=>i.formData.format=V),clearable:"",placeholder:_.format.message},null,8,["modelValue","placeholder"])]),_:1})],64)):N("",!0),w(g).editor.type==="table"?(s(),E(p,{key:6,prop:"show"},{label:l(()=>[e(w(ye),{label:"表单显示逻辑",tips:J})]),default:l(()=>[e(M,{modelValue:i.formData.show,"onUpdate:modelValue":o[31]||(o[31]=V=>i.formData.show=V),type:"textarea",placeholder:"请输入条件代码，为空则默认展示"},null,8,["modelValue"])]),_:1})):N("",!0),D("div",jl,[e(z,{onClick:o[32]||(o[32]=V=>d())},{default:l(()=>[A("关闭")]),_:1}),W.value?(s(),E(z,{key:0,type:"primary",onClick:o[33]||(o[33]=V=>b())},{default:l(()=>[Il,A(" 新增 ")]),_:1})):(s(),E(z,{key:1,type:"success",onClick:o[34]||(o[34]=V=>b())},{default:l(()=>[Pl,A(" 确认 ")]),_:1}))])]),_:1},8,["model"])):N("",!0)],64)):N("",!0)])):N("",!0)]}),_:1})],2)}}}),zl=["data-key","onDragstart","onDragover"],Kl=D("i",{class:"el-icon--left el-icon-rank"},null,-1),Gl={class:"f1"},Zl={name:"TableSetting"},Xl=ae({...Zl,props:{show:{type:Boolean,default:!1},columns:{type:Array,required:!0}},emits:["update:show","submit"],setup(r,{emit:u}){const t=r,S=u,d=[{label:"固定左边",value:"left"},{label:"默认",value:!1},{label:"固定右边",value:"right"}],n=ne({show:!1,list:[]}),{onDragStart:m,onDragMove:v,onDropEnd:q}=De({list:()=>n.list,key:"prop"});let Y;function C(){S("update:show",!1)}function H(){C();const K=se(n.list);Y&&K.push(Y),S("submit",K)}return ge(()=>t.show,function(K){if(n.show=K,!K)return;const J=se(t.columns),g=[];for(let W=0;W<J.length;W++){const R=J[W];R.prop===be?Y=R:g.push(R)}n.list=g},{immediate:!0}),(K,J)=>{const g=h("el-radio-button"),W=h("el-radio-group"),R=h("el-switch"),i=h("el-empty"),G=h("base-dialog");return s(),E(G,{modelValue:n.show,"onUpdate:modelValue":J[1]||(J[1]=_=>n.show=_),title:"表格设置",width:"840px",onClose:C},{footer:l(()=>[e(w($e),{onClose:C,onSubmit:H})]),default:l(()=>[e(Ve,{name:"the-group",tag:"div"},{default:l(()=>[(s(!0),U(I,null,le(n.list,(_,y)=>(s(),U("div",{class:"the-curd-option-item f-vertical",key:_.prop,"data-key":_.prop,draggable:!0,onDragstart:L=>w(m)(y),onDragover:L=>w(v)(L,y),onDrop:J[0]||(J[0]=(...L)=>w(q)&&w(q)(...L))},[Kl,D("span",Gl,oe(_.label),1),e(W,{modelValue:_.fixed,"onUpdate:modelValue":L=>_.fixed=L,size:"small",class:"mgr-10"},{default:l(()=>[(s(),U(I,null,le(d,L=>e(g,{key:L.value.toString(),value:L.value},{default:l(()=>[A(oe(L.label),1)]),_:2},1032,["value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(R,{modelValue:_.visible,"onUpdate:modelValue":L=>_.visible=L,"inline-prompt":"","active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue","onUpdate:modelValue"])],40,zl))),128)),n.list.length?N("",!0):(s(),E(i,{key:"empty","image-size":120,description:"暂无可以设置的表格列"}))]),_:1})]),_:1},8,["modelValue"])}}}),Ql={class:"the-curd-main-page"},eo={class:"f-vertical mgb-10"},to={key:0,class:"the-tag blue"},lo=D("div",{class:"f1"},null,-1),oo=D("i",{class:"el-icon-arrow-left"},null,-1),no=D("p",{class:"mgb-10"},"配置筛选相关功能",-1),ao=D("p",null,"配置表格相关功能",-1),io={name:"Curd"},fo=ae({...io,props:{data:{type:Object,required:!0},action:{type:Object,required:!0}},setup(r){const u=r,t=ne({loading:!1,editor:{show:!1,type:void 0,form:void 0,action:"add",index:-1},showEntrance:!1}),S=ee(()=>{const b=t.editor.type;return b==="search"||!b&&u.data.search.list.length>0});rt(ze,t);let d;function n(b){t.editor.type=b,t.editor.show=!1,t.editor.index=-1,t.showEntrance=!1,d={[b]:se(u.data[b])}}function m(b){const c=t.editor.type;b&&d&&(u.data[c]=d[c]),t.editor.index=-1,t.editor.show=!1,t.editor.type=void 0,t.editor.form=void 0,d=void 0}function v(){m()}function q(){Je(JSON.stringify(u.data),()=>pe.success("复制成功！"))}function Y(b){b==="reset"&&u.data.search.list.forEach(Be),C.pageInfo.currentPage=1,C.selectList=[],X()}const C=ne({selectList:[],data:[],pageInfo:ct(),formShow:!1,formType:"add",formLoading:!1}),H=ee(()=>u.data.table),K=ee(()=>H.value.columns.filter(c=>c.visible).map(c=>{const B={...c};return B.cellType==="js"&&B.jsCode&&(B.rawContent=function(f,o){let x="";try{x=new Function("cellValue","row",B.jsCode)(f,o)}catch(p){console.warn("解析 rawContent 代码错误 >>",p),x="-"}return x}),B})),J=ee(()=>H.value.actions.map(c=>{const B={...c};return B.key===fe&&(B.click=y),B})),g=ee(()=>{const b=[],c=[];return K.value.forEach(B=>{B.slotHead&&b.push(B.slotHead),B.slot&&c.push(B.slot)}),{head:b,cell:c}});function W(b){return H.value.columns.find(B=>B.prop===b)||{}}const R=he(),i=ee(()=>{const b=H.value,c={title:"编辑表单",config:b.formEdit||{}};return C.formType==="add"&&(c.title="新增表单",c.config=b.formAdd||{}),c});let G=null;function _(){var b;G&&((b=R.value)==null||b.setFormData(G))}function y(b){b?(C.formType="edit",G=b):C.formType="add",C.formShow=!0,setTimeout(()=>{var c;return(c=R.value)==null?void 0:c.clear()})}function L(){var b;C.formShow=!1,(b=R.value)==null||b.reset(),G=null}function Z(){var b;(b=R.value)==null||b.validate(async(c,B)=>{if(C.formType==="add"&&u.action.onAdd){C.formLoading=!0;const f=await u.action.onAdd(c,B);if(C.formLoading=!1,f.code!==1)return;L(),X()}if(C.formType==="edit"&&u.action.onEdit){C.formLoading=!0;const f=await u.action.onEdit(c,B);if(C.formLoading=!1,f.code!==1)return;L(),X()}})}function T(b){const c=u.data.search.list,B={};for(let p=0;p<c.length;p++){const F=c[p],j=Ge(F);if(F.required&&Q(j.result,"string"))return mt(document.querySelector(`.${F.id}`)),pe.error(j.result),b&&b.key==="page"&&(C.pageInfo=b.before),null;j.result===!0&&(B[F.key]=j.value)}const f=H.value.columns,o=[],x=[];return b&&b.key==="sort"?f.forEach(p=>{p.sort&&(p.prop===b.prop?p.sort=b.action:p.sort=!0),p.sort==="asc"&&o.push(p.prop),p.sort==="desc"&&x.push(p.prop)}):f.forEach(p=>{p.sort==="asc"&&o.push(p.prop),p.sort==="desc"&&x.push(p.prop)}),o.length&&(B.asc=o.toString()),x.length&&(B.desc=x.toString()),B}async function X(b){const c=T(b);if(!c)return;const B=JSON.parse(JSON.stringify(C.pageInfo));t.loading=!0;const f=await u.action.getTableData(c,B);t.loading=!1,f.code===1&&(C.pageInfo.total=f.data.total,C.data=f.data.list||[])}function P(b){const c=C.selectList;switch(b){case"add":y();break;case"delete":if(!c.length)return pe.error("请选择要删除的列表再进行操作~");ve({title:"操作提示",content:`是否删除选中的 ${c.length} 条数据？`,cancelText:"取消",async confirm(){u.action.onDelete?(t.loading=!0,(await u.action.onDelete(JSON.parse(JSON.stringify(C.selectList)))).code===1?(pe.success("删除成功！"),C.selectList=[],X()):t.loading=!1):pe.info("请设置 action.onDelete 删除逻辑")}});break;case"setting":k();break;case"export":u.action.onExport?u.action.onExport():pe.info("请设置 action.onExport 导出逻辑");break}}function $(b){({exit:()=>m(!0),copy:q,complete:v})[b]()}const a=ne({show:!1});function k(){a.show=!0}function O(b){H.value.columns=b}return yt({formatDate:Ue,copyText:Je,messageBox:ve,message:pe,jsonToPath:pt,request:vt,getData:X,state:t}),Re(function(){u.action.created&&H.value.columns.length&&u.action.created(X)}),(b,c)=>{const B=h("base-table"),f=h("base-pagination"),o=h("el-button"),x=h("el-empty"),p=h("base-dialog");return s(),U("div",Ql,[D("section",{class:ce([t.editor.show?"f1":"w-full"])},[S.value?(s(),E(Dt,{key:0,data:u.data.search,onSearch:Y},null,8,["data"])):N("",!0),t.editor.type==="table"?(s(),E(Tl,{key:1,config:H.value,onAction:$},null,8,["config"])):t.editor.type==="search"?(s(),E(w(Xe),{key:2,onAction:$})):(s(),U(I,{key:3},[H.value.columns.length>0?(s(),U(I,{key:0},[D("div",eo,[H.value.selectKey?(s(),U("span",to," 已选择 "+oe(C.selectList.length)+" 条数据 ",1)):N("",!0),lo,e(w(et),{config:H.value,disabled:t.loading,onAction:P},null,8,["config","disabled"])]),e(B,{"select-list":C.selectList,"onUpdate:selectList":c[1]||(c[1]=F=>C.selectList=F),data:C.data,columns:K.value,actions:J.value,actionMax:H.value.actionMax,loading:t.loading,"select-key":H.value.selectKey},Te({_:2},[le(g.value.head,F=>({name:F,fn:l(({$index:j})=>[e(lt,{column:K.value[H.value.selectKey?j-1:j],onSort:c[0]||(c[0]=(z,M)=>X({key:"sort",prop:z,action:M}))},null,8,["column"])])})),le(g.value.cell,F=>({name:F,fn:l(({row:j})=>[e(w(Qe),{column:W(F),src:j[F],previewList:g.value.cell.map(z=>j[z])},null,8,["column","src","previewList"])])}))]),1032,["select-list","data","columns","actions","actionMax","loading","select-key"]),e(f,{disabled:t.loading,pageInfo:C.pageInfo,onChange:c[2]||(c[2]=F=>X({key:"page",...F}))},null,8,["disabled","pageInfo"])],64)):(s(),E(x,{key:1,description:"当前页面没有表格配置数据，请配置后再操作~"},{default:l(()=>[e(o,{type:"primary",onClick:c[3]||(c[3]=F=>n("table"))},{default:l(()=>[A("去配置")]),_:1})]),_:1}))],64))],2),e(Rl,{show:t.editor.show,"onUpdate:show":c[4]||(c[4]=F=>t.editor.show=F),config:u.data},null,8,["show","config"]),e(p,{modelValue:C.formShow,"onUpdate:modelValue":c[7]||(c[7]=F=>C.formShow=F),title:i.value.title,width:w(_e)(i.value.config.width),onClose:c[8]||(c[8]=F=>L()),onAfterEnd:c[9]||(c[9]=F=>_())},{footer:l(()=>[e(w($e),{loading:C.formLoading,onClose:c[5]||(c[5]=F=>L()),onSubmit:c[6]||(c[6]=F=>Z())},null,8,["loading"])]),default:l(()=>[e(tt,{ref_key:"formRef",ref:R,config:i.value.config,type:C.formType,disabled:C.formLoading},null,8,["config","type","disabled"])]),_:1},8,["modelValue","title","width"]),e(Xl,{show:a.show,"onUpdate:show":c[10]||(c[10]=F=>a.show=F),columns:H.value.columns,onSubmit:O},null,8,["show","columns"]),!t.showEntrance&&!t.editor.type?(s(),E(o,{key:0,class:"the-curd-entrance",type:"primary",size:"small",onClick:c[11]||(c[11]=F=>t.showEntrance=!0)},{default:l(()=>[oo]),_:1})):N("",!0),e(p,{modelValue:t.showEntrance,"onUpdate:modelValue":c[15]||(c[15]=F=>t.showEntrance=F),title:"请选择配置操作",width:"600px"},{footer:l(()=>[e(o,{onClick:c[14]||(c[14]=F=>t.showEntrance=!1)},{default:l(()=>[A("关 闭")]),_:1})]),default:l(()=>[D("div",{class:"the-curd-entrance-item",onClick:c[12]||(c[12]=F=>n("search"))},[no,e(w(St))]),D("div",{class:"the-curd-entrance-item",onClick:c[13]||(c[13]=F=>n("table"))},[ao,e(w(Ct))])]),_:1},8,["modelValue"])])}}});export{fo as _,Me as a,fe as b,be as c,re as g};
