import{P as te,_ as K,O as E,Q as U,R as P,v as oe,U as ae}from"./index-CQ1s9NXW.js";import{d as L,h as y,j as i,c as a,q as l,D as q,G as Z,y as f,C as G,k as F,p as _,z as J,t as A,b as d,u as k,Y as le,Z as ne,r as R,g as Q,w as se,l as S,e as g,F as X,aC as ie,aD as re,x as H}from"./element-plus-HQxsU011.js";const de=p=>(le("data-v-c3bd346e"),p=p(),ne(),p),pe={class:"drawer"},ue={class:"drawer-header f-vertical"},me={key:0,class:"f1"},ce={key:1,class:"f1"},fe=de(()=>f("i",{class:"el-icon-close"},null,-1)),ye=[fe],he={class:"content"},_e={key:0,class:"drawer-footer"},be={name:"Drawer"},ge=L({...be,props:{zIndex:{type:[Number,String],default:0},size:{type:String,default:"30%"},show:{type:Boolean,default:!1},title:{type:String,default:""},backgroundColor:{type:String,default:""}},emits:["update:show","close"],setup(p,{emit:v}){const m=v,$=te();function w(){m("close"),m("update:show",!1)}return(h,c)=>{const C=d("el-scrollbar");return i(),y("section",pe,[a(G,{name:"fade"},{default:l(()=>[q(f("div",{class:"wrap",style:F({zIndex:Number(p.zIndex)||k($)})},[f("div",{class:"f1",onClick:c[0]||(c[0]=V=>w())}),a(G,{name:"drawer-slide"},{default:l(()=>[q(f("div",{class:"drawer-slide-box",style:F({width:p.size})},[f("div",ue,[h.$slots.header?(i(),y("div",me,[J(h.$slots,"header",{},void 0,!0)])):(i(),y("div",ce,A(p.title),1)),f("button",{class:"close-btn",onClick:c[1]||(c[1]=V=>w())},ye)]),a(C,{class:"drawer-body f1",style:F({"background-color":p.backgroundColor})},{default:l(()=>[f("div",he,[J(h.$slots,"default",{},void 0,!0)])]),_:3},8,["style"]),h.$slots.footer?(i(),y("div",_e,[J(h.$slots,"footer",{},void 0,!0)])):_("",!0)],4),[[Z,p.show]])]),_:3})],4),[[Z,p.show]])]),_:3})])}}}),ve=K(ge,[["__scopeId","data-v-c3bd346e"]]),we={key:0,class:"fvc mr-[10px]"},ke={name:"Form"},$e=L({...ke,props:{show:{type:Boolean,default:!1},type:{type:String},form:{type:Object,default:()=>({})}},emits:["update:show","submit"],setup(p,{emit:v}){const m=p,$=v;function w(){return{code:"",redirect:"",path:"",component:"",name:"",sort:1,meta:{title:"",link:"",icon:"",hidden:!1,keepAlive:!1,type:"menu",status:1,lang:""}}}const h={component:`<p>路径规则为："src/views/${U("${component}")}.vue"</p><p>${U("component")}就是要填写的路径</p>`,lang:`
  <p>参考 src/language/zh.ts 中的语言对象结构</p>
  <p>比如 ${U("login.account")}、${U("languageSetting")} 等</p>
  `},c={"meta.icon":{validator(o,e,n){!t.formData.parentId&&!e?n(new Error("首级菜单必需设置图标")):n()}},"meta.title":{required:!0,message:"请输入名称",trigger:"blur"},code:{required:!0,message:"请输入权限标识",trigger:"blur"},name:{trigger:"blur",validator(o,e,n){t.formData.meta.keepAlive&&!e?n(new Error("当设置路由缓存时，必需设置路由名称！")):n()}}},C=[{label:"菜单名称",prop:"meta.title",type:"input",placeholder:c["meta.title"].message},{label:"菜单权限标识",prop:"code",type:"input",placeholder:c.code.message},{label:"路由路径",prop:"path",type:"input",placeholder:"请确保路径唯一性，如不填，则在提交时自动设置"},{label:"视图组件路径",prop:"component",type:"input",placeholder:"当为目录时可以不用填",tooltip:h.component},{label:"重定向路径",prop:"redirect",type:"input",placeholder:"当为目录且不填时，则默认拿下级第一项作为该值"}],V=[{label:"菜单排序",prop:"sort",type:"number",placeholder:"请输入排序值",min:1},{label:"菜单隐藏",prop:"meta.hidden",type:"switch"},{label:"是否需要路由缓存",prop:"meta.keepAlive",type:"switch"},{label:"路由名称",prop:"name",type:"input",placeholder:"请确保名称唯一性，否则路由缓存匹配会异常"},{label:"设置为外链",prop:"meta.link",type:"input",placeholder:"设置外链时则覆盖路由路径"},{label:"多语言设置",prop:"meta.lang",type:"input",placeholder:"请输入语言配置表中的键值",tooltip:h.lang}],O=[{label:"权限标识",prop:"code",type:"input",placeholder:"请输入权限标识"},{label:"权限名称",prop:"meta.title",type:"input",placeholder:c["meta.title"].message},{label:"权限状态",prop:"meta.status",type:"select",options:[{label:"正常",value:1},{label:"停用",value:2}]}],t=R({show:!1,loading:!1,formData:w(),showIcon:!1});function s(){$("update:show",!1)}const r=Q();function b(){console.log("formData >>",JSON.parse(JSON.stringify(t.formData))),r.value.validate(o=>{if(oe(".menu-form",o),!!o){if(t.formData.meta.type==="auth"&&!t.formData.parentId){ie.error("功能权限必需选择上级菜单！");return}t.formData.parentId||(t.formData.component="Layout"),t.formData.path||(t.formData.path=`/auto-set-${Date.now()}`),$("submit",JSON.parse(JSON.stringify(t.formData))),s()}})}const D=new Array(10).fill(0).map((o,e)=>{const n=e+1;return{value:n,label:`菜单-${n}`,children:new Array(6).fill(0).map((z,N)=>{const B=n*20+N;return{value:B,label:`菜单-${B}`}})}});function I(){t.formData.meta.status=1}function x(){window.open("https://icones.netlify.app/collection/tdesign","_blank")}return se(()=>m.show,function(o){t.show=o,o&&(t.formData=m.type==="edit"?JSON.parse(JSON.stringify(m.form)):w(),r.value&&setTimeout(()=>r.value.clearValidate()))},{immediate:!0}),(o,e)=>{const n=d("el-tree-select"),z=d("el-form-item"),N=d("el-radio-button"),B=d("el-radio-group"),M=d("el-text"),j=d("el-divider"),Y=d("el-input"),W=d("el-icon"),T=d("el-button"),ee=d("el-form");return i(),S(k(ve),{title:m.type==="edit"?"编辑菜单":"添加菜单",show:t.show,"onUpdate:show":e[7]||(e[7]=u=>t.show=u),size:"620px",onClose:e[8]||(e[8]=u=>s())},{footer:l(()=>[a(T,{onClick:e[5]||(e[5]=u=>s())},{default:l(()=>[g("取 消")]),_:1}),a(T,{onClick:e[6]||(e[6]=u=>b()),type:"primary"},{default:l(()=>[g("确 认")]),_:1})]),default:l(()=>[a(ee,{"label-position":"left","label-width":"128px",class:"menu-form",ref_key:"formRef",ref:r,model:t.formData,rules:c},{default:l(()=>[a(z,{label:"上级菜单",prop:"parentId"},{default:l(()=>[a(n,{modelValue:t.formData.parentId,"onUpdate:modelValue":e[0]||(e[0]=u=>t.formData.parentId=u),placeholder:"请选择上级菜单",data:k(D),"check-strictly":"","render-after-expand":!1,clearable:"",filterable:""},null,8,["modelValue","data"])]),_:1}),a(z,{label:"类型",prop:"meta.type"},{default:l(()=>[a(B,{modelValue:t.formData.meta.type,"onUpdate:modelValue":e[1]||(e[1]=u=>t.formData.meta.type=u),onChange:e[2]||(e[2]=u=>I())},{default:l(()=>[a(N,{label:"菜单",value:"menu"}),a(N,{label:"权限功能",value:"auth"})]),_:1},8,["modelValue"])]),_:1}),t.formData.meta.type==="menu"?(i(),y(X,{key:0},[a(j,{"content-position":"left","border-style":"dashed"},{default:l(()=>[a(M,{type:"info"},{default:l(()=>[g("基础配置")]),_:1})]),_:1}),a(k(E),{data:t.formData,list:C},null,8,["data"]),a(z,{label:"菜单图标",prop:"meta.icon"},{default:l(()=>[a(Y,{class:"f1 mr-[10px]",modelValue:t.formData.meta.icon,"onUpdate:modelValue":e[3]||(e[3]=u=>t.formData.meta.icon=u),clearable:"",placeholder:"请选择或者输入图标"},null,8,["modelValue"]),t.formData.meta.icon?(i(),y("div",we,[a(W,{size:20,style:{color:"var(--el-color-primary)"}},{default:l(()=>[a(k(P),{name:t.formData.meta.icon},null,8,["name"])]),_:1})])):_("",!0),a(T,{type:"primary",plain:"",onClick:e[4]||(e[4]=u=>x())},{default:l(()=>[g("选择图标")]),_:1})]),_:1}),a(j,{"content-position":"left","border-style":"dashed"},{default:l(()=>[a(M,{type:"info"},{default:l(()=>[g("辅助配置")]),_:1})]),_:1}),a(k(E),{data:t.formData,list:V},null,8,["data"])],64)):(i(),S(k(E),{key:1,data:t.formData,list:O},null,8,["data"]))]),_:1},8,["model"])]),_:1},8,["title","show"])}}}),xe=K($e,[["__scopeId","data-v-77cd5ec9"]]),Ce={class:"page-menu"},De={class:"f-right"},Se=f("i",{class:"el-icon-plus el-icon--left"},null,-1),Ve={class:"table-content"},Ie={key:5,style:{width:"100%","text-align":"right"}},Be=L({__name:"index",setup(p){const v=R({show:!1,showType:"add"});function m(s){v.show=!0,v.showType=s}let $=0;function w(s,r=1,b,D){return Array.from({length:s}).map((I,x)=>{$++;const o=Math.random()>.5,e=`row-${$}`,n={id:e,name:"",parentId:D,code:"权限标识",path:`/xxx/${r}/${x}`,component:D?`/xxx/${r}/${x}`:"Layout",sort:1,redirect:"",meta:{title:`${o?"菜单":"权限"}-${r}-${x}`,icon:o?"tdesign:app":"tdesign:combination",hidden:!1,keepAlive:!1,type:o?"menu":"auth",status:1}};return r<b&&(n.children=w(s,r+1,b,e)),n})}const h=Q(w(100,1,3));function c(s){console.log(s)}const C=[{title:"名称",width:320,key:"meta.title"},{title:"类型",width:100,key:"meta.type"},{title:"标识",width:140,key:"code"},{title:"菜单路径",width:140,key:"path"},{title:"排序",width:180,key:"sort"},{title:"启用",width:100,key:"meta.status"},{title:"隐藏",width:100,key:"meta.hidden"},{title:"操作",width:160,key:"option",fixed:re.RIGHT,headerClass:"justify-center"}];C.forEach(s=>{s.dataKey=s.key});function V(s){m("add")}function O(s){m("edit")}const t=R({width:0,height:0});return ae({el:".table-content",callback(s){t.width=s.width,t.height=s.height}}),(s,r)=>{const b=d("el-button"),D=d("el-input-number"),I=d("el-switch"),x=d("el-table-v2");return i(),y("div",Ce,[f("div",De,[a(b,{type:"primary",onClick:r[0]||(r[0]=o=>m("add"))},{default:l(()=>[Se,g(" 新增菜单 ")]),_:1})]),f("section",Ve,[a(x,{columns:C,data:h.value,width:t.width,height:t.height,"expand-column-key":"meta.title",fixed:"",border:""},{cell:l(({rowData:o,column:e})=>[e.key==="meta.title"?(i(),y(X,{key:0},[o.meta.icon?(i(),S(k(P),{key:0,class:"el-icon--left",name:o.meta.icon},null,8,["name"])):_("",!0),f("span",null,A(o.meta.title),1)],64)):_("",!0),e.key==="meta.type"?(i(),y("span",{key:1,class:H(["the-tag",o.meta.type==="menu"?"blue":"green"])},A(o.meta.type==="menu"?"菜单":"权限"),3)):_("",!0),e.key==="sort"?(i(),S(D,{key:2,modelValue:o.sort,"onUpdate:modelValue":n=>o.sort=n,min:1,onBlur:n=>c(o)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):_("",!0),e.key==="meta.status"?(i(),S(I,{key:3,modelValue:o.meta.status,"onUpdate:modelValue":n=>o.meta.status=n,"active-value":1,"inactive-value":2,"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue","onUpdate:modelValue"])):_("",!0),e.key==="meta.hidden"?(i(),y("span",{key:4,class:H(["the-tag",o.meta.hidden?"red":"purple"])},A(o.meta.hidden?"是":"否"),3)):_("",!0),e.key==="option"?(i(),y("div",Ie,[o.meta.type==="menu"?(i(),S(b,{key:0,link:"",type:"primary",onClick:n=>V(o)},{default:l(()=>[g("新增")]),_:2},1032,["onClick"])):_("",!0),a(b,{link:"",type:"success",onClick:n=>O(o)},{default:l(()=>[g("编辑")]),_:2},1032,["onClick"]),a(b,{link:"",type:"danger"},{default:l(()=>[g("删除")]),_:1})])):_("",!0)]),_:1},8,["data","width","height"])]),a(xe,{show:v.show,"onUpdate:show":r[1]||(r[1]=o=>v.show=o)},null,8,["show"])])}}});export{Be as default};
