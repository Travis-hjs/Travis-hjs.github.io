import{aa as te,_ as X,g as G,ab as A,p as N,ac as J,q as R,v as oe,ad as ae}from"./index-C_bH1vCy.js";import{f as q,h as f,i as r,c as a,m as i,G as H,H as Z,p as d,D as K,z as L,j as h,q as M,t as T,b as u,u as k,r as j,x as P,w as le,k as V,d as x,F as Q,aB as ne,aC as se,n as O}from"./element-plus-q5-fTtZa.js";const ie={class:"drawer"},re={class:"drawer-header f-vertical"},de={key:0,class:"f1"},pe={key:1,class:"f1"},ue={class:"content"},me={key:0,class:"drawer-footer"},ce={name:"Drawer"},fe=q({...ce,props:{zIndex:{type:[Number,String],default:0},size:{type:String,default:"30%"},show:{type:Boolean,default:!1},title:{type:String,default:""},backgroundColor:{type:String,default:""}},emits:["update:show","close"],setup(b,{emit:w}){const c=w,g=te();function v(){c("close"),c("update:show",!1)}return(y,p)=>{const C=u("el-scrollbar");return r(),f("section",ie,[a(K,{name:"fade"},{default:i(()=>[H(d("div",{class:"wrap",style:L({zIndex:Number(b.zIndex)||k(g)})},[d("div",{class:"f1",onClick:p[0]||(p[0]=I=>v())}),a(K,{name:"drawer-slide"},{default:i(()=>[H(d("div",{class:"drawer-slide-box",style:L({width:b.size})},[d("div",re,[y.$slots.header?(r(),f("div",de,[M(y.$slots,"header",{},void 0,!0)])):(r(),f("div",pe,T(b.title),1)),d("button",{class:"close-btn",onClick:p[1]||(p[1]=I=>v())},[...p[2]||(p[2]=[d("i",{class:"el-icon-close"},null,-1)])])]),a(C,{class:"drawer-body f1",style:L({"background-color":b.backgroundColor})},{default:i(()=>[d("div",ue,[M(y.$slots,"default",{},void 0,!0)])]),_:3},8,["style"]),y.$slots.footer?(r(),f("div",me,[M(y.$slots,"footer",{},void 0,!0)])):h("",!0)],4),[[Z,b.show]])]),_:3})],4),[[Z,b.show]])]),_:3})])}}}),ye=X(fe,[["__scopeId","data-v-c3bd346e"]]),he={key:0,class:"fvc mr-[10px]"},be={name:"Form"},_e=q({...be,props:{show:{type:Boolean,default:!1},type:{type:String},form:{type:Object,default:()=>({})}},emits:["update:show","submit"],setup(b,{emit:w}){const c=b,g=w;function v(){return{code:"",redirect:"",path:"",component:"",name:"",sort:1,meta:{title:"",link:"",icon:"",hidden:!1,keepAlive:!1,type:"menu",status:1,lang:""}}}const y={component:`<p>路径规则为："src/views/${A("${component}")}.vue"</p><p>${A("component")}就是要填写的路径</p>`,lang:`
  <p>参考 src/language/zh.ts 中的语言对象结构</p>
  <p>比如 ${A("login.account")}、${A("languageSetting")} 等</p>
  `},p={"meta.icon":{trigger:"blur",validator(o,e,n){!t.formData.parentId&&!e?n(new Error("首级菜单必需设置图标")):n()}},"meta.title":G("请输入名称"),code:G("请输入权限标识"),name:{trigger:"blur",validator(o,e,n){t.formData.meta.keepAlive&&!e?n(new Error("当设置路由缓存时，必需设置路由名称！")):n()}}},C=[{label:"菜单名称",prop:"meta.title",type:"input",placeholder:p["meta.title"].message},{label:"菜单权限标识",prop:"code",type:"input",placeholder:p.code.message},{label:"路由路径",prop:"path",type:"input",placeholder:"请确保路径唯一性，如不填，则在提交时自动设置"},{label:"视图组件路径",prop:"component",type:"input",placeholder:"当为目录时可以不用填",tooltip:y.component},{label:"重定向路径",prop:"redirect",type:"input",placeholder:"当为目录且不填时，则默认拿下级第一项作为该值"}],I=[{label:"菜单排序",prop:"sort",type:"number",placeholder:"请输入排序值",min:1,class:"w-[160px]"},{label:"菜单隐藏",prop:"meta.hidden",type:"switch"},{label:"是否需要路由缓存",prop:"meta.keepAlive",type:"switch"},{label:"路由名称",prop:"name",type:"input",placeholder:"请确保名称唯一性，否则路由缓存匹配会异常"},{label:"设置为外链",prop:"meta.link",type:"input",placeholder:"设置外链时则覆盖路由路径"},{label:"多语言设置",prop:"meta.lang",type:"input",placeholder:"请输入语言配置表中的键值",tooltip:y.lang}],E=[{label:"权限标识",prop:"code",type:"input",placeholder:"请输入权限标识"},{label:"权限名称",prop:"meta.title",type:"input",placeholder:p["meta.title"].message},{label:"权限状态",prop:"meta.status",type:"select",options:[{label:"正常",value:1},{label:"停用",value:2}]}],t=j({show:!1,loading:!1,formData:v(),showIcon:!1});function s(){g("update:show",!1)}const l=P();function _(){console.log("formData >>",R(t.formData,!0)),l.value.validate(o=>{if(oe(".menu-form",o),!!o){if(t.formData.meta.type==="auth"&&!t.formData.parentId){ne.error("功能权限必需选择上级菜单！");return}t.formData.parentId||(t.formData.component="Layout"),t.formData.path||(t.formData.path=`/auto-set-${Date.now()}`),g("submit",R(t.formData,!0)),s()}})}const D=new Array(10).fill(0).map((o,e)=>{const n=e+1;return{value:n,label:`菜单-${n}`,children:new Array(6).fill(0).map((z,B)=>{const U=n*20+B;return{value:U,label:`菜单-${U}`}})}});function S(){t.formData.meta.status=1}function $(){window.open("https://icones.netlify.app/collection/tdesign","_blank")}return le(()=>c.show,function(o){t.show=o,o&&(t.formData=c.type==="edit"?R(c.form,!0):v(),l.value&&setTimeout(()=>l.value.clearValidate()))},{immediate:!0}),(o,e)=>{const n=u("el-tree-select"),z=u("el-form-item"),B=u("el-radio-button"),U=u("el-radio-group"),W=u("el-input"),Y=u("el-icon"),F=u("el-button"),ee=u("el-form");return r(),V(k(ye),{title:c.type==="edit"?"编辑菜单":"添加菜单",show:t.show,"onUpdate:show":e[7]||(e[7]=m=>t.show=m),size:"620px",onClose:e[8]||(e[8]=m=>s())},{footer:i(()=>[a(F,{onClick:e[5]||(e[5]=m=>s())},{default:i(()=>[...e[12]||(e[12]=[x("取 消",-1)])]),_:1}),a(F,{onClick:e[6]||(e[6]=m=>_()),type:"primary"},{default:i(()=>[...e[13]||(e[13]=[x("确 认",-1)])]),_:1})]),default:i(()=>[a(ee,{"label-position":"left","label-width":"128px",class:"menu-form",ref_key:"formRef",ref:l,model:t.formData,rules:p},{default:i(()=>[a(z,{label:"上级菜单",prop:"parentId"},{default:i(()=>[a(n,{modelValue:t.formData.parentId,"onUpdate:modelValue":e[0]||(e[0]=m=>t.formData.parentId=m),placeholder:"请选择上级菜单",data:k(D),"check-strictly":"","render-after-expand":!1,clearable:"",filterable:""},null,8,["modelValue","data"])]),_:1}),a(z,{label:"类型",prop:"meta.type"},{default:i(()=>[a(U,{modelValue:t.formData.meta.type,"onUpdate:modelValue":e[1]||(e[1]=m=>t.formData.meta.type=m),onChange:e[2]||(e[2]=m=>S())},{default:i(()=>[a(B,{label:"菜单",value:"menu"}),a(B,{label:"权限功能",value:"auth"})]),_:1},8,["modelValue"])]),_:1}),t.formData.meta.type==="menu"?(r(),f(Q,{key:0},[e[10]||(e[10]=d("div",{class:"mb-[10px]"},[d("h2",{class:"the-title is-line"},"基础配置")],-1)),a(k(N),{data:t.formData,list:C},null,8,["data"]),a(z,{label:"菜单图标",prop:"meta.icon"},{default:i(()=>[a(W,{class:"f1 mr-[10px]",modelValue:t.formData.meta.icon,"onUpdate:modelValue":e[3]||(e[3]=m=>t.formData.meta.icon=m),clearable:"",placeholder:"请选择或者输入图标"},null,8,["modelValue"]),t.formData.meta.icon?(r(),f("div",he,[a(Y,{size:20,style:{color:"var(--el-color-primary)"}},{default:i(()=>[a(k(J),{name:t.formData.meta.icon},null,8,["name"])]),_:1})])):h("",!0),a(F,{type:"primary",plain:"",onClick:e[4]||(e[4]=m=>$())},{default:i(()=>[...e[9]||(e[9]=[x("选择图标",-1)])]),_:1})]),_:1}),e[11]||(e[11]=d("div",{class:"mb-[10px]"},[d("h2",{class:"the-title is-line"},"辅助配置")],-1)),a(k(N),{data:t.formData,list:I},null,8,["data"])],64)):(r(),V(k(N),{key:1,data:t.formData,list:E},null,8,["data"]))]),_:1},8,["model"])]),_:1},8,["title","show"])}}}),we=X(_e,[["__scopeId","data-v-d45ae339"]]),ve={class:"page-menu"},ke={class:"f-right"},ge={class:"table-content"},$e={key:5,style:{width:"100%","text-align":"right"}},De=q({__name:"index",setup(b){const w=j({show:!1,showType:"add"});function c(s){w.show=!0,w.showType=s}let g=0;function v(s,l=1,_,D){return Array.from({length:s}).map((S,$)=>{g++;const o=Math.random()>.5,e=`row-${g}`,n={id:e,name:"",parentId:D,code:"权限标识",path:`/xxx/${l}/${$}`,component:D?`/xxx/${l}/${$}`:"Layout",sort:1,redirect:"",meta:{title:`${o?"菜单":"权限"}-${l}-${$}`,icon:o?"tdesign:app":"tdesign:combination",hidden:!1,keepAlive:!1,type:o?"menu":"auth",status:1}};return l<_&&(n.children=v(s,l+1,_,e)),n})}const y=P(v(100,1,3));function p(s){console.log(s)}const C=[{title:"名称",width:320,key:"meta.title"},{title:"类型",width:100,key:"meta.type"},{title:"标识",width:140,key:"code"},{title:"菜单路径",width:140,key:"path"},{title:"排序",width:180,key:"sort"},{title:"启用",width:100,key:"meta.status"},{title:"隐藏",width:100,key:"meta.hidden"},{title:"操作",width:160,key:"option",fixed:se.RIGHT,headerClass:"justify-center"}];C.forEach(s=>{s.dataKey=s.key});function I(s){c("add")}function E(s){c("edit")}const t=j({width:0,height:0});return ae({el:".table-content",callback(s){t.width=s.width,t.height=s.height}}),(s,l)=>{const _=u("el-button"),D=u("el-input-number"),S=u("el-switch"),$=u("el-table-v2");return r(),f("div",ve,[d("div",ke,[a(_,{type:"primary",onClick:l[0]||(l[0]=o=>c("add"))},{default:i(()=>[...l[2]||(l[2]=[d("i",{class:"el-icon-plus el-icon--left"},null,-1),x(" 新增菜单 ",-1)])]),_:1})]),d("section",ge,[a($,{columns:C,data:y.value,width:t.width,height:t.height,"expand-column-key":"meta.title",fixed:"",border:""},{cell:i(({rowData:o,column:e})=>[e.key==="meta.title"?(r(),f(Q,{key:0},[o.meta.icon?(r(),V(k(J),{key:0,class:"el-icon--left",name:o.meta.icon},null,8,["name"])):h("",!0),d("span",null,T(o.meta.title),1)],64)):h("",!0),e.key==="meta.type"?(r(),f("span",{key:1,class:O(["the-tag",o.meta.type==="menu"?"blue":"green"])},T(o.meta.type==="menu"?"菜单":"权限"),3)):h("",!0),e.key==="sort"?(r(),V(D,{key:2,modelValue:o.sort,"onUpdate:modelValue":n=>o.sort=n,min:1,onBlur:n=>p(o)},null,8,["modelValue","onUpdate:modelValue","onBlur"])):h("",!0),e.key==="meta.status"?(r(),V(S,{key:3,modelValue:o.meta.status,"onUpdate:modelValue":n=>o.meta.status=n,"active-value":1,"inactive-value":2,"inline-prompt":"","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue","onUpdate:modelValue"])):h("",!0),e.key==="meta.hidden"?(r(),f("span",{key:4,class:O(["the-tag",o.meta.hidden?"red":"purple"])},T(o.meta.hidden?"是":"否"),3)):h("",!0),e.key==="option"?(r(),f("div",$e,[o.meta.type==="menu"?(r(),V(_,{key:0,link:"",type:"primary",onClick:n=>I(o)},{default:i(()=>[...l[3]||(l[3]=[x("新增",-1)])]),_:1},8,["onClick"])):h("",!0),a(_,{link:"",type:"success",onClick:n=>E(o)},{default:i(()=>[...l[4]||(l[4]=[x("编辑",-1)])]),_:1},8,["onClick"]),a(_,{link:"",type:"danger"},{default:i(()=>[...l[5]||(l[5]=[x("删除",-1)])]),_:1})])):h("",!0)]),_:1},8,["data","width","height"])]),a(we,{show:w.show,"onUpdate:show":l[1]||(l[1]=o=>w.show=o)},null,8,["show"])])}}});export{De as default};
