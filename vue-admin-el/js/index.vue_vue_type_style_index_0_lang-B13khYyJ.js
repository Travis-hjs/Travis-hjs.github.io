import{H as ot,I as at,a as nt,d as ne,h as Q,o as Re,b,e as s,f as T,k as C,B as we,m as M,F as Y,c as e,g as a,C as W,t as le,z as te,u as g,q as Se,aw as Te,n as de,i as V,N as Ve,j as ge,r as oe,w as be,T as it,K as rt}from"./element-plus-CrjfmyRg.js";import{b as st,F as Ae,a as ut}from"./index-Swj4FZD7.js";import{g as X,h as Ee,k as ce,f as Ue,i as Ye,b as ye,l as De,n as dt,a as pe,u as ct,c as Je,p as pt}from"./index-CHulc6X_.js";import{v as ft,s as mt}from"./dom-vtHEqTVj.js";import{r as yt}from"./common-DQtMtKaP.js";const ze="the-curd-state",Ne=()=>ot(ze),he="action-right",fe="action-edit",ue={input:"输入框",textarea:"文本域","input-between":"输入框-串联",select:"下拉框-单选","select-multiple":"下拉框-多选",checkbox:"多选复选框",radio:"单选选择框",switch:"开关切换",date:"日期选择器",cascader:"级联选择器"};let je=0;function Ke(){return je++,je}function Be(r){if(r.type=="date"){const o=r.shortcutIndex,t="the-date-shortcut-selected",k=document.querySelector(`.${t}`);if(k&&k.classList.remove(t),X(o,"number")&&o>=0){const c=Fe[r.dateType][o].value();r.value=c;const y=`.${r.id} .el-picker-panel__sidebar`,f=document.querySelector(y);f&&at(()=>f.children[o].classList.add(t))}!X(r.value,"array")&&r.valueType==="array"&&(r.value=[])}else["object","array"].includes(Ee(r.defaultValue))?r.value=ce(r.defaultValue):r.value=r.defaultValue}function re(r,o="",t){const k=Ke(),c=Date.now(),y="请输入",f="请选择",m=`field-${r}-${k}-${c}`,A={input:{key:o,id:m,type:"input",value:"",defaultValue:"",placeholder:y,valueType:"string"},textarea:{id:m,value:"",defaultValue:"",type:"textarea",placeholder:y,key:o,valueType:"string"},"input-between":{key:o,id:m,value:["",""],defaultValue:["",""],type:"input-between",placeholder:["请输入范围一","请输入范围二"],separator:"-",valueType:"array"},select:{key:o,id:m,value:"",defaultValue:"",type:"select",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"string"},"select-multiple":{key:o,id:m,value:[],defaultValue:[],type:"select-multiple",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"array"},checkbox:{key:o,id:m,value:[],defaultValue:[],type:"checkbox",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"array"},radio:{key:o,id:m,value:"",defaultValue:"",type:"radio",placeholder:f,options:[],optionSetting:{label:"",value:""},valueType:"string"},switch:{key:o,id:m,value:!1,defaultValue:!1,type:"switch",placeholder:"",valueType:"boolean"},date:{key:o,id:m,value:"",type:"date",placeholder:f,dateType:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D",valueType:"string",shortcutIndex:""},cascader:{key:o,id:m,value:[],defaultValue:[],type:"cascader",placeholder:f,options:[],optionSetting:{label:"",value:"",children:""},multiple:!1,checkStrictly:!1,valueType:"array"}}[r];return A.label="",A.required=!1,A}function Me(r,o){return{label:o,prop:r,width:void 0,minWidth:void 0,tooltip:!1,cellType:"text",sort:!1,fixed:!1,iconTips:"",imageWidth:void 0,imageHeight:void 0,jsCode:"",visible:!0}}function Pe(){return{width:500,labelWidth:120,labelPosition:"left",fields:[]}}function Ce(){return{key:`action-${Ke()}-${Date.now()}`,text:"",icon:"",click:"",type:"primary"}}function Ge(r){const o={value:r.value,result:!0};if(r.type==="date"){if(!o.value)return o.result=r.placeholder,o;if(["datetimerange","daterange"].includes(r.dateType)){const y=r.value;return y.length<2?(o.result=r.placeholder,o):(o.value=y.map(f=>Ue(f,r.format)),o)}return o.value=Ue(r.value,r.format),o}const t=[null,void 0,""];if(r.type==="input-between"){const y=r.value;if(t.includes(y[0]))return o.result=r.placeholder[0],o;if(t.includes(y[1]))return o.result=r.placeholder[1],o;o.value=JSON.parse(JSON.stringify(y))}if(["input","textarea","radio","select"].includes(r.type)&&t.includes(r.value))return o.result=r.placeholder,o;if(["checkbox","select-multiple"].includes(r.type)){const y=r.value;if(!y.length)return o.result=r.placeholder,o;o.value=JSON.parse(JSON.stringify(y))}return o}function _e(r){if(r)return r=parseInt(r.toString()),r=Math.abs(r),`${r}px`}const Ie=[{label:"选择年份",value:"year",formatShow:"YYYY",format:"Y"},{label:"选择年份-月份",value:"month",formatShow:"YYYY-MM",format:"Y-M"},{label:"选择年份-周",value:"week",formatShow:"YYYY年 第ww周",format:"Y-M-D"},{label:"选择年份-月份-日",value:"date",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择年份-月份-日 时:分:秒",value:"datetime",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"},{label:"选择日期范围",value:"daterange",formatShow:"YYYY-MM-DD",format:"Y-M-D"},{label:"选择日期-时间范围",value:"datetimerange",formatShow:"YYYY-MM-DD HH:mm:ss",format:"Y-M-D h:m:s"}],Ze=3600*1e3*24;function me(r=0){const o=new Date;return o.setMonth(new Date().getMonth()-r),o}function ke(r=0){const o=new Date,t=Ze*7*r;return o.setTime(o.getTime()-t),o}const Oe=[{text:"今天",value:()=>new Date},{text:"昨天",value(){const r=new Date;return r.setTime(r.getTime()-Ze),r}},{text:"一周前",value:()=>ke(1)},{text:"一个月前",value:()=>me(1)},{text:"三个月前",value:()=>me(3)},{text:"半年前",value:()=>me(6)},{text:"一年前",value:()=>me(12)}],He=Oe.map((r,o)=>{const t=o===0,k=new Date().toLocaleDateString(),c=[new Date(`${k} 00:00:00`),new Date(`${k} 23:59:59`)];return{text:t?"今天内":`${r.text}至今`,value:()=>t?c:[r.value(),new Date]}}),Fe={year:[{text:"今年",value:()=>new Date},{text:"去年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-1))},{text:"前年",value:()=>new Date(new Date().setFullYear(new Date().getFullYear()-2))}],month:[{text:"当月",value:()=>new Date},{text:"上月",value:()=>me(1)},{text:"前3个月",value:()=>me(3)},{text:"前6个月",value:()=>me(6)},{text:"前12个月",value:()=>me(12)}],week:[{text:"本周",value:()=>new Date},{text:"上周",value:()=>ke(1)},{text:"上2周",value:()=>ke(2)},{text:"上3周",value:()=>ke(3)},{text:"上4周",value:()=>ke(4)}],date:Oe,datetime:Oe,daterange:He,datetimerange:He};function vt(r){const o=window;for(const t in r){const k=`_${t}`;o[k]=r[t]}nt(function(){for(const t in r){const k=`_${t}`;o[k]=null}})}function ee(r){return`<b style="color: var(--yellow)"> ${r} </b>`}const bt={name:"Field"},xe=ne({...bt,props:{fieldData:{type:Object,required:!0},editMode:Boolean,readonly:Boolean,disabled:Boolean},setup(r){const o=r;Be(o.fieldData);const t=Q(()=>o.fieldData),k=Q(()=>{const _=o.fieldData.optionSetting||{};return{value:_.value||"value",label:_.label||"label"}}),c=Q(()=>{const _=o.fieldData;return{multiple:_.multiple,checkStrictly:_.checkStrictly,value:_.optionSetting.value||"value",label:_.optionSetting.label||"label",children:_.optionSetting.children||"children"}});function y(_){const l=t.value.placeholder;return{disabled:o.disabled,readonly:o.readonly,clearable:!0,placeholder:X(_,"number")?l[_]:l}}function f(_){const l=o.fieldData;l.valueType==="number"?l.value=Ye(_,!0,!0):l.value=_}function m(_,l){const P=o.fieldData;P.valueType==="array<number>"?P.value[l]=Ye(_,!0,!0):P.value[l]=_}const q=["-",".","",null,void 0];function A(){const _=o.fieldData;_.valueType==="number"&&(q.includes(_.value)?_.value="":_.value=Number(_.value))}function S(_){const l=o.fieldData;if(l.valueType==="array<number>"){const P=l.value[_];q.includes(P)?l.value[_]="":l.value[_]=Number(P)}}function K(_){return{placeholder:_.placeholder,disabled:o.disabled,multiple:_.type==="select-multiple",clearable:!0,filterable:!0,collapseTags:!0,class:"field-item"}}let G=[];const L="the-date-shortcut-selected";function v(){const _=document.querySelector(`.${L}`);_&&_.classList.remove(L)}function N(_){_.classList.add(L)}return Re(function(){const _=o.fieldData;if(_.type==="date"){const l=`.${_.id} .el-picker-panel__sidebar`,P=document.querySelector(l);if(!P)return console.warn("找不到日期快捷面板节点！");G=Array.from(P.children),G.forEach(R=>{R.addEventListener("click",()=>N(R))});const J=_.shortcutIndex;X(J,"number")&&J>=0&&N(G[J])}}),(_,l)=>{const P=b("el-input"),J=b("el-text"),R=b("el-select-v2"),H=b("el-option"),ae=b("el-select"),E=b("el-checkbox"),Z=b("el-checkbox-group"),j=b("el-radio"),$=b("el-radio-group"),i=b("el-switch"),w=b("el-cascader"),U=b("el-date-picker");return s(),T("div",{class:"the-curd-form-field f-vertical short-value",style:Se({width:g(_e)(t.value.valueWidth)})},[t.value.type==="input"?(s(),C(P,we({key:0,"model-value":t.value.value},y(),{class:"the-curd-field",onInput:f,onBlur:A}),null,16,["model-value"])):M("",!0),t.value.type==="textarea"?(s(),C(P,{key:1,modelValue:t.value.value,"onUpdate:modelValue":l[0]||(l[0]=u=>t.value.value=u),readonly:o.readonly,disabled:o.disabled,autosize:{minRows:2,maxRows:10},placeholder:t.value.placeholder,type:"textarea",class:"the-curd-field"},null,8,["modelValue","readonly","disabled","placeholder"])):M("",!0),t.value.type==="input-between"?(s(),T(Y,{key:2},[e(P,we({"model-value":t.value.value[0]},y(0),{class:"f1",onInput:l[1]||(l[1]=u=>m(u,0)),onBlur:l[2]||(l[2]=u=>S(0))}),null,16,["model-value"]),e(J,{style:{padding:"0 6px"}},{default:a(()=>[W(le(t.value.separator),1)]),_:1}),e(P,we({"model-value":t.value.value[1]},y(1),{class:"f1",onInput:l[3]||(l[3]=u=>m(u,1)),onBlur:l[4]||(l[4]=u=>S(1))}),null,16,["model-value"])],64)):M("",!0),t.value.type==="select"||t.value.type==="select-multiple"?(s(),T(Y,{key:3},[t.value.options.length>50?(s(),C(R,we({key:0,modelValue:t.value.value,"onUpdate:modelValue":l[5]||(l[5]=u=>t.value.value=u),options:t.value.options,props:t.value.optionSetting},K(t.value)),null,16,["modelValue","options","props"])):(s(),C(ae,we({key:1,modelValue:t.value.value,"onUpdate:modelValue":l[6]||(l[6]=u=>t.value.value=u)},K(t.value)),{default:a(()=>[(s(!0),T(Y,null,te(t.value.options,u=>(s(),C(H,{key:u[k.value.value],value:u[k.value.value],label:u[k.value.label]},null,8,["value","label"]))),128))]),_:1},16,["modelValue"]))],64)):M("",!0),t.value.type==="checkbox"?(s(),T(Y,{key:4},[e(Z,{modelValue:t.value.value,"onUpdate:modelValue":l[7]||(l[7]=u=>t.value.value=u),disabled:o.disabled},{default:a(()=>[(s(!0),T(Y,null,te(t.value.options,u=>(s(),C(E,{key:u[k.value.value],value:u[k.value.value]},{default:a(()=>[W(le(u[k.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),o.editMode&&!t.value.options.length?(s(),C(J,{key:0,type:"primary"},{default:a(()=>[W(le(g(ue).checkbox)+"（空数据） ",1)]),_:1})):M("",!0)],64)):M("",!0),t.value.type==="radio"?(s(),T(Y,{key:5},[e($,{modelValue:t.value.value,"onUpdate:modelValue":l[8]||(l[8]=u=>t.value.value=u),disabled:o.disabled},{default:a(()=>[(s(!0),T(Y,null,te(t.value.options,u=>(s(),C(j,{key:u[k.value.value],value:u[k.value.value]},{default:a(()=>[W(le(u[k.value.label]),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled"]),o.editMode&&!t.value.options.length?(s(),C(J,{key:0,type:"primary"},{default:a(()=>[W(le(g(ue).radio)+"（空数据） ",1)]),_:1})):M("",!0)],64)):M("",!0),t.value.type==="switch"?(s(),C(i,{key:6,modelValue:t.value.value,"onUpdate:modelValue":l[9]||(l[9]=u=>t.value.value=u),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])):M("",!0),t.value.type==="cascader"?(s(),C(w,{key:7,modelValue:t.value.value,"onUpdate:modelValue":l[10]||(l[10]=u=>t.value.value=u),options:t.value.options,props:c.value,placeholder:t.value.placeholder,disabled:o.disabled,clearable:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",class:"the-curd-field"},null,8,["modelValue","options","props","placeholder","disabled"])):M("",!0),t.value.type==="date"?(s(),C(U,{key:8,modelValue:t.value.value,"onUpdate:modelValue":l[11]||(l[11]=u=>t.value.value=u),placeholder:t.value.placeholder,type:t.value.dateType,format:t.value.formatShow,shortcuts:g(Fe)[t.value.dateType],disabled:o.disabled,"popper-class":t.value.id.toString(),"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",class:"the-curd-field",onChange:v},null,8,["modelValue","placeholder","type","format","shortcuts","disabled","popper-class"])):M("",!0)],4)}}}),ht={key:0,class:"el-icon-rank el-icon--left"},gt={style:{"line-height":"1"}},_t={key:0,class:"the-curd-edit-mask f-vertical f-right"},wt=V("i",{class:"el-icon-delete el-icon--left"},null,-1),kt=V("i",{class:"el-icon-edit el-icon--left"},null,-1),xt=V("i",{class:"el-icon-plus"},null,-1),Vt={name:"Search"},Dt=ne({...Vt,props:{data:{type:Object,required:!0}},emits:["search"],setup(r,{emit:o}){const t=r,k=o,c=Ne(),y=Q(()=>c.editor.type==="search"&&!c.editor.show);function f(L){const v=t.data.list[L].label||t.data.list[L].key;ye({title:"操作提示",content:`是否删除【${v}】？`,cancelText:"取消",confirm(){t.data.list.splice(L,1)}})}function m(L){c.editor.index=L,c.editor.action="edit",c.editor.show=!0}function q(L){return c.editor.index===L&&c.editor.type==="search"&&c.editor.show}function A(){c.editor.index=-1,c.editor.action="add",c.editor.show=!0}const{onDragStart:S,onDragMove:K,onDropEnd:G}=De({list:()=>t.data.list,key:"id",findLevel:5});return(L,v)=>{const N=b("el-button"),_=b("el-text");return s(),C(g(ut),{class:"the-curd-search","label-right":t.data.labelRight,"label-width":g(_e)(t.data.labelWidth)||"auto"},Te({content:a(()=>[e(Ve,{name:"the-group",tag:"div",class:"the-filter-content f1"},{default:a(()=>[(s(!0),T(Y,null,te(t.data.list,(l,P)=>(s(),C(g(Ae),{key:l.id,"data-key":l.id,class:de([{"the-curd-selected":q(P)},l.id]),label:l.label,"label-width":g(_e)(l.labelWidth),required:l.required,draggable:y.value,onDragstart:J=>g(S)(P),onDragover:J=>g(K)(J,P),onDrop:v[0]||(v[0]=J=>g(G)())},Te({default:a(()=>[e(xe,{"field-data":l,disabled:g(c).loading},null,8,["field-data","disabled"]),y.value?(s(),T("div",_t,[e(N,{link:"",type:"danger",onClick:J=>f(P)},{default:a(()=>[wt,W(" 删除 ")]),_:2},1032,["onClick"]),e(N,{link:"",type:"success",onClick:J=>m(P)},{default:a(()=>[kt,W(" 编辑 ")]),_:2},1032,["onClick"])])):M("",!0)]),_:2},[g(c).editor.type==="search"?{name:"label",fn:a(()=>[y.value?(s(),T("i",ht)):M("",!0),V("span",gt,le(l.label),1)]),key:"0"}:void 0]),1032,["data-key","class","label","label-width","required","draggable","onDragstart","onDragover"]))),128)),y.value?(s(),C(g(Ae),{key:0},{default:a(()=>[t.data.list.length?M("",!0):(s(),C(_,{key:0,type:"info",style:{"margin-right":"12px"}},{default:a(()=>[W(" 请添加筛选条件~ ")]),_:1})),e(N,{type:"primary",circle:"",onClick:v[1]||(v[1]=l=>A())},{default:a(()=>[xt]),_:1})]),_:1})):M("",!0)]),_:1})]),_:2},[g(c).editor.type?void 0:{name:"right",fn:a(()=>[e(g(st),{loading:g(c).loading,onSearch:v[2]||(v[2]=l=>k("search",l))},null,8,["loading"])]),key:"0"}]),1032,["label-right","label-width"])}}});function Xe(r){const o=r.onAction||(()=>{});return e(Y,null,[e(b("el-button"),{link:!0,onClick:()=>o("exit")},{default:()=>[W("退出编辑")]}),e(b("el-button"),{type:"success",plain:!0,onClick:()=>o("copy")},{default:()=>[e("i",{class:"el-icon-document-copy el-icon--left"},null),W("复制JSON")]}),e(b("el-button"),{type:"primary",onClick:()=>o("complete")},{default:()=>[W("完成编辑")]})])}function $e(r){const o=r.onClose||(()=>{}),t=r.onSubmit||(()=>{});return e(Y,null,[e(b("el-button"),{onClick:o},{default:()=>[W("取 消")]}),e(b("el-button"),{type:"primary",loading:r.loading,disabled:r.disabledSubmit,onClick:t},{default:()=>[W("确 认")]})])}function $t(r){const o={};return r.imageWidth&&(o.width=`${r.imageWidth}px`),r.imageHeight&&(o.height=`${r.imageHeight}px`),o}function Qe(r){function o(){dt({urls:r.previewList?r.previewList:[r.src]})}return r.column.cellType==="image"?e(b("el-image"),{class:"the-table-image",style:$t(r.column),src:r.src,onClick:o,fit:"cover"},null):null}function ve(r){return e(Y,null,[r.label,e(b("el-tooltip"),{effect:"dark",content:r.tips,"raw-content":!0,placement:"top-start"},{default:()=>[e(b("el-button"),{type:"info",link:!0,style:"height: 32px;"},{default:()=>[e("i",{class:"el-icon-question"},null)]})]})])}function et(r){const o=r.onAction||(()=>{}),t=r.config,k=!!t.selectKey,c=t.formAdd&&t.formAdd.fields.length>0,y=t.formEdit&&t.formEdit.fields.length>0,f={on:"el-icon-success",off:"el-icon-remove-outline"},m=[{type:"delete",text:k?"修改删除":"配置删除",icon:k?f.on:f.off,style:k?"primary":"info"},{type:"add",text:c?"修改新增表单":"配置新增表单",icon:c?f.on:f.off,style:c?"primary":"info"},{type:"edit",text:y?"修改编辑表单":"配置编辑表单",icon:y?f.on:f.off,style:y?"primary":"info"}];return e("div",null,[r.editMode?e(Y,null,[m.map(q=>e(b("el-button"),{type:q.style,link:!0,onClick:()=>o(q.type)},{default:()=>[e("i",{class:`el-icon--left ${q.icon}`},null),q.text]}))]):e(Y,null,[k?e(b("el-button"),{type:"danger",link:!0,disabled:r.disabled,onClick:()=>o("delete")},{default:()=>[e("i",{class:"el-icon--left el-icon-delete"},null),W("删除")]}):null,c?e(b("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>o("add")},{default:()=>[e("i",{class:"el-icon--left el-icon-plus"},null),W("新增")]}):null,e(b("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>o("export")},{default:()=>[e("i",{class:"el-icon--left el-icon-download"},null),W("导出")]}),e(b("el-tooltip"),{effect:"dark",content:"配置表格展示、排序等操作",placement:"top-end"},{default:()=>[e(b("el-button"),{type:"primary",link:!0,disabled:r.disabled,onClick:()=>o("setting")},{default:()=>[e("i",{class:"el-icon--left el-icon-setting"},null),W("设置")]})]})])])}function St(){const r=Array.from({length:6}).map((o,t)=>({id:t}));return e("div",{class:"the-thumbnail-search flex"},[e("div",{class:"the-thumbnail-search-content f1"},[r.map(o=>e("div",{key:o.id,class:"the-thumbnail-search-item"},null))]),e("div",{class:"the-thumbnail-search-btn f-vertical"},[e("i",{class:"el-icon-search"},null)])])}function Ct(){return e("section",{class:"the-thumbnail-table"},[e("svg",{width:280,height:180,viewBox:`0 0 ${280*1} ${180*1}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","data-v-d2b0a988":"",class:"the-thumbnail-table-svg"},[e("rect",{width:280,height:180,fill:""},null),e("g",{filter:"url(#filter0_d_13550_224439)"},[e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V132C215 133.105 214.105 134 213 134H67C65.8954 134 65 133.105 65 132V60Z",fill:"var(--el-fill-color-blank)"},null),e("path",{d:"M67 57.7C65.7297 57.7 64.7 58.7297 64.7 60V132C64.7 133.27 65.7297 134.3 67 134.3H213C214.27 134.3 215.3 133.27 215.3 132V60C215.3 58.7297 214.27 57.7 213 57.7H67Z",stroke:"var(--el-border-color-dark)","stroke-width":.6*1},null)]),[76,92,108,124].map((k,c)=>e("rect",{key:c,x:71*1,y:k*1,width:16*1,height:4*1,rx:2*1,fill:"var(--el-color-primary)"},null)),[107,143,197].map((k,c)=>[76,92,108,124].map((y,f)=>e("rect",{key:`${c}-${f}`,x:k*1,y:y*1,width:c===2?12*1:20*1,height:4*1,rx:2*1,fill:"var(--el-border-color-dark)"},null))),e("path",{d:"M65 60C65 58.8954 65.8954 58 67 58H213C214.105 58 215 58.8954 215 60V70H65V60Z",fill:"var(--el-border-color-light)"},null),[71,107,143,199].map(k=>e("rect",{key:k,x:k*1,y:63*1,width:10*1,height:2*1,rx:1*1,fill:"var(--el-border-color-dark)"},null)),[85.75,101.75,117.75].map((k,c)=>e("line",{key:c,x1:65*1,y1:k*1,x2:215*1,y2:k*1,stroke:"var(--el-border-color-light)","stroke-width":.5*1},null)),e("defs",null,[e("filter",{id:"filter0_d_13550_224439",x:"51.0666",y:"44.0671",width:177.867*1,height:103.866*1,filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"},[e("feFlood",{"flood-opacity":"0",result:"BackgroundImageFix"},null),e("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"},null),e("feOffset",null,null),e("feGaussianBlur",{stdDeviation:6.66667*1},null),e("feComposite",{in2:"hardAlpha",operator:"out"},null),e("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.05 0"},null),e("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_13550_224439"},null),e("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_13550_224439",result:"shape"},null)])])])])}const Tt={key:0,class:"el-icon-rank el-icon--left",style:{"line-height":"32px"}},Et={class:"f-vertical w-full"},Ut=V("i",{class:"el-icon-edit"},null,-1),Mt=V("i",{class:"el-icon-delete"},null,-1),Ot={key:1},Nt=V("i",{class:"el-icon--left el-icon-delete"},null,-1),Bt=V("i",{class:"el-icon--left el-icon-finished"},null,-1),Ft=V("i",{class:"el-icon--left el-icon-plus"},null,-1),Lt={name:"TableForm"},tt=ne({...Lt,props:{config:{type:Object,default:()=>Pe()},type:{type:String},editMode:{type:Boolean},disabled:{type:Boolean}},emits:["change"],setup(r,{expose:o,emit:t}){const k=r,c=t,y=ge(),f=Pe(),m=oe({config:f,form:{},rules:{}}),q=Ne(),A=Q(()=>k.type==="add"?"新增":"编辑"),S=Q(()=>q.editor.show);function K(j){l(),q.editor.action=j>=0?"edit":"add",q.editor.form=m.config,q.editor.index=j,q.editor.show=!0}function G(j){const $=m.config.fields;l(),ye({title:"操作提示",content:`是否删除【${$[j].label}】？`,cancelText:"取消",confirm(){$.splice(j,1)}})}function L(){ye({title:"操作提示",content:`是否移除【${A.value}】表单？移除后将不会出现对应功能按钮。`,cancelText:"取消",confirm(){m.config.fields=[]}})}function v(){c("change")}function N(){const j=k.type==="add"?"编辑":"新增";ye({title:"操作提示",content:`是否将表单数据同步到【${j}】表单？`,cancelText:"不同步",confirmText:"同步",cancel(){c("change",m.config)},confirm(){c("change",m.config,!0)}})}function _(j){var $;($=y.value)==null||$.validate(i=>{if(i&&j){const w=E.value,U={};Z.value.forEach(u=>{U[u.key]=w[u.key]}),j(w,U)}})}function l(){var j;(j=y.value)==null||j.clearValidate()}function P(){m.config.fields.forEach(Be)}function J(j){m.config.fields.forEach($=>{if(Object.prototype.hasOwnProperty.call(j,$.key)){const i=j[$.key];if(!i)return;switch($.type){case"date":X(i,"array")?$.value=i.map(w=>new Date(w)):$.value=new Date(i);break;default:$.value=i;break}}})}const{onDragStart:R,onDragMove:H,onDropEnd:ae}=De({list:()=>m.config.fields,key:"id",findLevel:10});be(()=>k.config,function(j){j&&(m.config=ce(j))},{immediate:!0}),be(()=>m.config.fields,function(j){const $={},i={},w=["input","input-between","textarea"];j&&j.forEach(U=>{$[U.key]=U.value,U.required&&(i[U.key]=[{required:!0,validator(u,d,B){const D=[void 0,null,""];if(U.type==="input-between"&&!U.value[0]&&!U.value[1]){B(new Error("请输入两个范围字段"));return}if(U.valueType==="array"&&!U.value.length){B(new Error(U.placeholder||"请选择"));return}if(U.valueType!=="boolean"&&D.includes(U.value)){const n=w.includes(U.type)?"请输入内容":"请选择";B(new Error(U.placeholder||n));return}B()},trigger:w.includes(U.type)?"blur":"change"}])}),m.form=$,m.rules=i,setTimeout(l)},{immediate:!0});const E=Q(()=>{const j={};return m.config.fields.forEach($=>{j[$.key]=Ge($).value}),j}),Z=Q(()=>m.config.fields.filter(j=>{const $=j.show;if(!$)return!0;if(X($,"function"))return $(E.value);if($.includes("return"))try{return new Function("formData",$)(E.value)}catch(i){console.warn("解析表单展示逻辑代码错误 >>",i)}return!0}));return o({clear:l,validate:_,reset:P,setFormData:J}),(j,$)=>{const i=b("el-button"),w=b("el-form-item"),U=b("el-empty"),u=b("el-form");return s(),C(u,{ref_key:"formRef",ref:y,model:m.form,rules:m.rules,labelWidth:g(_e)(m.config.labelWidth),labelPosition:m.config.labelPosition,disabled:k.disabled,style:Se(k.editMode?{width:g(_e)(m.config.width)}:null),class:de([{"is-edit-form":k.editMode}])},{default:a(()=>[k.editMode?(s(),T(Y,{key:0},[e(Ve,{name:"the-group",tag:"div"},{default:a(()=>[(s(!0),T(Y,null,te(m.config.fields,(d,B)=>(s(),C(w,{class:de([{"the-curd-selected":g(q).editor.index===B&&S.value}]),prop:d.key,key:d.id,"data-key":d.id,draggable:m.config.fields.length>1&&!g(q).editor.show?!0:null,onDragstart:D=>g(R)(B),onDragover:D=>g(H)(D,B),onDrop:g(ae)},{label:a(()=>[m.config.fields.length>1&&!g(q).editor.show?(s(),T("i",Tt)):M("",!0),V("span",null,le(d.label),1)]),default:a(()=>[V("div",Et,[e(xe,{class:"mgr-10",fieldData:d,editMode:""},null,8,["fieldData"]),e(i,{link:"",type:"success",disabled:S.value,onClick:D=>K(B)},{default:a(()=>[Ut]),_:2},1032,["disabled","onClick"]),e(i,{link:"",type:"danger",disabled:S.value,onClick:D=>G(B)},{default:a(()=>[Mt]),_:2},1032,["disabled","onClick"])])]),_:2},1032,["class","prop","data-key","draggable","onDragstart","onDragover","onDrop"]))),128))]),_:1}),m.config.fields.length?M("",!0):(s(),C(U,{key:0,description:`当前没有表单项，当没有表单项时【${A.value}】功能按钮不会出现~`},null,8,["description"])),S.value?M("",!0):(s(),T("div",Ot,[e(i,{link:"",onClick:$[0]||($[0]=d=>v())},{default:a(()=>[W(" 退出编辑 ")]),_:1}),e(i,{type:"danger",link:"",disabled:!m.config.fields.length,onClick:$[1]||($[1]=d=>L())},{default:a(()=>[Nt,W(" 删除表单 ")]),_:1},8,["disabled"]),e(i,{type:"success",link:"",onClick:$[2]||($[2]=d=>N())},{default:a(()=>[Bt,W(" 完成表单 ")]),_:1}),e(i,{type:"primary",link:"",onClick:$[3]||($[3]=d=>K(-1))},{default:a(()=>[Ft,W(" 添加一项 ")]),_:1})]))],64)):M("",!0),!k.editMode&&m.config&&m.config.fields?(s(!0),T(Y,{key:1},te(Z.value,d=>(s(),C(w,{label:d.label,prop:d.key,key:d.id},{default:a(()=>[e(xe,{fieldData:d},null,8,["fieldData"])]),_:2},1032,["label","prop"]))),128)):M("",!0)]),_:1},8,["model","rules","labelWidth","labelPosition","disabled","style","class"])}}}),Wt={key:1,class:"f-vertical w-full"},qt=V("i",{class:"el-icon--right el-icon-question the-tips-icon"},null,-1),At={key:1,class:"f1 f-right"},Yt={name:"TableHeader"},lt=ne({...Yt,props:{column:{type:Object,required:!0}},emits:["sort"],setup(r,{emit:o}){const t=r,k=o,c=Q(()=>!t.column.sort&&!t.column.iconTips),y={true:{index:0,icon:"el-icon-sort"},asc:{index:1,icon:"el-icon-sort-up"},desc:{index:2,icon:"el-icon-sort-down"}},f=[!0,"asc","desc"];function m(){const q=t.column.sort.toString();let A=y[q].index;A++,A>=f.length&&(A=0);const S=f[A];k("sort",t.column.prop,S)}return(q,A)=>{const S=b("el-tooltip"),K=b("el-button");return c.value?(s(),T(Y,{key:0},[W(le(t.column.label),1)],64)):(s(),T("div",Wt,[V("span",null,le(t.column.label),1),t.column.iconTips?(s(),C(S,{key:0,effect:"dark",content:t.column.iconTips,placement:"top"},{default:a(()=>[qt]),_:1},8,["content"])):M("",!0),t.column.sort?(s(),T("div",At,[e(K,{link:"",onClick:m},{default:a(()=>[V("i",{class:de(["el-icon--right",y[t.column.sort.toString()].icon])},null,2)]),_:1})])):M("",!0)]))}}}),Jt={name:"TableColumnConfig"},jt=ne({...Jt,props:{show:{type:Boolean,required:!0},type:{type:String,required:!0},keys:{type:Array,required:!0},form:Object},emits:["update:show","submit"],setup(r,{emit:o}){const t=r,k=o,c=oe({show:!1,form:Me("","")}),y=Q(()=>`${t.type==="add"?"新增":"编辑"}表格列`),f=ge(),m={label:{required:!0,message:"请输入表格列标题",trigger:"blur"},prop:{required:!0,validator(L,v,N){v?t.keys.includes(c.form.prop)?N(new Error("已经存在相同的值！")):N():N(new Error("输入字段不能为空！"))},trigger:"blur"},jsCode:{required:!0,validator(L,v,N){v?v.includes("return")?N():N(new Error('代码片段必须带有返回字段 "return"')):N(new Error("代码片段不能为空！"))},trigger:"blur"}},q=[{label:"默认普通文本",value:"text"},{label:"图片预览组件",value:"image"},{label:"自定义 js 代码",value:"js"}],A=[{label:"不可排序",value:!1},{label:"可排序",value:!0},{label:"默认升序",value:"asc"},{label:"默认降序",value:"desc"}],S=`
<p>函数代码片段：</p>
<p>第一个参数${ee("cellValue")}是表格值;</p>
<p>第二个参数${ee("row")}是完整对象;</p>
<p>例如：${ee("return cellValue + row.id;")};</p>
<p>也可以是HTML：${ee("return `html 标签`")};</p>
`;function K(){k("update:show",!1)}function G(){var L;(L=f.value)==null||L.validate(v=>{if(!v)return;const N=ce(c.form);["width","minWidth","imageWidth","imageHeight"].forEach(l=>{N[l]&&(N[l]=Number(N[l]))}),N.cellType==="image"&&(N.slot=N.prop),(N.sort||N.iconTips)&&(N.slotHead=`header-${N.prop}`),k("submit",N),K()})}return be(()=>t.show,function(L){c.show=L,L&&(t.type==="add"?c.form=Me("",""):c.form=ce(t.form),setTimeout(()=>{var v;return(v=f.value)==null?void 0:v.clearValidate()}))},{immediate:!0}),(L,v)=>{const N=b("el-input"),_=b("el-form-item"),l=b("el-input-number"),P=b("el-option"),J=b("el-select"),R=b("el-switch"),H=b("el-form"),ae=b("base-dialog");return s(),C(ae,{modelValue:c.show,"onUpdate:modelValue":v[11]||(v[11]=E=>c.show=E),title:y.value,width:"580px",onClose:K},{footer:a(()=>[e(g($e),{onClose:K,onSubmit:G})]),default:a(()=>[e(H,{ref_key:"formRef",ref:f,model:c.form,rules:m,"label-position":"right","label-width":"130px"},{default:a(()=>[e(_,{label:"表格列标题",prop:"label"},{default:a(()=>[e(N,{modelValue:c.form.label,"onUpdate:modelValue":v[0]||(v[0]=E=>c.form.label=E),clearable:"",placeholder:m.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(_,{label:"表格列键值",prop:"prop"},{default:a(()=>[e(N,{modelValue:c.form.prop,"onUpdate:modelValue":v[1]||(v[1]=E=>c.form.prop=E),clearable:"",placeholder:"请输入表格列键值"},null,8,["modelValue"])]),_:1}),e(_,{label:"表格列宽度",prop:"width"},{default:a(()=>[e(l,{modelValue:c.form.width,"onUpdate:modelValue":v[2]||(v[2]=E=>c.form.width=E),class:"w-full","controls-position":"right",placeholder:"请输入表格列宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(_,{label:"表格列最小宽度",prop:"minWidth"},{default:a(()=>[e(l,{modelValue:c.form.minWidth,"onUpdate:modelValue":v[3]||(v[3]=E=>c.form.minWidth=E),class:"w-full","controls-position":"right",placeholder:"请输入表格列最小宽度，例如：120（默认自适应）"},null,8,["modelValue"])]),_:1}),e(_,{label:"表格列展示类型",prop:"cellType"},{default:a(()=>[e(J,{modelValue:c.form.cellType,"onUpdate:modelValue":v[4]||(v[4]=E=>c.form.cellType=E)},{default:a(()=>[(s(),T(Y,null,te(q,E=>e(P,{key:E.value,value:E.value,label:E.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),c.form.cellType==="image"?(s(),T(Y,{key:0},[e(_,{label:"图片宽度(像素)",prop:"imageWidth"},{default:a(()=>[e(l,{modelValue:c.form.imageWidth,"onUpdate:modelValue":v[5]||(v[5]=E=>c.form.imageWidth=E),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1}),e(_,{label:"图片高度(像素)",prop:"imageHeight"},{default:a(()=>[e(l,{modelValue:c.form.imageHeight,"onUpdate:modelValue":v[6]||(v[6]=E=>c.form.imageHeight=E),class:"w-full","controls-position":"right",placeholder:"请输入数字（默认80px）"},null,8,["modelValue"])]),_:1})],64)):M("",!0),c.form.cellType==="js"?(s(),C(_,{key:1,prop:"jsCode"},{label:a(()=>[e(g(ve),{label:"js代码",tips:S})]),default:a(()=>[e(N,{modelValue:c.form.jsCode,"onUpdate:modelValue":v[7]||(v[7]=E=>c.form.jsCode=E),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1})):M("",!0),e(_,{label:"表格列排序操作",prop:"sort"},{default:a(()=>[e(J,{modelValue:c.form.sort,"onUpdate:modelValue":v[8]||(v[8]=E=>c.form.sort=E)},{default:a(()=>[(s(),T(Y,null,te(A,E=>e(P,{key:E.value.toString(),value:E.value,label:E.label},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(_,{label:"内容溢出截断",prop:"tooltip"},{default:a(()=>[e(R,{modelValue:c.form.tooltip,"onUpdate:modelValue":v[9]||(v[9]=E=>c.form.tooltip=E),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(_,{label:"表头图标提示文字",prop:"iconTips"},{default:a(()=>[e(N,{modelValue:c.form.iconTips,"onUpdate:modelValue":v[10]||(v[10]=E=>c.form.iconTips=E),clearable:"",placeholder:"请输入表头图标提示文字"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Pt=V("p",{class:"mgb-10"},"表格数据中的字段，例如表格数：",-1),It=V("p",{class:"mgb-10"},"则键值可以为 id",-1),Ht=V("p",null,[V("i",{class:"el-icon-info el-icon--left"}),W(" 不填则没有删除功能 ")],-1),Rt={name:"TableDeleteConfig"},zt=ne({...Rt,props:{show:{type:Boolean,default:!1},selectKey:{type:String,default:""}},emits:["update:show","submit"],setup(r,{emit:o}){const t=r,k=o,c='[{ id: 1, name: "名称", status: 2 }]',y=oe({show:!1,keyword:""});function f(){k("update:show",!1)}function m(){f(),k("submit",y.keyword)}return be(()=>t.show,function(q){y.show=q,q&&(y.keyword=t.selectKey||"")},{immediate:!0}),(q,A)=>{const S=b("el-input"),K=b("el-form-item"),G=b("el-form"),L=b("base-dialog");return s(),C(L,{modelValue:y.show,"onUpdate:modelValue":A[1]||(A[1]=v=>y.show=v),title:"配置表格删除功能",width:"400px",onClose:f},{footer:a(()=>[e(g($e),{onClose:f,onSubmit:m})]),default:a(()=>[e(G,{labelPosition:"right",labelWidth:"120px"},{default:a(()=>[e(K,{label:"数据键值"},{default:a(()=>[e(S,{class:"mgb-10",modelValue:y.keyword,"onUpdate:modelValue":A[0]||(A[0]=v=>y.keyword=v),placeholder:"请输入数据键值",clearable:""},null,8,["modelValue"]),V("div",{class:"the-tag blue"},[Pt,V("p",{class:"mgb-10"},le(c)),It,Ht])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Kt={class:"flex"},Gt={class:"f1"},Zt={class:"f-vertical w-full"},Xt={class:"f-right w-full"},Qt=V("i",{class:"el-icon--left el-icon-finished"},null,-1),el=V("i",{class:"el-icon--left el-icon-plus"},null,-1),tl=["data-key","draggable","onDragstart","onDragover"],ll={key:0,class:"el-icon--left el-icon-rank"},ol=V("div",{class:"f1"},null,-1),al=V("i",{class:"el-icon-delete"},null,-1),nl=V("i",{class:"el-icon-edit"},null,-1),il={key:1,class:"w-full f-right"},rl=V("i",{class:"el-icon--left el-icon-plus"},null,-1),sl={name:"TableActionConfig"},ul=ne({...sl,props:{show:{type:Boolean,default:!1},list:{type:Array,required:!0},columnWidth:{type:Number},actionMax:{type:Number}},emits:["update:show","submit"],setup(r,{emit:o}){const t=r,k=o,c=ge(),y=ge(),f=oe({show:!1,list:[],index:-1,hasEdit:!1,formEdit:!1}),m=oe({btn:Ce(),column:{width:160,max:3}}),q={width:{required:!0,message:"请输入表格列宽度，例如：160",trigger:"blur"},max:{required:!1,message:"请输入数量，超出用“更多”下拉展示",trigger:"blur"}},A={text:{required:!0,message:"请输入按钮文字",trigger:"blur"},click:{required:!0,message:"请输入按钮操作代码",trigger:"blur"},icon:{required:!1,message:"请输入图标 class",trigger:"blur"},type:{required:!1,message:"请选择按钮类型",trigger:"change"}};function S(){k("update:show",!1)}function K(){y.value.validate($=>{if(!$)return;S();const{width:i,max:w}=m.column;k("submit",ce(f.list),i,w)})}function G($){c.value.validate(i=>{if(!i)return;const w=ce(m.btn);$==="add"?f.list.push(w):f.list[f.index]=m.btn,L()})}function L(){f.index=-1,m.btn=Ce(),f.formEdit=!1,setTimeout(()=>{var $;return($=c.value)==null?void 0:$.clearValidate()})}function v($){const i=f.list[$];m.btn=JSON.parse(JSON.stringify(i)),f.index=$,f.formEdit=!0}function N($){f.list.splice($,1)}be(()=>t.show,function($){f.show=$,$&&(f.list=ce(t.list),f.hasEdit=f.list.some(i=>i.key===fe),f.index=-1,m.btn=Ce(),m.column={width:t.columnWidth,max:t.actionMax},setTimeout(()=>{var i,w;(i=c.value)==null||i.clearValidate(),(w=y.value)==null||w.clearValidate()}))},{immediate:!0});const _=[{label:"默认（蓝色）",value:"primary"},{label:"成功（绿色）",value:"success"},{label:"警告（橙色）",value:"warning"},{label:"危险（红色）",value:"danger"},{label:"文本（灰色）",value:"info"}],l="https://element.eleme.cn/#/zh-CN/component/icon",{onDragStart:P,onDragMove:J,onDropEnd:R}=De({list:()=>f.list,key:"key"});function H($){if($.key!=fe&&f.list.length>1&&f.index===-1)return!0}function ae($){const i=$.text;if(X(i,"string")){if(!i.includes("return"))return i;let w="文字配置有误";try{w=new Function("row",i)({})}catch(U){console.warn("解析按钮文字代码错误 >>",U)}return w}return X(i,"function")?i({}):"未设置按钮"}const E=`
<p>可以输入代码片段，</p>
<p>以${ee("return")}关键字为函数标记，</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>例如：${ee('return row.status === 1 ? "下架" : "上架";')}</p>
`,Z=`
<p>函数代码片段，点击的时候运行</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>第二个参数${ee("index")}是当前索引</p>
<p>例如：${ee("console.log(row, index);")}</p>
`,j=`
<p>可以输入代码片段，</p>
<p>以${ee("return")}关键字为函数标记，</p>
<p>函数第一个参数${ee("row")}是表格对象值</p>
<p>例如：${ee("return row.status === 1;")}返回布尔值进行判断</p>
`;return($,i)=>{const w=b("el-text"),U=b("el-divider"),u=b("el-input-number"),d=b("el-form-item"),B=b("el-form"),D=b("el-input"),n=b("el-option"),h=b("el-select"),p=b("el-button"),F=b("el-popconfirm"),I=b("el-empty"),z=b("base-dialog");return s(),C(z,{modelValue:f.show,"onUpdate:modelValue":i[13]||(i[13]=O=>f.show=O),title:"配置操作列按钮功能",width:"880px",onClose:S},{footer:a(()=>[e(g($e),{disabledSubmit:f.formEdit,onClose:S,onSubmit:K},null,8,["disabledSubmit"])]),default:a(()=>[V("div",Kt,[V("section",Gt,[e(U,{"content-position":"left","border-style":"dashed"},{default:a(()=>[e(w,{type:"info"},{default:a(()=>[W("操作列配置")]),_:1})]),_:1}),e(B,{ref_key:"formColumn",ref:y,model:m.column,rules:q,labelPosition:"right",labelWidth:"128px"},{default:a(()=>[e(d,{label:"操作列宽度",prop:"width"},{default:a(()=>[e(u,{modelValue:m.column.width,"onUpdate:modelValue":i[0]||(i[0]=O=>m.column.width=O),class:"w-full","controls-position":"right",placeholder:q.width.message},null,8,["modelValue","placeholder"])]),_:1}),e(d,{label:"操作按钮限制",prop:"max"},{default:a(()=>[e(u,{modelValue:m.column.max,"onUpdate:modelValue":i[1]||(i[1]=O=>m.column.max=O),class:"w-full","controls-position":"right",min:2,placeholder:q.max.message},null,8,["modelValue","placeholder"])]),_:1})]),_:1},8,["model"]),e(U,{"content-position":"left","border-style":"dashed"},{default:a(()=>[e(w,{type:"info"},{default:a(()=>[W("操作按钮配置")]),_:1})]),_:1}),e(B,{ref_key:"formBtn",ref:c,model:m.btn,rules:A,labelPosition:"right",labelWidth:"128px",class:de({"the-filter-mask":!f.formEdit}),"data-tips":"待新增或编辑操作"},{default:a(()=>[e(d,{prop:"text"},{label:a(()=>[e(g(ve),{label:"按钮文字",tips:E})]),default:a(()=>[e(D,{modelValue:m.btn.text,"onUpdate:modelValue":i[2]||(i[2]=O=>m.btn.text=O),type:"textarea",placeholder:A.text.message},null,8,["modelValue","placeholder"])]),_:1}),e(d,{prop:"click"},{label:a(()=>[e(g(ve),{label:"按钮功能代码",tips:Z})]),default:a(()=>[e(D,{modelValue:m.btn.click,"onUpdate:modelValue":i[3]||(i[3]=O=>m.btn.click=O),type:"textarea",placeholder:"请输入代码片段"},null,8,["modelValue"])]),_:1}),e(d,{prop:"show"},{label:a(()=>[e(g(ve),{label:"按钮显示条件",tips:j})]),default:a(()=>[e(D,{modelValue:m.btn.show,"onUpdate:modelValue":i[4]||(i[4]=O=>m.btn.show=O),type:"textarea",placeholder:"请输入条件代码，为空则默认显示"},null,8,["modelValue"])]),_:1}),e(d,{prop:"disabled"},{label:a(()=>[e(g(ve),{label:"按钮禁用条件",tips:j})]),default:a(()=>[e(D,{modelValue:m.btn.disabled,"onUpdate:modelValue":i[5]||(i[5]=O=>m.btn.disabled=O),type:"textarea",placeholder:"请输入条件代码，为空则默认不禁用"},null,8,["modelValue"])]),_:1}),e(d,{label:"按钮图标",prop:"icon"},{default:a(()=>[V("div",Zt,[e(D,{modelValue:m.btn.icon,"onUpdate:modelValue":i[6]||(i[6]=O=>m.btn.icon=O),placeholder:A.icon.message,clearable:""},null,8,["modelValue","placeholder"]),e(w,{type:"primary",style:{width:"110px","text-align":"right"}},{default:a(()=>[V("a",{href:l,target:"_blank"},"去官网复制")]),_:1})])]),_:1}),e(d,{label:"按钮类型",prop:"type"},{default:a(()=>[e(h,{modelValue:m.btn.type,"onUpdate:modelValue":i[7]||(i[7]=O=>m.btn.type=O),placeholder:A.type.message},{default:a(()=>[(s(),T(Y,null,te(_,O=>e(n,{key:O.value,value:O.value,label:O.label},null,8,["value","label"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1}),e(d,null,{default:a(()=>[V("div",Xt,[e(p,{onClick:i[8]||(i[8]=O=>L())},{default:a(()=>[W("取 消")]),_:1}),f.index>-1?(s(),C(p,{key:0,type:"primary",plain:"",onClick:i[9]||(i[9]=O=>G("edit"))},{default:a(()=>[Qt,W(" 确认修改 ")]),_:1})):(s(),C(p,{key:1,type:"primary",plain:"",onClick:i[10]||(i[10]=O=>G("add"))},{default:a(()=>[el,W(" 确认新增 ")]),_:1}))])]),_:1})]),_:1},8,["model","class"])]),e(Ve,{name:"the-group",tag:"div",class:"the-curd-option-list f1"},{default:a(()=>[(s(!0),T(Y,null,te(f.list,(O,ie)=>(s(),T("div",{class:de(["the-curd-option-item f-vertical",{"the-curd-selected":ie===f.index}]),key:O.key,"data-key":O.key!==g(fe)?O.key:null,draggable:H(O),onDragstart:se=>g(P)(ie),onDragover:se=>g(J)(se,ie),onDrop:i[11]||(i[11]=(...se)=>g(R)&&g(R)(...se))},[f.index===-1&&O.key!==g(fe)?(s(),T("i",ll)):M("",!0),e(p,{type:O.type,link:""},{default:a(()=>[O.icon?(s(),T("i",{key:0,class:de(["el-icon--left",O.icon])},null,2)):M("",!0),W(" "+le(ae(O)),1)]),_:2},1032,["type"]),ol,O.key===g(fe)?(s(),C(w,{key:1,type:"info",size:"small"},{default:a(()=>[W("编辑按钮不可删除、拖拽等操作，且处于首位")]),_:1})):(s(),T(Y,{key:2},[e(F,{width:"186px",title:"是否删除该按钮功能？",onConfirm:se=>N(ie)},{reference:a(()=>[e(p,{link:"",type:"danger",disabled:f.index>-1},{default:a(()=>[al]),_:1},8,["disabled"])]),_:2},1032,["onConfirm"]),e(p,{link:"",type:"success",onClick:se=>v(ie)},{default:a(()=>[nl]),_:2},1032,["onClick"])],64))],42,tl))),128)),f.list.length?M("",!0):(s(),C(I,{key:"empty","image-size":120,description:"请添加操作列功能按钮"})),f.formEdit?M("",!0):(s(),T("div",il,[f.formEdit?M("",!0):(s(),C(p,{key:0,type:"primary",plain:"",onClick:i[12]||(i[12]=O=>f.formEdit=!0)},{default:a(()=>[rl,W(" 新增功能按钮 ")]),_:1}))]))]),_:1})])]),_:1},8,["modelValue"])}}}),dl={class:"the-curd-table-model the-curd-scrollbar"},cl=["data-key","draggable","onDragstart","onDragover"],pl={class:"fake-table-head f-vertical"},fl=V("i",{class:"el-icon-rank el-icon--left"},null,-1),ml={class:"fake-table-cell"},yl=V("i",{class:"el-icon-edit"},null,-1),vl=V("i",{class:"el-icon-delete"},null,-1),bl={class:"fake-table-cell f-vertical"},hl={key:1,class:"the-tag blue"},gl=V("div",{class:"fake-table-head fvc"},"操作",-1),_l={class:"fake-table-cell",style:{"text-align":"center"}},wl=V("i",{class:"el-icon-setting"},null,-1),kl=V("i",{class:"el-icon-delete"},null,-1),xl={class:"fake-table-cell"},Vl={class:"f-vertical",key:"fixed"},Dl=V("i",{class:"el-icon-plus el-icon--left"},null,-1),$l={key:0},Sl=V("i",{class:"el-icon-plus el-icon--left"},null,-1),Cl={name:"TableModel"},Tl=ne({...Cl,props:{config:{type:Object,required:!0}},emits:["action"],setup(r,{emit:o}){const t=r,k=o,c="https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg",y=oe({show:!1,type:"add",index:-1,form:void 0,keys:[]}),f=Q(()=>{const i=t.config.columns,w=[],U=[];for(let u=0;u<i.length;u++){const d=i[u];d.prop===he?U.push(d):w.push(d)}return{drag:w,action:U}});function m(i,w){if(y.keys=t.config.columns.map(U=>U.prop),i==="edit"){const U=t.config.columns[w];y.keys=y.keys.filter(u=>u!==U.prop),y.index=w,y.form=U}else y.form=void 0;y.type=i,y.show=!0}function q(i){const w=t.config;if(y.type==="add"){const U=JSON.parse(JSON.stringify(f.value.drag));U.push(i),w.columns=U.concat(f.value.action)}else w.columns[y.index]=i}function A(i){const w=f.value.drag[i];ye({title:"操作提示",content:`是否删除【${w.label}】列？`,cancelText:"取消",confirm(){const U=t.config.columns.findIndex(u=>u.prop===w.prop);t.config.columns.splice(U,1)}})}const{onDragStart:S,onDragMove:K,onDropEnd:G}=De({list:()=>t.config.columns,key:"prop",findLevel:5});function L(i){const w={};return i&&i.width&&(w.width=`${i.width}px`),i&&i.minWidth&&(w.minWidth=`${i.minWidth}px`),w}const v=Q(()=>{const i=t.config.columns;if(i.length>0&&i[i.length-1].prop===he)return i[i.length-1]});function N(){const i=Me(he,"操作");i.minWidth=120,i.width=160,t.config.columns.push(i)}function _(){const i=t.config.columns;ye({title:"操作提示",content:"是否删除操作列？删除之后需要重新配置。",cancelText:"取消",confirm(){i.splice(i.length-1,1),t.config.actions=[],t.config.formEdit&&(t.config.formEdit=void 0)}})}const l=oe({show:!1,keyword:""});function P(){const i=t.config.selectKey;l.keyword=i?i.toString():"",l.show=!0}function J(i){t.config.selectKey=i}const R=oe({show:!1,columnWidth:0,actionMax:0});function H(){R.show=!0,R.columnWidth=v.value.width,R.actionMax=t.config.actionMax}function ae(i,w){t.config.actions=i;const U=t.config.columns.find(u=>u.prop===he);U.width=w}const E=oe({show:!1,form:null,type:"add"});function Z(i){E.type=i,i==="add"&&t.config.formAdd&&(E.form=t.config.formAdd),i==="edit"&&t.config.formEdit&&(E.form=t.config.formEdit),E.show=!0}function j(i,w){const U=t.config,u=U.actions;function d(){const B=u.length>0&&u[0].key===fe;i&&i.fields.length>0?(v.value||N(),B||u.unshift({key:fe,text:"编辑",type:"success",icon:"el-icon-edit"})):B&&u.splice(0,1)}i&&(E.type==="add"?(U.formAdd=i,w&&(U.formEdit=JSON.parse(JSON.stringify(i)),d())):(U.formEdit=i,w&&(U.formAdd=JSON.parse(JSON.stringify(i))),d())),E.show=!1,E.form=null}function $(i){switch(i){case"delete":P();break;case"add":Z("add");break;case"edit":Z("edit");break}}return(i,w)=>{const U=b("el-empty"),u=b("el-button"),d=b("el-tooltip"),B=b("base-table-actions"),D=b("el-text");return s(),T(Y,null,[E.show?M("",!0):(s(),C(g(et),{key:0,class:"mgb-10 w-full",editMode:!0,config:t.config,onAction:$},null,8,["config"])),V("div",dl,[E.show?(s(),C(tt,{key:0,config:E.form,type:E.type,editMode:!0,onChange:j},null,8,["config","type"])):(s(),C(Ve,{key:1,name:"the-group",tag:"div",class:"fake-table"},{default:a(()=>[t.config.columns.length?M("",!0):(s(),C(U,{key:"empty",style:{padding:"10px 40px"},"image-size":120,description:"请添加表格列"})),(s(!0),T(Y,null,te(f.value.drag,(n,h)=>(s(),T("div",{key:n.prop,"data-key":n.prop,class:"fake-table-item",draggable:f.value.drag.length>1,style:Se(L(n)),onDragstart:p=>g(S)(h),onDragover:p=>g(K)(p,h),onDrop:w[0]||(w[0]=p=>g(G)())},[V("div",pl,[fl,e(lt,{column:n},null,8,["column"])]),V("div",ml,[e(u,{circle:"",plain:"",type:"success",size:"small",onClick:p=>m("edit",h)},{default:a(()=>[yl]),_:2},1032,["onClick"]),e(u,{circle:"",plain:"",type:"danger",size:"small",onClick:p=>A(h)},{default:a(()=>[vl]),_:2},1032,["onClick"])]),V("div",bl,[n.cellType==="text"?(s(),T(Y,{key:0},[W("文本内容")],64)):n.cellType==="js"?(s(),T("span",hl,"自定义代码")):M("",!0),e(g(Qe),{column:n,src:c},null,8,["column"])])],44,cl))),128)),v.value?(s(),T("div",{style:Se(L(v.value)),key:g(he),class:"fake-table-item"},[gl,V("div",_l,[e(d,{effect:"dark",content:"配置【操作按钮】和【操作列】的宽度",placement:"top"},{default:a(()=>[e(u,{circle:"",plain:"",type:"primary",size:"small",onClick:w[1]||(w[1]=n=>H())},{default:a(()=>[wl]),_:1})]),_:1}),e(u,{circle:"",plain:"",type:"danger",size:"small",onClick:w[2]||(w[2]=n=>_())},{default:a(()=>[kl]),_:1})]),V("div",xl,[t.config.actions.length?(s(),C(B,{key:0,row:{},index:1,actions:t.config.actions},null,8,["actions"])):(s(),C(D,{key:1,type:"info"},{default:a(()=>[W("待添加操作~")]),_:1}))])],4)):M("",!0),V("div",Vl,[V("div",null,[V("p",null,[e(u,{type:"primary",text:"",onClick:w[3]||(w[3]=n=>m("add"))},{default:a(()=>[Dl,W(" 添加内容列 ")]),_:1})]),v.value?M("",!0):(s(),T("p",$l,[e(u,{type:"primary",text:"",onClick:w[4]||(w[4]=n=>N())},{default:a(()=>[Sl,W(" 添加操作列 ")]),_:1})]))])])]),_:1}))]),E.show?M("",!0):(s(),C(g(Xe),{key:1,type:E.type,onAction:w[5]||(w[5]=n=>k("action",n))},null,8,["type"])),e(jt,{show:y.show,"onUpdate:show":w[6]||(w[6]=n=>y.show=n),type:y.type,keys:y.keys,form:y.form,onSubmit:q},null,8,["show","type","keys","form"]),e(zt,{show:l.show,"onUpdate:show":w[7]||(w[7]=n=>l.show=n),"select-key":l.keyword,onSubmit:J},null,8,["show","select-key"]),e(ul,{show:R.show,"onUpdate:show":w[8]||(w[8]=n=>R.show=n),columnWidth:R.columnWidth,actionMax:R.actionMax,list:t.config.actions,onSubmit:ae},null,8,["show","columnWidth","actionMax","list"])],64)}}}),El={class:"the-curd-example"},Ul={name:"Example"},Ml=ne({...Ul,props:{selected:{type:String},type:{type:String}},emits:["choose"],setup(r,{emit:o}){const t=r,k=o,c=[{...re("input"),placeholder:ue.input},{...re("select"),placeholder:ue.select},{...re("select-multiple"),placeholder:ue["select-multiple"]},{...re("cascader"),placeholder:ue.cascader},{...re("date"),placeholder:ue.date},{...re("checkbox"),options:[{label:"多选-A",value:1},{label:"多选-B",value:2}],defaultValue:[1]},{...re("radio"),options:[{label:"单选-A",value:"radio-1"},{label:"单选-B",value:"radio-2"}],defaultValue:"radio-1"},{...re("switch"),defaultValue:!0},{...re("textarea"),placeholder:ue.textarea},{...re("input-between"),placeholder:["范围区间操作","范围区间操作"]}],y=["radio","checkbox","textarea","switch"],f=Q(()=>t.type==="search"?c.filter(m=>!y.includes(m.type)):c);return(m,q)=>(s(),T("div",El,[(s(!0),T(Y,null,te(f.value,A=>(s(),C(xe,{key:A.type,"field-data":A,class:de(["the-curd-example-item fvc",{"the-curd-selected":t.selected===A.type}]),readonly:"",onClick:S=>k("choose",A.type)},null,8,["field-data","class","onClick"]))),128))]))}}),Ol={key:0,class:"the-curd-editor-content"},Nl=V("h2",{class:"the-title mgb-20"},"基础设置",-1),Bl={class:"f-vertical f-between mgb-20"},Fl=V("h2",{class:"the-title"},"第1步：点击选取组件",-1),Ll={class:"f-vertical mgb-20"},Wl={class:"the-title"},ql=V("div",{class:"f1"},null,-1),Al={key:0,class:"the-curd-target-box"},Yl=V("i",{class:"el-icon-question the-tips-icon mgl-10"},null,-1),Jl=V("a",{href:"https://www.json.cn/",target:"_blank"}," JSON编辑工具 ",-1),jl={class:"f-right"},Pl=V("i",{class:"el-icon--left el-icon-plus"},null,-1),Il=V("i",{class:"el-icon--left el-icon-edit"},null,-1),Hl={name:"Editor"},Rl=ne({...Hl,props:{show:{type:Boolean,default:!1},config:{type:Object,required:!0}},emits:["update:show"],setup(r,{emit:o}){const t=r,k=o;function c(){k("update:show",!1)}const y=["checkbox","radio","switch"],f=["select","select-multiple","radio","checkbox","cascader"],m=["input","textarea","select","radio"],q=["input-between","select-multiple","checkbox","cascader"],A=["input","select","radio"],S=["daterange","datetimerange"],K=A.concat(q),G=`<p>参考 src/utils/index.ts 中的${ee("formatDate")}函数</p>`,L=`
<p>动态表单项的条件显示逻辑函数；</p>
<p>返回${ee("false")}则不展示对应项；</p>
<p>函数有一个参数：${ee("formData")}为当前表单的数据值；</p>
<p>以${ee("return")}为函数代码片段标记；</p>
<p>例如：${ee("return formData.type !== 2")}</p>
`,v=Ne(),N=Q(()=>v.editor.action==="add"),_=Q(()=>{let D=[];return l.formData&&l.formData.type==="date"&&(D=Fe[l.formData.dateType].map((h,p)=>({label:h.text,value:p}))),D.unshift({label:"将预览组件中的值设为默认",value:-1}),D}),l=oe({step:0,formData:void 0});function P(D){l.step=D}const J={label:{required:!0,message:"请输入功能标题",trigger:"blur"},key:{required:!0,trigger:"blur",validator(D,n,h){n?d.includes(n)?h(new Error("当前键值已经被占用！")):h():h(new Error("绑定的键值不能为空"))}},format:{required:!0,message:"格式化规则不能为空",trigger:"blur"},separator:{required:!0,message:"请输入串联符号",trigger:"blur"},defaultValue:{required:!0,trigger:"blur",validator(D,n,h){const p=Z();p===!0?h():h(new Error(p)),h()}},options:{required:!0,trigger:"blur",validator(D,n,h){const p=j();p===!0?h():h(new Error(p))}}},R=ge(),H=oe({options:"",defaultValue:""});function ae(D){D.type!=="date"&&(H.defaultValue=JSON.stringify({value:D.defaultValue})),f.includes(D.type)&&(H.options=JSON.stringify(D.options))}function E(D){var p;const n=v.editor,h=re(D,"",n.type==="search");l.formData=h,ae(h),(p=R.value)==null||p.clearValidate(),P(1)}function Z(){const D='输入的格式必须为 { "value": "input value" }',n=H.defaultValue;if(!n)return D;const h=l.formData.type,p=l.formData.valueType,F=ue[h];try{const I=JSON.parse(n);if(!X(I,"object"))return D;if(h==="switch"&&!X(I.value,"boolean"))return`${F}的绑定值应该为 boolean 类型`;if(q.includes(h)){if(!X(I.value,"array"))return`${F}的绑定值应该为 array 类型`;if(p==="array<number>"&&I.value.some(z=>z!==""&&!X(z,"number")))return"数组中只能出现数字"}if(m.includes(h)&&!["string","number"].includes(Ee(I.value)))return`${F}的绑定值应该为 string/number 类型`;if(h==="date"){const z=l.formData;if(S.includes(z.dateType)){if(!X(I.value,"array"))return"范围日期绑定值应该为 array 类型"}else if(!X(I.value,"string"))return"日期类型绑定值应该为 string 类型"}if(A.includes(h)&&p==="number"&&I.value!==""&&!X(I.value,"number"))return`${F}的绑定值应该为 number 类型`}catch(I){return console.warn("checkDefaultValue >>",I),D}return!0}function j(){const D=H.options;if(!D)return"选项数据不能为空！";try{const n=JSON.parse(D);if(!X(n,"array"))return"选项数据格式不正确，需要为数组类型！";const h=l.formData,p=h.optionSetting.value||"value",F=[void 0,null];for(let I=0;I<n.length;I++){const z=n[I];if(!X(z,"object"))return"数组项必须为对象！";if(F.includes(z[p]))return`数组项的值不能为${F.join("/")}`;if(["array<number>","number"].includes(h.valueType)&&!X(z[p],"number")&&z[p]!=="")return"数组项的值必须为 number 类型"}return!0}catch(n){return console.warn("checkOptions >>",n),"不合法的JSON,注意使用双引号,结尾不能为逗号等"}}function $(){j()===!0&&(l.formData.options=JSON.parse(H.options))}function i(){if(Z()===!0){const n=l.formData,h=JSON.parse(H.defaultValue).value;n.type!=="date"&&(n.defaultValue=h)}}function w(D){const n=Ie.find(p=>p.value===D),h=l.formData;h.shortcutIndex="",S.includes(n.value)?(h.value=[],h.valueType="array"):(h.value="",h.valueType="string"),h.formatShow=n.formatShow,h.format=n.format}function U(D){return/^[+-]?(\d|([1-9]\d+))(\.\d+)?$/.test(D)}function u(){var D;(D=R.value)==null||D.validate(n=>{if(ft("#the-editor-form",n),!n)return;i(),f.includes(l.formData.type)&&$();const h=v.editor,p=JSON.parse(JSON.stringify(l.formData));if(f.includes(p.type)&&$(),p.valueType||(p.valueType=Ee(p.defaultValue)),f.includes(p.type)&&["number","array<number>"].includes(p.valueType)){let I=p.optionSetting.value;I||(I="value",p.optionSetting.value=I);for(let z=0;z<p.options.length;z++){const O=p.options[z],ie=O[I];if([null,void 0].includes(ie))return pe.error("数据值字段与选项数据不匹配，请检查！");if(U(ie.toString()))O[I]=Number(ie);else{const se=O[p.optionSetting.label];return pe.error(`选项数据中【${se}】的值应该为数字！`)}}}p.type==="date"&&!X(p.shortcutIndex,"number")&&(p.value=p.valueType==="array"?[]:""),{search(I){I?t.config.search.list.push(p):t.config.search.list[h.index]=p},table(I){if(I){const z=JSON.parse(JSON.stringify(h.form.fields));z.push(p),h.form.fields=z}else{const z=JSON.parse(JSON.stringify(h.form.fields));z[h.index]=p,h.form.fields=z}}}[h.type](N.value),c()})}let d=[];function B(D){const n=v.editor;d=[],{search(){d=t.config.search.list.map(p=>p.key)},table(){d=n.form.fields.map(p=>p.key)}}[n.type](),D&&(d=d.filter(p=>p!==D))}return be(()=>t.show,function(D){if(!D){l.formData=void 0;return}const n=v.editor;if(n.action==="add")l.step=0,l.formData=void 0,B();else{const h=n.index;({search(){l.formData=JSON.parse(JSON.stringify(t.config.search.list[h]))},table(){var F;l.formData=JSON.parse(JSON.stringify((F=n.form)==null?void 0:F.fields[h]))}})[n.type](),ae(l.formData),B(l.formData.key),l.step=1}}),(D,n)=>{const h=b("el-input-number"),p=b("el-form-item"),F=b("el-switch"),I=b("el-form"),z=b("el-button"),O=b("el-input"),ie=b("el-text"),se=b("el-tooltip"),Le=b("el-option"),We=b("el-select");return s(),T("section",{class:de(["the-curd-editor the-curd-scrollbar",{"is-show":t.show}])},[e(it,{name:"the-curd-editor-move"},{default:a(()=>{var qe;return[t.show?(s(),T("div",Ol,[Nl,e(I,{"label-position":"right","label-width":"120px"},{default:a(()=>[g(v).editor.type==="search"?(s(),T(Y,{key:0},[e(p,{label:"整体标题宽度"},{default:a(()=>[e(h,{modelValue:t.config.search.labelWidth,"onUpdate:modelValue":n[0]||(n[0]=x=>t.config.search.labelWidth=x),class:"w-full","controls-position":"right",placeholder:"例如：120px"},null,8,["modelValue"])]),_:1}),e(p,{label:"标题靠右对齐"},{default:a(()=>[e(F,{modelValue:t.config.search.labelRight,"onUpdate:modelValue":n[1]||(n[1]=x=>t.config.search.labelRight=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):M("",!0),g(v).editor.type==="table"&&g(v).editor.form?(s(),T(Y,{key:1},[e(p,{label:"表单宽度"},{default:a(()=>[e(h,{modelValue:g(v).editor.form.width,"onUpdate:modelValue":n[2]||(n[2]=x=>g(v).editor.form.width=x),class:"w-full","controls-position":"right",placeholder:"请输入宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"文字宽度"},{default:a(()=>[e(h,{modelValue:g(v).editor.form.labelWidth,"onUpdate:modelValue":n[3]||(n[3]=x=>g(v).editor.form.labelWidth=x),class:"w-full","controls-position":"right",placeholder:"请输入标题宽度(px)",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"文字靠右排版"},{default:a(()=>[e(F,{modelValue:g(v).editor.form.labelPosition,"onUpdate:modelValue":n[4]||(n[4]=x=>g(v).editor.form.labelPosition=x),"inline-prompt":"","active-value":"right","inactive-value":"left","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):M("",!0)]),_:1}),l.step===0?(s(),T(Y,{key:0},[V("div",Bl,[Fl,e(z,{link:"",type:"primary",onClick:n[5]||(n[5]=x=>c())},{default:a(()=>[W("退出编辑")]),_:1})]),e(Ml,{selected:(qe=l.formData)==null?void 0:qe.type,type:g(v).editor.type,onChoose:E},null,8,["selected","type"])],64)):M("",!0),l.step===1?(s(),T(Y,{key:1},[V("div",Ll,[V("h2",Wl,"第2步：配置"+le(g(ue)[l.formData.type]),1),ql,e(z,{link:"",type:"success",onClick:n[6]||(n[6]=x=>P(0))},{default:a(()=>[W("上一步")]),_:1}),e(z,{link:"",type:"primary",onClick:n[7]||(n[7]=x=>c())},{default:a(()=>[W("退出编辑")]),_:1})]),l.formData?(s(),T("div",Al,[e(xe,{"field-data":l.formData,"edit-mode":""},null,8,["field-data"])])):M("",!0),l.formData?(s(),C(I,{key:1,id:"the-editor-form",ref_key:"formRef",ref:R,model:l.formData,rules:J,"label-position":"right","label-width":"128px"},{default:a(()=>[e(p,{label:"组件标题",prop:"label"},{default:a(()=>[e(O,{modelValue:l.formData.label,"onUpdate:modelValue":n[8]||(n[8]=x=>l.formData.label=x),clearable:"",placeholder:J.label.message},null,8,["modelValue","placeholder"])]),_:1}),e(p,{label:"绑定的键值",prop:"key"},{default:a(()=>[e(O,{modelValue:l.formData.key,"onUpdate:modelValue":n[9]||(n[9]=x=>l.formData.key=x),clearable:"",placeholder:"请输入绑定的键值"},null,8,["modelValue"])]),_:1}),e(p,{label:"标题宽度",prop:"labelWidth"},{default:a(()=>[e(h,{modelValue:l.formData.labelWidth,"onUpdate:modelValue":n[10]||(n[10]=x=>l.formData.labelWidth=x),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：120"},null,8,["modelValue"])]),_:1}),y.includes(l.formData.type)?M("",!0):(s(),C(p,{key:0,label:"组件宽度",prop:"valueWidth"},{default:a(()=>[e(h,{modelValue:l.formData.valueWidth,"onUpdate:modelValue":n[11]||(n[11]=x=>l.formData.valueWidth=x),class:"w-full","controls-position":"right",placeholder:"请输入宽度，例如：140"},null,8,["modelValue"])]),_:1})),e(p,{label:"提示/规则文字",prop:"placeholder"},{default:a(()=>[l.formData.type==="input-between"?(s(),T(Y,{key:0},[e(O,{modelValue:l.formData.placeholder[0],"onUpdate:modelValue":n[12]||(n[12]=x=>l.formData.placeholder[0]=x),class:"f1",clearable:"",placeholder:"请输入提示-1"},null,8,["modelValue"]),e(ie,{style:{padding:"0 6px"}},{default:a(()=>[W("-")]),_:1}),e(O,{modelValue:l.formData.placeholder[1],"onUpdate:modelValue":n[13]||(n[13]=x=>l.formData.placeholder[1]=x),class:"f1",clearable:"",placeholder:"请输入提示-2"},null,8,["modelValue"])],64)):(s(),C(O,{key:1,modelValue:l.formData.placeholder,"onUpdate:modelValue":n[14]||(n[14]=x=>l.formData.placeholder=x),clearable:"",placeholder:"请输入规则提示/输入框提示文字"},null,8,["modelValue"]))]),_:1}),e(p,{label:"是否必填",prop:"required"},{default:a(()=>[e(F,{modelValue:l.formData.required,"onUpdate:modelValue":n[15]||(n[15]=x=>l.formData.required=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),g(K).includes(l.formData.type)?(s(),C(p,{label:"绑定值为数字类型",key:"is-number"},{default:a(()=>[q.includes(l.formData.type)?(s(),C(F,{key:0,modelValue:l.formData.valueType,"onUpdate:modelValue":n[16]||(n[16]=x=>l.formData.valueType=x),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"array<number>","inactive-value":"array"},null,8,["modelValue"])):(s(),C(F,{key:1,modelValue:l.formData.valueType,"onUpdate:modelValue":n[17]||(n[17]=x=>l.formData.valueType=x),"inline-prompt":"","active-text":"是","inactive-text":"否","active-value":"number","inactive-value":"string"},null,8,["modelValue"])),f.includes(l.formData.type)?(s(),C(se,{key:2,effect:"dark",content:"设为数字类型之后，将会在保存时校验选项数据",placement:"top"},{default:a(()=>[Yl]),_:1})):M("",!0)]),_:1})):M("",!0),l.formData.type!=="date"?(s(),C(p,{key:2,label:"组件默认值",prop:"defaultValue"},{default:a(()=>[e(O,{modelValue:H.defaultValue,"onUpdate:modelValue":n[18]||(n[18]=x=>H.defaultValue=x),type:"textarea",clearable:"",placeholder:"请输入JSON，值为 value",onBlur:n[19]||(n[19]=x=>i())},null,8,["modelValue"])]),_:1})):M("",!0),l.formData.type==="input-between"?(s(),C(p,{key:3,label:"串联符号",prop:"separator"},{default:a(()=>[e(O,{modelValue:l.formData.separator,"onUpdate:modelValue":n[20]||(n[20]=x=>l.formData.separator=x),clearable:"",placeholder:J.separator.message},null,8,["modelValue","placeholder"])]),_:1})):M("",!0),f.includes(l.formData.type)?(s(),T(Y,{key:4},[e(p,{label:"选项数据",prop:"options"},{default:a(()=>[e(O,{modelValue:H.options,"onUpdate:modelValue":n[21]||(n[21]=x=>H.options=x),type:"textarea",autosize:{minRows:2,maxRows:10},placeholder:"请输入数组JSON",style:{"margin-bottom":"4px"},onBlur:n[22]||(n[22]=x=>$())},null,8,["modelValue"]),e(z,{link:"",type:"primary"},{default:a(()=>[Jl]),_:1})]),_:1}),e(p,{label:"数据展示字段",prop:"optionSetting.label"},{default:a(()=>[e(O,{modelValue:l.formData.optionSetting.label,"onUpdate:modelValue":n[23]||(n[23]=x=>l.formData.optionSetting.label=x),clearable:"",placeholder:"不填则使用 label"},null,8,["modelValue"])]),_:1}),e(p,{label:"数据值字段",prop:"optionSetting.value"},{default:a(()=>[e(O,{modelValue:l.formData.optionSetting.value,"onUpdate:modelValue":n[24]||(n[24]=x=>l.formData.optionSetting.value=x),clearable:"",placeholder:"不填则使用 value"},null,8,["modelValue"])]),_:1}),l.formData.type==="cascader"?(s(),T(Y,{key:0},[e(p,{label:"下级字段",prop:"optionSetting.children"},{default:a(()=>[e(O,{modelValue:l.formData.optionSetting.children,"onUpdate:modelValue":n[25]||(n[25]=x=>l.formData.optionSetting.children=x),clearable:"",placeholder:"不填则使用 children"},null,8,["modelValue"])]),_:1}),e(p,{label:"是否多选",prop:"multiple"},{default:a(()=>[e(F,{modelValue:l.formData.multiple,"onUpdate:modelValue":n[26]||(n[26]=x=>l.formData.multiple=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1}),e(p,{label:"允许只选中某一项",prop:"checkStrictly"},{default:a(()=>[e(F,{modelValue:l.formData.checkStrictly,"onUpdate:modelValue":n[27]||(n[27]=x=>l.formData.checkStrictly=x),"inline-prompt":"","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})],64)):M("",!0)],64)):M("",!0),l.formData.type==="date"?(s(),T(Y,{key:5},[e(p,{label:"日期类型",prop:"dateType"},{default:a(()=>[e(We,{modelValue:l.formData.dateType,"onUpdate:modelValue":n[28]||(n[28]=x=>l.formData.dateType=x),class:"w-full",onChange:w},{default:a(()=>[(s(!0),T(Y,null,te(g(Ie),x=>(s(),C(Le,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"日期默认值",prop:"shortcutIndex"},{default:a(()=>[e(We,{modelValue:l.formData.shortcutIndex,"onUpdate:modelValue":n[29]||(n[29]=x=>l.formData.shortcutIndex=x),class:"w-full",placeholder:"请选择",clearable:""},{default:a(()=>[(s(!0),T(Y,null,te(_.value,x=>(s(),C(Le,{key:x.value,label:x.label,value:x.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{prop:"format"},{label:a(()=>[e(g(ve),{label:"格式化规则",tips:G})]),default:a(()=>[e(O,{modelValue:l.formData.format,"onUpdate:modelValue":n[30]||(n[30]=x=>l.formData.format=x),clearable:"",placeholder:J.format.message},null,8,["modelValue","placeholder"])]),_:1})],64)):M("",!0),g(v).editor.type==="table"?(s(),C(p,{key:6,prop:"show"},{label:a(()=>[e(g(ve),{label:"表单显示逻辑",tips:L})]),default:a(()=>[e(O,{modelValue:l.formData.show,"onUpdate:modelValue":n[31]||(n[31]=x=>l.formData.show=x),type:"textarea",placeholder:"请输入条件代码，为空则默认展示"},null,8,["modelValue"])]),_:1})):M("",!0),V("div",jl,[e(z,{onClick:n[32]||(n[32]=x=>c())},{default:a(()=>[W("关闭")]),_:1}),N.value?(s(),C(z,{key:0,type:"primary",onClick:n[33]||(n[33]=x=>u())},{default:a(()=>[Pl,W(" 新增 ")]),_:1})):(s(),C(z,{key:1,type:"success",onClick:n[34]||(n[34]=x=>u())},{default:a(()=>[Il,W(" 确认 ")]),_:1}))])]),_:1},8,["model"])):M("",!0)],64)):M("",!0)])):M("",!0)]}),_:1})],2)}}}),zl=["data-key","onDragstart","onDragover"],Kl=V("i",{class:"el-icon--left el-icon-rank"},null,-1),Gl={class:"f1"},Zl={name:"TableSetting"},Xl=ne({...Zl,props:{show:{type:Boolean,default:!1},columns:{type:Array,required:!0}},emits:["update:show","submit"],setup(r,{emit:o}){const t=r,k=o,c=[{label:"固定左边",value:"left"},{label:"默认",value:!1},{label:"固定右边",value:"right"}],y=oe({show:!1,list:[]}),{onDragStart:f,onDragMove:m,onDropEnd:q}=De({list:()=>y.list,key:"prop"});let A;function S(){k("update:show",!1)}function K(){S();const G=ce(y.list);A&&G.push(A),k("submit",G)}return be(()=>t.show,function(G){if(y.show=G,!G)return;const L=ce(t.columns),v=[];for(let N=0;N<L.length;N++){const _=L[N];_.prop===he?A=_:v.push(_)}y.list=v},{immediate:!0}),(G,L)=>{const v=b("el-radio-button"),N=b("el-radio-group"),_=b("el-switch"),l=b("el-empty"),P=b("base-dialog");return s(),C(P,{modelValue:y.show,"onUpdate:modelValue":L[1]||(L[1]=J=>y.show=J),title:"表格设置",width:"840px",onClose:S},{footer:a(()=>[e(g($e),{onClose:S,onSubmit:K})]),default:a(()=>[e(Ve,{name:"the-group",tag:"div"},{default:a(()=>[(s(!0),T(Y,null,te(y.list,(J,R)=>(s(),T("div",{class:"the-curd-option-item f-vertical",key:J.prop,"data-key":J.prop,draggable:!0,onDragstart:H=>g(f)(R),onDragover:H=>g(m)(H,R),onDrop:L[0]||(L[0]=(...H)=>g(q)&&g(q)(...H))},[Kl,V("span",Gl,le(J.label),1),e(N,{modelValue:J.fixed,"onUpdate:modelValue":H=>J.fixed=H,size:"small",class:"mgr-10"},{default:a(()=>[(s(),T(Y,null,te(c,H=>e(v,{key:H.value.toString(),value:H.value},{default:a(()=>[W(le(H.label),1)]),_:2},1032,["value"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(_,{modelValue:J.visible,"onUpdate:modelValue":H=>J.visible=H,"inline-prompt":"","active-text":"显示","inactive-text":"隐藏"},null,8,["modelValue","onUpdate:modelValue"])],40,zl))),128)),y.list.length?M("",!0):(s(),C(l,{key:"empty","image-size":120,description:"暂无可以设置的表格列"}))]),_:1})]),_:1},8,["modelValue"])}}}),Ql={class:"the-curd-main-page"},eo={class:"f-vertical mgb-10"},to={key:0,class:"the-tag blue"},lo=V("div",{class:"f1"},null,-1),oo=V("i",{class:"el-icon-arrow-left"},null,-1),ao=V("p",{class:"mgb-10"},"配置筛选相关功能",-1),no=V("p",null,"配置表格相关功能",-1),io={name:"Curd"},fo=ne({...io,props:{data:{type:Object,required:!0},action:{type:Object,required:!0}},setup(r){const o=r,t=oe({loading:!1,editor:{show:!1,type:void 0,form:void 0,action:"add",index:-1},showEntrance:!1}),k=Q(()=>{const u=t.editor.type;return u==="search"||!u&&o.data.search.list.length>0});rt(ze,t);let c;function y(u){t.editor.type=u,t.editor.show=!1,t.editor.index=-1,t.showEntrance=!1,c={[u]:ce(o.data[u])}}function f(u){const d=t.editor.type;u&&c&&(o.data[d]=c[d]),t.editor.index=-1,t.editor.show=!1,t.editor.type=void 0,t.editor.form=void 0,c=void 0}function m(){f()}function q(){Je(JSON.stringify(o.data),()=>pe.success("复制成功！"))}function A(u){u==="reset"&&o.data.search.list.forEach(Be),S.pageInfo.currentPage=1,S.selectList=[],Z()}const S=oe({selectList:[],data:[],pageInfo:ct(),formShow:!1,formType:"add",formLoading:!1}),K=Q(()=>o.data.table.columns.filter(d=>d.visible).map(d=>{const B={...d};return B.cellType==="js"&&B.jsCode&&(B.rawContent=function(D,n){let h="";try{h=new Function("cellValue","row",B.jsCode)(D,n)}catch(p){console.warn("解析 rawContent 代码错误 >>",p),h="-"}return h}),B})),G=Q(()=>o.data.table.actions.map(d=>{const B={...d};return B.key===fe&&(B.click=J),B})),L=Q(()=>{const u=[],d=[];return K.value.forEach(B=>{B.slotHead&&u.push(B.slotHead),B.slot&&d.push(B.slot)}),{head:u,cell:d}});function v(u){return o.data.table.columns.find(B=>B.prop===u)||{}}const N=ge(),_=Q(()=>{const u=o.data.table,d={title:"编辑表单",config:u.formEdit||{}};return S.formType==="add"&&(d.title="新增表单",d.config=u.formAdd||{}),d});let l=null;function P(){var u;l&&((u=N.value)==null||u.setFormData(l))}function J(u){u?(S.formType="edit",l=u):S.formType="add",S.formShow=!0,setTimeout(()=>{var d;return(d=N.value)==null?void 0:d.clear()})}function R(){var u;S.formShow=!1,(u=N.value)==null||u.reset(),l=null}function H(){var u;(u=N.value)==null||u.validate(async(d,B)=>{if(S.formType==="add"&&o.action.onAdd){S.formLoading=!0;const D=await o.action.onAdd(d,B);if(S.formLoading=!1,D.code!==1)return;R(),Z()}if(S.formType==="edit"&&o.action.onEdit){S.formLoading=!0;const D=await o.action.onEdit(d,B);if(S.formLoading=!1,D.code!==1)return;R(),Z()}})}function ae(u,d){const B=o.data.table.columns;for(let D=0;D<B.length;D++){const n=B[D];n.sort&&(n.prop===u?n.sort=d:n.sort=!0)}Z()}function E(){const u=o.data.search.list,d={};for(let h=0;h<u.length;h++){const p=u[h],F=Ge(p);if(p.required&&X(F.result,"string"))return mt(document.querySelector(`.${p.id}`)),pe.error(F.result),null;F.result===!0&&(d[p.key]=F.value)}const B=o.data.table.columns,D=[],n=[];return B.forEach(h=>{h.sort==="asc"&&D.push(h.prop),h.sort==="desc"&&n.push(h.prop)}),D.length&&(d.asc=D.toString()),n.length&&(d.desc=n.toString()),d}async function Z(){const u=E();if(!u)return;const d=JSON.parse(JSON.stringify(S.pageInfo));t.loading=!0;const B=await o.action.getTableData(u,d);t.loading=!1,B.code===1&&(S.pageInfo.total=B.data.total,S.data=B.data.list||[])}function j(u){const d=S.selectList;switch(u){case"add":J();break;case"delete":if(!d.length)return pe.error("请选择要删除的列表再进行操作~");ye({title:"操作提示",content:`是否删除选中的 ${d.length} 条数据？`,cancelText:"取消",async confirm(){o.action.onDelete?(t.loading=!0,(await o.action.onDelete(JSON.parse(JSON.stringify(S.selectList)))).code===1?(pe.success("删除成功！"),S.selectList=[],Z()):t.loading=!1):pe.info("请设置 action.onDelete 删除逻辑")}});break;case"setting":w();break;case"export":o.action.onExport?o.action.onExport():pe.info("请设置 action.onExport 导出逻辑");break}}function $(u){({exit:()=>f(!0),copy:q,complete:m})[u]()}const i=oe({show:!1});function w(){i.show=!0}function U(u){o.data.table.columns=u}return vt({formatDate:Ue,copyText:Je,messageBox:ye,message:pe,jsonToPath:pt,request:yt,getData:Z,state:t}),Re(function(){o.action.created&&o.data.table.columns.length&&o.action.created(Z)}),(u,d)=>{const B=b("base-table"),D=b("base-pagination"),n=b("el-button"),h=b("el-empty"),p=b("base-dialog");return s(),T("div",Ql,[V("section",{class:de([t.editor.show?"f1":"w-full"])},[k.value?(s(),C(Dt,{key:0,data:o.data.search,onSearch:A},null,8,["data"])):M("",!0),t.editor.type==="table"?(s(),C(Tl,{key:1,config:o.data.table,onAction:$},null,8,["config"])):t.editor.type==="search"?(s(),C(g(Xe),{key:2,onAction:$})):(s(),T(Y,{key:3},[o.data.table.columns.length>0?(s(),T(Y,{key:0},[V("div",eo,[o.data.table.selectKey?(s(),T("span",to," 已选择 "+le(S.selectList.length)+" 条数据 ",1)):M("",!0),lo,e(g(et),{config:o.data.table,disabled:t.loading,onAction:j},null,8,["config","disabled"])]),e(B,{"select-list":S.selectList,"onUpdate:selectList":d[0]||(d[0]=F=>S.selectList=F),data:S.data,columns:K.value,actions:G.value,actionMax:o.data.table.actionMax,loading:t.loading,"select-key":o.data.table.selectKey},Te({_:2},[te(L.value.head,F=>({name:F,fn:a(({$index:I})=>[e(lt,{column:K.value[o.data.table.selectKey?I-1:I],onSort:ae},null,8,["column"])])})),te(L.value.cell,F=>({name:F,fn:a(({row:I})=>[e(g(Qe),{column:v(F),src:I[F],previewList:L.value.cell.map(z=>I[z])},null,8,["column","src","previewList"])])}))]),1032,["select-list","data","columns","actions","actionMax","loading","select-key"]),e(D,{disabled:t.loading,pageInfo:S.pageInfo,onChange:Z},null,8,["disabled","pageInfo"])],64)):(s(),C(h,{key:1,description:"当前页面没有表格配置数据，请配置后再操作~"},{default:a(()=>[e(n,{type:"primary",onClick:d[1]||(d[1]=F=>y("table"))},{default:a(()=>[W("去配置")]),_:1})]),_:1}))],64))],2),e(Rl,{show:t.editor.show,"onUpdate:show":d[2]||(d[2]=F=>t.editor.show=F),config:o.data},null,8,["show","config"]),e(p,{modelValue:S.formShow,"onUpdate:modelValue":d[5]||(d[5]=F=>S.formShow=F),title:_.value.title,width:g(_e)(_.value.config.width),onClose:d[6]||(d[6]=F=>R()),onAfterEnd:d[7]||(d[7]=F=>P())},{footer:a(()=>[e(g($e),{loading:S.formLoading,onClose:d[3]||(d[3]=F=>R()),onSubmit:d[4]||(d[4]=F=>H())},null,8,["loading"])]),default:a(()=>[e(tt,{ref_key:"formRef",ref:N,config:_.value.config,type:S.formType,disabled:S.formLoading},null,8,["config","type","disabled"])]),_:1},8,["modelValue","title","width"]),e(Xl,{show:i.show,"onUpdate:show":d[8]||(d[8]=F=>i.show=F),columns:o.data.table.columns,onSubmit:U},null,8,["show","columns"]),!t.showEntrance&&!t.editor.type?(s(),C(n,{key:0,class:"the-curd-entrance",type:"primary",size:"small",onClick:d[9]||(d[9]=F=>t.showEntrance=!0)},{default:a(()=>[oo]),_:1})):M("",!0),e(p,{modelValue:t.showEntrance,"onUpdate:modelValue":d[13]||(d[13]=F=>t.showEntrance=F),title:"请选择配置操作",width:"600px"},{footer:a(()=>[e(n,{onClick:d[12]||(d[12]=F=>t.showEntrance=!1)},{default:a(()=>[W("关 闭")]),_:1})]),default:a(()=>[V("div",{class:"the-curd-entrance-item",onClick:d[10]||(d[10]=F=>y("search"))},[ao,e(g(St))]),V("div",{class:"the-curd-entrance-item",onClick:d[11]||(d[11]=F=>y("table"))},[no,e(g(Ct))])]),_:1},8,["modelValue"])])}}});export{fo as _,Me as a,fe as b,he as c,re as g};
