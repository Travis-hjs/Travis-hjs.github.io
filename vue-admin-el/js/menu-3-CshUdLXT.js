import{f as q,g as b,J as G,b as z,h as _,i as y,p as h,k as O,j,q as $,n as D,d as J,t as S,u as v,ay as Q,az as W,D as X,m as E,G as Y,F as R,l as T,s as U,H as Z,r as H,a as ee,w as te,N as ne,c as A}from"./element-plus-q5-fTtZa.js";import{u as se,t as F,q as I}from"./index-C_bH1vCy.js";function ae(p,e){return p[e.label]||"-"}const le=[null,void 0,""];function x(p,e){const t=p[e.key],a=p[e.value];return le.includes(t)?a:t}function oe(){const p={};return{on(e,t){p.hasOwnProperty(e)||(p[e]=[]),p[e].some(a=>a===t)||p[e].push(t)},off(e,t){const a=p[e];if(a&&a.length>0&&t){for(let s=0;s<a.length;s++)if(a[s]===t){a.splice(s,1);break}}else console.log("[moduleEvent] => 没有要解绑的事件")},dispatch(e,t){const a=p[e];if(a&&a.length>0)for(let s=0;s<a.length;s++){const r=a[s];r(t)}else console.log("[moduleEvent] => 没有要执行的事件")}}}const K=oe(),ie={class:"the-tree"},re={class:"the-tree-item f-vertical"},ue={key:1,class:"the-tree-icon fvc"},ce={class:"the-tree-sub"},de={name:"Level"},pe=q({...de,props:{option:{type:Object,required:!0},setting:{type:Object,required:!0},openKeys:{type:Array,required:!0},parentKeys:{type:Array,required:!0},parentValues:{type:Array,required:!0},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},disabled:{type:Function,default:void 0},usableValueMap:{type:Object,required:!0}},setup(p){const e=p,t=b(()=>e.option[e.setting.children]||[]),a=b(()=>x(e.option,e.setting)),s=b(()=>e.option[e.setting.value]),r=b(()=>e.openKeys.includes(a.value)),k=b(()=>e.values.includes(s.value)),c=b(()=>e.disabled?e.disabled(e.option):!1),L=b(()=>{if(!k.value)return!1;const i=e.usableValueMap[a.value];return i?i.some(u=>!e.values.includes(u)):!1}),{onBeforeEnter:C,onEnter:V,onAfterEnter:g,onBeforeLeave:M,onLeave:B,onAfterLeave:w}=se(),o=G("treeRoot");function n(){K.dispatch(o.eventMap.itemOpen,a.value)}function l(){if(c.value)return;const i={key:a.value,value:s.value,parentKeys:e.parentKeys,parentValues:e.parentValues,hasSub:t.value.length>0};K.dispatch(o.eventMap.itemCheck,i)}return(i,u)=>{const f=z("Level",!0);return y(),_("div",ie,[h("div",re,[t.value.length>0?(y(),_("div",{key:0,class:"the-tree-icon fvc cursor-pointer",onClick:u[0]||(u[0]=d=>n())},[h("i",{class:D(["el-icon-caret-right",{"is-opened":r.value}])},null,2)])):(y(),_("div",ue,[...u[2]||(u[2]=[h("i",{class:"el-icon-collection-tag"},null,-1)])])),p.checkbox?(y(),_("span",{key:2,onClick:u[1]||(u[1]=d=>l()),class:D(["el-checkbox el-checkbox__input",{"is-checked":k.value,"is-disabled":c.value,"is-indeterminate":L.value}])},[...u[3]||(u[3]=[h("span",{class:"el-checkbox__inner"},null,-1)])],2)):j("",!0),$(i.$slots,"treeitem",Q(W(e.option)),()=>[J(S(v(ae)(e.option,e.setting)),1)])]),t.value.length>0?(y(),O(X,{key:0,onBeforeEnter:v(C),onEnter:v(V),onAfterEnter:v(g),onBeforeLeave:v(M),onLeave:v(B),onAfterLeave:v(w)},{default:E(()=>[Y(h("div",ce,[(y(!0),_(R,null,T(t.value,d=>(y(),O(f,{key:v(x)(d,e.setting),option:d,setting:e.setting,"open-keys":e.openKeys,checkbox:e.checkbox,values:e.values,disabled:e.disabled,"usable-value-map":e.usableValueMap,"parent-keys":[...e.parentKeys,a.value],"parent-values":[...e.parentValues,s.value]},{treeitem:E(m=>[$(i.$slots,"treeitem",U({ref_for:!0},m))]),_:3},8,["option","setting","open-keys","checkbox","values","disabled","usable-value-map","parent-keys","parent-values"]))),128))],512),[[Z,r.value]])]),_:3},8,["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])):j("",!0)])}}}),fe={name:"Tree"},N=q({...fe,props:{options:{type:Array,default:()=>[]},optionSetting:{type:Object,default:()=>({})},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},checkParent:{type:Boolean,default:!1},checkChild:{type:Boolean,default:!1},filterMethod:{type:Function,default:void 0},disabledMethod:{type:Function,default:void 0}},emits:["update:values"],setup(p,{emit:e}){const t=p,a=e,s=b(()=>({label:"label",value:"value",children:"children",...t.optionSetting})),r=H({allKeys:[],openKeys:[]});function k(o,n){return o.forEach(l=>{n.push(x(l,s.value));const i=l[s.value.children]||[];i.length>0&&k(i,n)}),n}function c(o,n){return o.forEach(l=>{const i=l[s.value.value];t.disabledMethod?!t.disabledMethod(l)&&n.push(i):n.push(i);const u=l[s.value.children]||[];u.length>0&&c(u,n)}),n}function L(o,n){for(let l=0;l<o.length;l++){const i=o[l];if(x(i,s.value)===n)return i;const u=i[s.value.children]||[];if(u.length>0){const f=L(u,n);if(f)return f}}}function C(o){r.openKeys.includes(o)?r.openKeys=r.openKeys.filter(n=>n!==o):r.openKeys.push(o)}function V(o){const{value:n,parentValues:l,key:i,hasSub:u}=o;let f=[];if(t.checkChild&&u){const m=L(t.options,i);m&&(f=m[s.value.children]||[])}let d=I(t.values);if(d.includes(n)){if(d=d.filter(m=>m!==n),f.length>0){const m=c(f,[]);d=d.filter(P=>!m.includes(P))}}else d.push(n),t.checkParent&&d.push(...l),f.length>0&&d.push(...c(f,[])),(t.checkParent||f.length>0)&&(d=[...new Set(d)]);a("update:values",d)}const g={itemCheck:F("tree-item-check"),itemOpen:F("tree-item-open")};K.on(g.itemOpen,C),K.on(g.itemCheck,V),ee(function(){K.off(g.itemCheck,V),K.off(g.itemOpen,C)}),ne("treeRoot",{eventMap:g});function M(o){return o.filter(n=>{const l=n[s.value.children]||[];return!!(l.length>0&&(n[s.value.children]=M(l),n[s.value.children].length>0)||t.filterMethod(n))})}const B=b(()=>t.filterMethod?M(I(t.options)):t.options),w=b(()=>{if(t.checkParent||t.checkChild){let o=function(l){const i=l[s.value.children]||[];if(i.length<1)return;const u=x(l,s.value);n[u]=[];for(const f of i){const d=x(f,s.value),m=f[s.value.value];(t.disabledMethod?t.disabledMethod(f):!1)||n[u].push(m),o(f),n[d]&&n[u].push(...n[d])}};const n={};for(const l of t.options)o(l);return n}return{}});return te(()=>t.options,function(o){const n=k(o,[]);r.openKeys=r.openKeys.filter(l=>n.includes(l)),r.allKeys=n},{immediate:!0,deep:!0}),(o,n)=>(y(!0),_(R,null,T(B.value,l=>(y(),O(pe,{key:v(x)(l,s.value),option:l,setting:s.value,"open-keys":r.openKeys,checkbox:t.checkbox,values:t.values,disabled:t.disabledMethod,"parent-keys":[],"parent-values":[],"usable-value-map":w.value},{treeitem:E(i=>[$(o.$slots,"default",U({ref_for:!0},i))]),_:3},8,["option","setting","open-keys","checkbox","values","disabled","usable-value-map"]))),128))}}),ve={class:"menu-3"},he={class:"ml-[4px] text-amber-400 text-[12px]"},ye=q({__name:"menu-3",setup(p){const e=[{id:"1",name:"选项 1",list:[{id:"1-1",name:"选项 1-1"},{id:"1-2",name:"选项 1-2",list:[{id:"1-2-1",name:"选项 1-2-1"},{id:"1-2-2",name:"选项 1-2-2"},{id:"1-2-3",name:"选项 1-2-3"},{id:"1-2-4",name:"选项 1-2-4"}]},{id:"1-3",name:"选项 1-3"},{id:"1-4",name:"选项 1-4"},{id:"1-5",name:"选项 1-5"}]},{id:"2",name:"选项 2",list:[{id:"2-1",name:"选项 2-1",list:[{id:"**s",name:"三级选项-1"},{id:"**",name:"三级选项-2"},{id:"999",name:"三级选项-3"}]},{id:"2-2",name:"选项 2-2"},{id:"2-3",name:"选项 2-3"}]}],t={value:"id",label:"name",children:"list"},a=H({values:["1"],keyword:""});return(s,r)=>{const k=z("el-input");return y(),_("div",ve,[A(k,{class:"max-w-[300px] mb-[10px]",modelValue:a.keyword,"onUpdate:modelValue":r[0]||(r[0]=c=>a.keyword=c),clearable:"",placeholder:"请输入关键字检索"},null,8,["modelValue"]),r[2]||(r[2]=h("div",{class:"mb-[10px]"},[h("span",{class:"the-tag purple"},"树形组件-带复选框")],-1)),A(v(N),{values:a.values,"onUpdate:values":r[1]||(r[1]=c=>a.values=c),checkbox:"","check-parent":"","check-child":"",options:e,"option-setting":t,"disabled-method":c=>["999","2-2"].includes(c.id),"filter-method":c=>c.name.includes(a.keyword)},null,8,["values","disabled-method","filter-method"]),r[3]||(r[3]=h("div",{class:"pt-[10px] mb-[10px]"},[h("span",{class:"the-tag purple"},"树形组件-插槽模式")],-1)),A(v(N),{options:e,"option-setting":t,"filter-method":c=>c.name.includes(a.keyword)},{default:E(c=>[h("span",null,S(c.name),1),h("span",he,"("+S(c.id)+")",1)]),_:1},8,["filter-method"])])}}});export{ye as default};
