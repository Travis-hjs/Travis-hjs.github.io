import{d as j,g as b,L as J,b as U,h as _,i as y,p as v,k as O,j as F,q as $,n as I,e as Q,t as S,u as h,C as q,aA as P,D as W,m as E,G as X,F as z,l as H,H as Y,r as G,a as Z,w as ee,N as te,c as A}from"./element-plus-D8VYLuQe.js";import{u as ne,e as N,h as R}from"./index-BxpJ7RYt.js";function se(p,e){return p[e.label]||"-"}const ae=[null,void 0,""];function x(p,e){const t=p[e.key],a=p[e.value];return ae.includes(t)?a:t}function oe(){const p={};return{on(e,t){p.hasOwnProperty(e)||(p[e]=[]),p[e].some(a=>a===t)||p[e].push(t)},off(e,t){const a=p[e];if(a&&a.length>0&&t){for(let s=0;s<a.length;s++)if(a[s]===t){a.splice(s,1);break}}else console.log("[moduleEvent] => 没有要解绑的事件")},dispatch(e,t){const a=p[e];if(a&&a.length>0)for(let s=0;s<a.length;s++){const u=a[s];u(t)}else console.log("[moduleEvent] => 没有要执行的事件")}}}const K=oe(),le={class:"the-tree"},ie={class:"the-tree-item f-vertical"},ue={key:1,class:"the-tree-icon fvc"},re=v("i",{class:"el-icon-collection-tag"},null,-1),ce=[re],de=v("span",{class:"el-checkbox__inner"},null,-1),pe=[de],fe={class:"the-tree-sub"},he={name:"Level"},ve=j({...he,props:{option:{type:Object,required:!0},setting:{type:Object,required:!0},openKeys:{type:Array,required:!0},parentKeys:{type:Array,required:!0},parentValues:{type:Array,required:!0},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},disabled:{type:Function,default:void 0},usableValueMap:{type:Object,required:!0}},setup(p){const e=p,t=b(()=>e.option[e.setting.children]||[]),a=b(()=>x(e.option,e.setting)),s=b(()=>e.option[e.setting.value]),u=b(()=>e.openKeys.includes(a.value)),k=b(()=>e.values.includes(s.value)),r=b(()=>e.disabled?e.disabled(e.option):!1),L=b(()=>{if(!k.value)return!1;const i=e.usableValueMap[a.value];return i?i.some(d=>!e.values.includes(d)):!1}),{onBeforeEnter:C,onEnter:V,onAfterEnter:g,onBeforeLeave:M,onLeave:B,onAfterLeave:w}=ne(),l=J("treeRoot");function n(){K.dispatch(l.eventMap.itemOpen,a.value)}function o(){if(r.value)return;const i={key:a.value,value:s.value,parentKeys:e.parentKeys,parentValues:e.parentValues,hasSub:t.value.length>0};K.dispatch(l.eventMap.itemCheck,i)}return(i,d)=>{const f=U("Level",!0);return y(),_("div",le,[v("div",ie,[t.value.length>0?(y(),_("div",{key:0,class:"the-tree-icon fvc cursor-pointer",onClick:d[0]||(d[0]=c=>n())},[v("i",{class:I(["el-icon-caret-right",{"is-opened":u.value}])},null,2)])):(y(),_("div",ue,ce)),p.checkbox?(y(),_("span",{key:2,onClick:d[1]||(d[1]=c=>o()),class:I(["el-checkbox el-checkbox__input",{"is-checked":k.value,"is-disabled":r.value,"is-indeterminate":L.value}])},pe,2)):F("",!0),$(i.$slots,"treeitem",q(P(e.option)),()=>[Q(S(h(se)(e.option,e.setting)),1)])]),t.value.length>0?(y(),O(W,{key:0,onBeforeEnter:h(C),onEnter:h(V),onAfterEnter:h(g),onBeforeLeave:h(M),onLeave:h(B),onAfterLeave:h(w)},{default:E(()=>[X(v("div",fe,[(y(!0),_(z,null,H(t.value,c=>(y(),O(f,{key:h(x)(c,e.setting),option:c,setting:e.setting,"open-keys":e.openKeys,checkbox:e.checkbox,values:e.values,disabled:e.disabled,"usable-value-map":e.usableValueMap,"parent-keys":[...e.parentKeys,a.value],"parent-values":[...e.parentValues,s.value]},{treeitem:E(m=>[$(i.$slots,"treeitem",q(P(m)))]),_:2},1032,["option","setting","open-keys","checkbox","values","disabled","usable-value-map","parent-keys","parent-values"]))),128))],512),[[Y,u.value]])]),_:3},8,["onBeforeEnter","onEnter","onAfterEnter","onBeforeLeave","onLeave","onAfterLeave"])):F("",!0)])}}}),me={name:"Tree"},T=j({...me,props:{options:{type:Array,default:()=>[]},optionSetting:{type:Object,default:()=>({})},checkbox:{type:Boolean,default:!1},values:{type:Array,default:()=>[]},checkParent:{type:Boolean,default:!1},checkChild:{type:Boolean,default:!1},filterMethod:{type:Function,default:void 0},disabledMethod:{type:Function,default:void 0}},emits:["update:values"],setup(p,{emit:e}){const t=p,a=e,s=b(()=>({label:"label",value:"value",children:"children",...t.optionSetting})),u=G({allKeys:[],openKeys:[]});function k(l,n){return l.forEach(o=>{n.push(x(o,s.value));const i=o[s.value.children]||[];i.length>0&&k(i,n)}),n}function r(l,n){return l.forEach(o=>{const i=o[s.value.value];t.disabledMethod?!t.disabledMethod(o)&&n.push(i):n.push(i);const d=o[s.value.children]||[];d.length>0&&r(d,n)}),n}function L(l,n){for(let o=0;o<l.length;o++){const i=l[o];if(x(i,s.value)===n)return i;const d=i[s.value.children]||[];if(d.length>0){const f=L(d,n);if(f)return f}}}function C(l){u.openKeys.includes(l)?u.openKeys=u.openKeys.filter(n=>n!==l):u.openKeys.push(l)}function V(l){const{value:n,parentValues:o,key:i,hasSub:d}=l;let f=[];if(t.checkChild&&d){const m=L(t.options,i);m&&(f=m[s.value.children]||[])}let c=R(t.values);if(c.includes(n)){if(c=c.filter(m=>m!==n),f.length>0){const m=r(f,[]);c=c.filter(D=>!m.includes(D))}}else c.push(n),t.checkParent&&c.push(...o),f.length>0&&c.push(...r(f,[])),(t.checkParent||f.length>0)&&(c=[...new Set(c)]);a("update:values",c)}const g={itemCheck:N("tree-item-check"),itemOpen:N("tree-item-open")};K.on(g.itemOpen,C),K.on(g.itemCheck,V),Z(function(){K.off(g.itemCheck,V),K.off(g.itemOpen,C)}),te("treeRoot",{eventMap:g});function M(l){return l.filter(n=>{const o=n[s.value.children]||[];return!!(o.length>0&&(n[s.value.children]=M(o),n[s.value.children].length>0)||t.filterMethod(n))})}const B=b(()=>t.filterMethod?M(R(t.options)):t.options),w=b(()=>{if(t.checkParent||t.checkChild){let l=function(o){const i=o[s.value.children]||[];if(i.length<1)return;const d=x(o,s.value);n[d]=[];for(const f of i){const c=x(f,s.value),m=f[s.value.value];(t.disabledMethod?t.disabledMethod(f):!1)||n[d].push(m),l(f),n[c]&&n[d].push(...n[c])}};const n={};for(const o of t.options)l(o);return n}return{}});return ee(()=>t.options,function(l){const n=k(l,[]);u.openKeys=u.openKeys.filter(o=>n.includes(o)),u.allKeys=n},{immediate:!0,deep:!0}),(l,n)=>(y(!0),_(z,null,H(B.value,o=>(y(),O(ve,{key:h(x)(o,s.value),option:o,setting:s.value,"open-keys":u.openKeys,checkbox:t.checkbox,values:t.values,disabled:t.disabledMethod,"parent-keys":[],"parent-values":[],"usable-value-map":w.value},{treeitem:E(i=>[$(l.$slots,"default",q(P(i)))]),_:2},1032,["option","setting","open-keys","checkbox","values","disabled","usable-value-map"]))),128))}}),be={class:"menu-3"},ye=v("div",{class:"mb-[10px]"},[v("span",{class:"the-tag purple"},"树形组件-带复选框")],-1),ke=v("div",{class:"pt-[10px] mb-[10px]"},[v("span",{class:"the-tag purple"},"树形组件-插槽模式")],-1),ge={class:"ml-[4px] text-amber-400 text-[12px]"},Ke=j({__name:"menu-3",setup(p){const e=[{id:"1",name:"选项 1",list:[{id:"1-1",name:"选项 1-1"},{id:"1-2",name:"选项 1-2",list:[{id:"1-2-1",name:"选项 1-2-1"},{id:"1-2-2",name:"选项 1-2-2"},{id:"1-2-3",name:"选项 1-2-3"},{id:"1-2-4",name:"选项 1-2-4"}]},{id:"1-3",name:"选项 1-3"},{id:"1-4",name:"选项 1-4"},{id:"1-5",name:"选项 1-5"}]},{id:"2",name:"选项 2",list:[{id:"2-1",name:"选项 2-1",list:[{id:"**s",name:"三级选项-1"},{id:"**",name:"三级选项-2"},{id:"999",name:"三级选项-3"}]},{id:"2-2",name:"选项 2-2"},{id:"2-3",name:"选项 2-3"}]}],t={value:"id",label:"name",children:"list"},a=G({values:["1"],keyword:""});return(s,u)=>{const k=U("el-input");return y(),_("div",be,[A(k,{class:"max-w-[300px] mb-[10px]",modelValue:a.keyword,"onUpdate:modelValue":u[0]||(u[0]=r=>a.keyword=r),clearable:"",placeholder:"请输入关键字检索"},null,8,["modelValue"]),ye,A(h(T),{values:a.values,"onUpdate:values":u[1]||(u[1]=r=>a.values=r),checkbox:"","check-parent":"","check-child":"",options:e,"option-setting":t,"disabled-method":r=>["999","2-2"].includes(r.id),"filter-method":r=>r.name.includes(a.keyword)},null,8,["values","disabled-method","filter-method"]),ke,A(h(T),{options:e,"option-setting":t,"filter-method":r=>r.name.includes(a.keyword)},{default:E(r=>[v("span",null,S(r.name),1),v("span",ge,"("+S(r.id)+")",1)]),_:1},8,["filter-method"])])}}});export{Ke as default};
